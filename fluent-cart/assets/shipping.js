import{i as b,a as o,S as ue,c as g,o as n,R as de,b as $,w as s,d as e,u as l,g as x,t as u,f,m as se,e as I,F as le,h as ne,j as he}from"./chunks/vue.esm-bundler.js?ver=1.3.12";import{T as fe,_ as pe,a as ve,C as Q,c as G,d as K}from"./chunks/RouteCell.js?ver=1.3.12";import{t}from"./chunks/Translator.js?ver=1.3.12";import{A as ze}from"./chunks/Arr.js?ver=1.3.12";import{R as U}from"./chunks/Rest.js?ver=1.3.12";import{I as X,B as $e}from"./chunks/Badge.js?ver=1.3.12";import{_ as ee}from"./chunks/DynamicIcon.js?ver=1.3.12";import{n as F}from"./chunks/Notify.js?ver=1.3.12";import{_ as ce}from"./chunks/_plugin-vue_export-helper.js?ver=1.3.12";import{u as _e,o as Ve}from"./chunks/Str.js?ver=1.3.12";import{S as oe,u as Te,c as Ae,_ as be}from"./chunks/countries.js?ver=1.3.12";import{b as ie,E as Ze}from"./chunks/index.js?ver=1.3.12";import{_ as ye,u as Ee}from"./chunks/NotFound.js?ver=1.3.12";import"./chunks/Model.js?ver=1.3.12";import"./chunks/Url.js?ver=1.3.12";import"./chunks/dayjs.min.js?ver=1.3.12";import"./chunks/timezone.js?ver=1.3.12";import"./chunks/Utils.js?ver=1.3.12";import"./chunks/Asset.js?ver=1.3.12";class Fe extends fe{setupInitialData(){super.setupInitialData(),this.data.sorting.sortBy="id",this.data.sorting.sortType="DESC"}getTabs(){return null}getToggleableColumns(){return[{label:t("Regions"),value:"regions"},{label:t("Shipping Methods"),value:"methods_count"}]}getSortableColumns(){return[{label:t("Zone Name"),value:"name"},{label:t("Order"),value:"order"}]}getSearchHint(){return t("Search by zone name")}getFetchUrl(){return"shipping/zones"}parseResponse(v){return v.shipping_zones}getTableName(){return"shipping_zone_table"}getAdvanceFilterOptions(){return ze.get(window,"fluentCartAdminApp.filter_options.shipping_zone_filter_options")}getSearchGuideOptions(){return[]}useFullWidthSearch(){return!0}with(){return["methodsCount"]}}function Me(y){return Fe.init(y)}const De={class:"shipping-zones-table"},Re={key:0},Pe={key:1,class:"text-muted"},Ne={key:0},Ue={key:1,class:"text-muted"},qe={class:"fct-btn-group sm justify-end pr-4"},Be={__name:"ShippingZonesTable",props:{shipping_zones:{type:Array,required:!0},columns:{type:Array,default:()=>[]}},emits:["refresh"],setup(y,{emit:v}){const h=v,_=b(!1),r=d=>{_.value=!0,U.delete(`/shipping/zones/${d}`).then(m=>{F.success(m.message||t("Shipping zone deleted successfully")),h("refresh")}).catch(m=>{console.error("Error deleting shipping zone:",m),F.error(m.message)}).finally(()=>{_.value=!1})};return(d,m)=>{const a=o("el-table-column"),T=o("el-popconfirm"),z=o("el-table"),k=ue("loading");return n(),g("div",De,[de((n(),$(z,{data:y.shipping_zones,class:"w-full compact-table responsive full-compact"},{default:s(()=>[e(a,{prop:"name",label:l(t)("Zone Name")},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[x(u(w.row.name),1)]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Country")},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[w.row.formatted_region?(n(),g("div",Re,[f("span",null,u(w.row.formatted_region),1)])):(n(),g("div",Pe,u(l(t)("Applied To All Countries")),1))]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Shipping Methods"),width:"180"},{default:s(w=>[e(pe,{to:{name:"view_shipping_zone",params:{zone_id:w.row.id}}},{default:s(()=>[w.row.methods_count>0?(n(),g("div",Ne,u(l(t)("%s methods",w.row.methods_count)),1)):(n(),g("div",Ue,u(l(t)("No methods")),1))]),_:2},1032,["to"])]),_:1},8,["label"]),e(a,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(w=>[f("div",qe,[e(X,{size:"small",onClick:A=>d.$router.push({name:"view_shipping_zone",params:{zone_id:w.row.id}}),class:"cursor-pointer"},{default:s(()=>[e(ee,{name:"Edit"})]),_:2},1032,["onClick"]),e(T,{title:l(t)("Are you sure to delete this shipping zone?"),onConfirm:A=>r(w.row.id),width:"220"},{reference:s(()=>[e(X,{size:"small",class:"cursor-pointer"},{default:s(()=>[e(ee,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])),[[k,_.value]])])}}},Ie=ce(Be,[["__scopeId","data-v-4219a2eb"]]),Oe={class:"shipping-zones-loader"},Le={class:"shipping-zones-table"},He={class:"table-cell"},We={class:"table-cell"},je={class:"table-cell"},Ge={class:"table-cell"},Ke={__name:"ShippingZonesLoader",props:{shippingZoneTable:{type:Object,required:!0},nextPageCount:{type:Number,default:0}},setup(y){const v=y,h=Array.from({length:v.nextPageCount},(_,r)=>r+1);return(_,r)=>{const d=o("el-skeleton-item"),m=o("el-skeleton"),a=o("el-table-column"),T=o("el-table");return n(),g("div",Oe,[f("div",Le,[e(T,{data:l(h),class:"w-full compact-table responsive"},{default:s(()=>[e(a,{prop:"name",label:l(t)("Zone Name")},{default:s(()=>[f("div",He,[e(m,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Regions")},{default:s(()=>[f("div",We,[e(m,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[150px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Shipping Methods"),width:"180"},{default:s(()=>[f("div",je,[e(m,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[200px]"})]),_:1})])]),_:1},8,["label"]),e(a,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(()=>[f("div",Ge,[e(m,{animated:""},{template:s(()=>[e(d,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"])]),_:1},8,["data"])])])}}},Ye={class:"setting-wrap"},Je={class:"setting-wrap-inner"},Qe={class:"fct-all-shipping-zones-wrap"},Xe={key:1},et={__name:"AllShippingZones",setup(y){const v=_e(),h=Me();return(_,r)=>{const d=o("el-button");return n(),g("div",Ye,[e(oe,{heading:l(t)("Shipping Zones"),"show-save-button":!1},{action:s(()=>[e(d,{type:"primary",onClick:r[0]||(r[0]=m=>l(v).push({name:"add_shipping_zone"})),size:"small"},{default:s(()=>[x(u(l(t)("Add Shipping Zone")),1)]),_:1})]),_:1},8,["heading"]),f("div",Je,[f("div",Qe,[e(ve,{table:l(h)},{default:s(()=>[l(h).isLoading()?(n(),$(Ke,{key:0,shippingZoneTable:l(h),"next-page-count":l(h).nextPageCount},null,8,["shippingZoneTable","next-page-count"])):(n(),g("div",Xe,[e(Ie,{shipping_zones:l(h).getTableData(),columns:l(h).data.columns,onRefresh:r[1]||(r[1]=m=>l(h).fetch())},null,8,["shipping_zones","columns"])]))]),_:1},8,["table"])])])])}}},tt={class:"single-shipping-zone-loader"},lt={class:"single-page-header flex items-center justify-between"},st={class:"fct-page-header__actions"},at={__name:"SingleShippingZoneLoader",setup(y){return(v,h)=>{const _=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-breadcrumb-item"),m=o("el-breadcrumb");return n(),g("div",tt,[f("div",lt,[e(m,{"separator-icon":l(ie)},{default:s(()=>[e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[60px] h-4"})]),_:1})]),_:1})]),_:1},8,["separator-icon"]),f("div",st,[e(r,{animated:"",class:"h-9 w-[172px]"},{template:s(()=>[e(_,{variant:"p",class:"w-full h-9 rounded"})]),_:1})])]),e(l(K),{class:"mb-4"},{default:s(()=>[e(l(Q),{title:l(t)("Zone Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(G),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1}),e(l(K),{class:"mb-4"},{default:s(()=>[e(l(Q),{title:l(t)("Shipping Methods"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(G),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1})])}}},nt={class:"fct-shipping-methods-wrap"},ot={class:"shipping-methods-list"},it={key:0,class:"flex flex-wrap gap-1"},rt={key:1,class:"text-muted"},pt={key:0},ut={key:1},dt={key:0},ct={key:1},_t={key:0},mt={key:1},gt={class:"flex items-center gap-1"},ht={class:"no-methods"},ft={class:"el-form-item__label"},vt={key:0,class:"form-help-text mt-1"},bt={key:0,class:"form-help-text mt-1"},yt={class:"dialog-footer"},wt={__name:"ShippingMethods",props:{zone_id:{type:[String,Number],required:!0},methods:{type:Array,required:!1,default:()=>[]},country:{type:String,default:""}},emits:["fetchShippingMethods"],setup(y,{emit:v}){const h=y,_=v,r=b(!1),d=b(null),m=b(!1),a=b({zone_id:h.zone_id,method_id:0,title:"",type:"flat_rate",settings:{configure_rate:"per_item",class_aggregation:"sum_all"},amount:0,is_enabled:1,states:[],meta:{description:""}}),T=b(!1),z=b([]),k=se(()=>h.country==="all"),w=b({title:[{required:!0,message:t("Please enter a method title"),trigger:"blur"}],type:[{required:!0,message:t("Please select a method type"),trigger:"blur"}]}),A=b("States"),P=()=>{a.value={zone_id:h.zone_id,method_id:0,title:"",type:"flat_rate",settings:{configure_rate:"per_item",class_aggregation:"sum_all"},amount:0,is_enabled:1,states:[],meta:{description:""}},r.value=!0},S=()=>{m.value=!0,U.post("shipping/methods",a.value).then(p=>{F.success(p.message),r.value=!1,_("fetchShippingMethods")}).catch(p=>{let c="";if(p.status_code=="422")for(const R in p.data){const E=p.data[R],B=Object.values(E)[0];c+=B+` 
`}c||(c=t("Failed to save shipping method")),console.error("Error saving shipping method:",p),F.error(c)}).finally(()=>{m.value=!1})},C=()=>{m.value=!0,U.put("shipping/methods",a.value).then(p=>{F.success(p.message),r.value=!1,_("fetchShippingMethods")}).catch(p=>{console.error("Error updating shipping method:",p),F.error(t("Failed to update shipping method"))}).finally(()=>{})},N=p=>{U.delete("/shipping/methods/"+p).then(c=>{F.success(c.message),_("fetchShippingMethods")}).catch(c=>{console.error("Error deleting shipping method:",c),F.error(t("Failed to delete shipping method"))})},L=b([{label:t("Flat Rate"),value:"flat_rate"},{label:t("Free Shipping"),value:"free_shipping"},{label:t("Local Pickup"),value:"local_pickup"}]),H=p=>{var c;a.value={zone_id:h.zone_id,method_id:p.id,title:p.title,type:p.type,settings:p.settings||{configure_rate:"per_item",class_aggregation:"sum_all"},amount:p.amount,is_enabled:p.is_enabled?1:0,states:p.states,meta:{description:((c=p.meta)==null?void 0:c.description)||""}},r.value=!0},Z=se(()=>{if(a.value.settings.configure_rate==="per_order")return t("Single charge for the entire order.");if(a.value.settings.configure_rate==="per_item")return t("Charge per item in the cart.");if(a.value.settings.configure_rate==="per_price")return t("Percentage of the total amount of the order")}),V=se(()=>{if(a.value.settings.class_aggregation==="sum_all")return t("Sums of all shipping classes.");if(a.value.settings.class_aggregation==="highest_class")return t("Cost of the highest class among all the classes.")}),q=p=>{if(p==="per_order")return t("Per Order");if(p==="per_item")return t("Per Item");if(p==="per_price")return t("Per Price")},D=()=>{!h.country||h.country==="all"||(T.value=!0,U.get("/shipping/zone/states",{country_code:h.country}).then(p=>{var c,R,E,B,Y,J,M;z.value=(c=p.data)==null?void 0:c.states,(B=(E=(R=p.data)==null?void 0:R.address_locale)==null?void 0:E.state)!=null&&B.label&&(A.value=(M=(J=(Y=p.data)==null?void 0:Y.address_locale)==null?void 0:J.state)==null?void 0:M.label)}).catch(p=>{console.error("Error fetching state zones:",p)}).finally(()=>{T.value=!1}))};return(p,c)=>{const R=o("el-button"),E=o("el-table-column"),B=o("el-tag"),Y=o("el-popconfirm"),J=o("el-table"),M=o("el-switch"),O=o("el-form-item"),re=o("el-input"),W=o("el-option"),ae=o("el-select"),te=o("el-col"),we=o("el-row"),Se=o("el-form"),Ce=o("el-drawer"),xe=ue("loading");return n(),g("div",nt,[y.zone_id?(n(),$(l(K),{key:0,class:"mb-4 overflow-hidden"},{default:s(()=>[e(l(Q),{title:l(t)("Shipping Methods")},{action:s(()=>[e(R,{type:"primary",onClick:P},{default:s(()=>[x(u(l(t)("Add Shipping Method")),1)]),_:1})]),_:1},8,["title"]),e(l(G),null,{default:s(()=>[f("div",ot,[e(J,{data:y.methods,class:"w-full"},{empty:s(()=>[f("div",ht,[f("p",null,u(l(t)("No shipping methods found for this zone. Add a shipping method to define how products are shipped in this zone.")),1)])]),default:s(()=>[e(E,{prop:"title",label:l(t)("Method Title")},null,8,["label"]),e(E,{label:l(t)("States")},{default:s(i=>[i.row.formatted_states&&i.row.formatted_states.length>0?(n(),g("div",it,[(n(!0),g(le,null,ne(i.row.formatted_states.slice(0,3),(j,ke)=>(n(),$(B,{key:ke,type:"info"},{default:s(()=>[x(u(j),1)]),_:2},1024))),128)),i.row.formatted_states.length>3?(n(),$(B,{key:0,type:"info"},{default:s(()=>[x(" +"+u(i.row.formatted_states.length-3),1)]),_:2},1024)):I("",!0)])):(n(),g("div",rt,u(l(t)("Applied To All States")),1))]),_:1},8,["label"]),e(E,{prop:"type",label:l(t)("Method Type")},{default:s(i=>[x(u(L.value.find(j=>j.value===i.row.type).label),1)]),_:1},8,["label"]),e(E,{prop:"amount",label:l(t)("Amount"),width:"100px"},{default:s(i=>[i.row.type==="free_shipping"?(n(),g("span",pt,u(l(t)("Free")),1)):(n(),g("span",ut,u(i.row.amount),1))]),_:1},8,["label"]),e(E,{prop:"is_enabled",label:l(t)("Enabled")},{default:s(i=>[e($e,{type:i.row.is_enabled?"success":"info"},{default:s(()=>[x(u(i.row.is_enabled?l(t)("Enabled"):l(t)("Disabled")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),e(E,{prop:"configure_rate",label:l(t)("Configure Rate")},{default:s(i=>[i.row.type==="free_shipping"?(n(),g("span",dt," -- ")):(n(),g("span",ct,u(q(i.row.settings.configure_rate)),1))]),_:1},8,["label"]),e(E,{prop:"class_aggregation",label:l(t)("Class Aggregation"),width:"200px"},{default:s(i=>[i.row.type==="free_shipping"?(n(),g("span",_t," -- ")):(n(),g("span",mt,u(i.row.settings.class_aggregation==="highest_class"?l(t)("Highest Class"):l(t)("Sum All")),1))]),_:1},8,["label"]),e(E,{label:l(t)("Actions"),width:"100"},{default:s(i=>[f("div",gt,[e(X,{size:"small",class:"cursor-pointer",hover:"primary",bg:"transparent",onClick:j=>H(i.row)},{default:s(()=>[e(ee,{name:"Edit"})]),_:2},1032,["onClick"]),e(Y,{title:l(t)("Are you sure to delete this shipping method?"),onConfirm:j=>N(i.row.id)},{reference:s(()=>[e(X,{size:"small",class:"cursor-pointer",hover:"danger",bg:"transparent"},{default:s(()=>[e(ee,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])])]),_:1})]),_:1})):(n(),$(l(K),{key:1},{default:s(()=>[e(l(G),null,{default:s(()=>[x(u(l(t)("No Shipping Zone Id provided")),1)]),_:1})]),_:1})),e(Ce,{modelValue:r.value,"onUpdate:modelValue":c[10]||(c[10]=i=>r.value=i),title:l(t)("Add Shipping Method"),width:"500px","append-to-body":"","close-on-click-modal":!0,class:"fct-shipping-method-drawer",onOpen:D},{footer:s(()=>[f("span",yt,[e(R,{onClick:c[9]||(c[9]=i=>r.value=!1)},{default:s(()=>[x(u(l(t)("Cancel")),1)]),_:1}),a.value.method_id?(n(),$(R,{key:0,type:"primary",onClick:C,loading:m.value},{default:s(()=>[x(u(l(t)("Update")),1)]),_:1},8,["loading"])):(n(),$(R,{key:1,type:"primary",onClick:S,loading:m.value},{default:s(()=>[x(u(l(t)("Save")),1)]),_:1},8,["loading"]))])]),default:s(()=>[e(Se,{model:a.value,rules:w.value,ref_key:"methodFormRef",ref:d,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[e(O,{prop:"is_enabled"},{label:s(()=>[f("span",ft,[e(M,{modelValue:a.value.is_enabled,"onUpdate:modelValue":c[0]||(c[0]=i=>a.value.is_enabled=i),"active-value":1,"inactive-value":0},null,8,["modelValue"]),x(" "+u(l(t)("Enable Shipping Method")),1)])]),_:1}),e(O,{label:l(t)("Method Title"),prop:"title"},{default:s(()=>[e(re,{modelValue:a.value.title,"onUpdate:modelValue":c[1]||(c[1]=i=>a.value.title=i),placeholder:l(t)("Enter method title")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!k.value&&z.value.length>0?de((n(),$(O,{key:0,label:A.value},{default:s(()=>[e(ae,{modelValue:a.value.states,"onUpdate:modelValue":c[2]||(c[2]=i=>a.value.states=i),multiple:"",filterable:"",clearable:"",placeholder:l(t)("Select %s",A.value||"States")},{default:s(()=>[(n(!0),g(le,null,ne(z.value,(i,j)=>(n(),$(W,{key:j,label:i.name,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])),[[xe,T.value]]):I("",!0),e(we,{gutter:12},{default:s(()=>[e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Method Type"),prop:"type"},{default:s(()=>[e(ae,{modelValue:a.value.type,"onUpdate:modelValue":c[3]||(c[3]=i=>a.value.type=i),onChange:c[4]||(c[4]=i=>{i==="free_shipping"&&(a.value.amount=0,a.value.settings.configure_rate="",a.value.settings.class_aggregation="")})},{default:s(()=>[(n(!0),g(le,null,ne(L.value,i=>(n(),$(W,{key:i.value,label:i.label,value:i.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),a.value.type!=="free_shipping"?(n(),g(le,{key:0},[e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Amount"),prop:"amount"},{default:s(()=>[e(re,{type:"number",min:"0",modelValue:a.value.amount,"onUpdate:modelValue":c[5]||(c[5]=i=>a.value.amount=i),placeholder:l(t)("Enter amount")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Configure Rate")},{default:s(()=>[e(ae,{modelValue:a.value.settings.configure_rate,"onUpdate:modelValue":c[6]||(c[6]=i=>a.value.settings.configure_rate=i)},{default:s(()=>[e(W,{label:l(t)("Per Order"),value:"per_order"},null,8,["label"]),e(W,{label:l(t)("Per Item"),value:"per_item"},null,8,["label"]),e(W,{label:l(t)("Percentage"),value:"per_price"},null,8,["label"])]),_:1},8,["modelValue"]),a.value.settings.configure_rate?(n(),g("div",vt,u(Z.value),1)):I("",!0)]),_:1},8,["label"])]),_:1}),e(te,{lg:12},{default:s(()=>[e(O,{label:l(t)("Class Aggregation")},{default:s(()=>[e(ae,{modelValue:a.value.settings.class_aggregation,"onUpdate:modelValue":c[7]||(c[7]=i=>a.value.settings.class_aggregation=i)},{default:s(()=>[e(W,{label:l(t)("Combined Cost"),value:"sum_all"},null,8,["label"]),e(W,{label:l(t)("Highest Cost"),value:"highest_class"},null,8,["label"])]),_:1},8,["modelValue"]),a.value.settings.class_aggregation?(n(),g("div",bt,u(V.value),1)):I("",!0)]),_:1},8,["label"])]),_:1})],64)):I("",!0),e(te,{lg:24},{default:s(()=>[e(O,{label:l(t)("Description")},{default:s(()=>[e(re,{modelValue:a.value.meta.description,"onUpdate:modelValue":c[8]||(c[8]=i=>a.value.meta.description=i),type:"textarea",rows:2,placeholder:l(t)("Enter description")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},St=ce(wt,[["__scopeId","data-v-3ab35594"]]),Ct={class:"setting-wrap"},xt={key:0,class:"cmd"},kt={class:"setting-wrap-inner"},zt={class:"fct-single-shipping-zone-page"},$t={key:0},Vt={key:2,class:"fct-single-shipping-zone"},Tt={class:"form-help-text"},At={__name:"SingleShippingZone",props:{zone_id:{type:[String,Number],required:!1}},setup(y){const v=y,h=_e(),_=Te();_.bind(["mod+s"],Z=>{Z.preventDefault(),L()});const r=b(null),d=b(!1),m=b(!1),a=b({name:"",region:""}),T=b({name:[{required:!0,message:t("Please enter a zone name"),trigger:"blur"}]}),z=b([]),k=b(null),w=b(!1),A=b({show:!1,message:"",buttonText:"",route:""}),P=Z=>{Z&&(k.value=a.value.region)},S=se(()=>!!v.zone_id),C=()=>{S.value&&(d.value=!0,U.get(`shipping/zones/${v.zone_id}`).then(Z=>{const V=Z.shipping_zone;a.value.name=V.name,a.value.region=V.region||"",w.value=a.value.region==="all",z.value=V.methods||[]}).catch(Z=>{console.error("Error fetching zone data:",Z),A.value={show:!0,message:t("Shipping zone not found"),buttonText:t("Back to Shipping Zones"),route:{name:"all_shipping_zones"}}}).finally(()=>{d.value=!1}))},N=Z=>{Z?(k.value=a.value.region,a.value.region="all"):a.value.region=k.value||""},L=()=>{r.value.validate(Z=>{if(!Z)return;m.value=!0;const V=S.value?"put":"post",q=`shipping/zones${S.value?`/${v.zone_id}`:""}`;U[V](q,a.value).then(D=>{F.success(D.message),S.value?C():h.push({name:"view_shipping_zone",params:{zone_id:D.shipping_zone.id}})}).catch(D=>{var p;D.status_code=="422"?F.validationErrors(D):F.error((p=D.data)==null?void 0:p.message),console.error("Error saving shipping zone:",D)}).finally(()=>{m.value=!1})})},H=()=>{S.value&&Ze.confirm("If you change the region, all the shipping methods states will be removed. Do you want to continue?","Confirmation",{confirmButtonText:"Yes",cancelButtonText:"No",type:"warning"}).then(()=>{}).catch(()=>{a.value.region=k.value})};return he(()=>{C()}),Ve(()=>{_.unbind("mod+s")}),(Z,V)=>{const q=o("el-breadcrumb-item"),D=o("el-breadcrumb"),p=o("el-button"),c=o("el-input"),R=o("el-form-item"),E=o("el-checkbox"),B=o("el-option"),Y=o("el-select"),J=o("el-form");return n(),g("div",Ct,[e(oe,{"show-save-button":!1},{heading:s(()=>[e(D,{class:"mb-0","separator-icon":l(ie)},{default:s(()=>[e(q,{to:{name:"shipping"}},{default:s(()=>[x(u(l(t)("Shipping Zones")),1)]),_:1}),e(q,null,{default:s(()=>[x(u(S.value?l(t)("Edit Shipping Zone"):l(t)("Add Shipping Zone")),1)]),_:1}),S.value?(n(),$(q,{key:0},{default:s(()=>[x(u(a.value.name),1)]),_:1})):I("",!0)]),_:1},8,["separator-icon"])]),action:s(()=>[e(p,{type:"primary",onClick:L,loading:m.value,size:"small"},{default:s(()=>[m.value?I("",!0):(n(),g("span",xt,"âŒ˜s")),x(" "+u(m.value?l(t)("Saving"):l(t)("Save")),1)]),_:1},8,["loading"])]),_:1}),f("div",kt,[f("div",zt,[d.value?(n(),g("div",$t,[e(at)])):A.value.show?(n(),$(ye,{key:1,message:A.value.message,"button-text":A.value.buttonText,route:A.value.route},null,8,["message","button-text","route"])):(n(),g("div",Vt,[e(l(K),null,{default:s(()=>[e(l(Q),{title:l(t)("Zone Details"),border_bottom:""},null,8,["title"]),e(l(G),null,{default:s(()=>[e(J,{model:a.value,rules:T.value,ref_key:"zoneFormRef",ref:r,"label-position":"top","require-asterisk-position":"right"},{default:s(()=>[e(R,{label:l(t)("Zone Name"),prop:"name"},{default:s(()=>[e(c,{modelValue:a.value.name,"onUpdate:modelValue":V[0]||(V[0]=M=>a.value.name=M),placeholder:l(t)("Enter zone name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(R,{label:"",prop:"region",class:"mt-6 mb-6"},{default:s(()=>[e(E,{modelValue:w.value,"onUpdate:modelValue":V[1]||(V[1]=M=>w.value=M),onChange:N},{default:s(()=>[x(u(l(t)("Applies to Whole World")),1)]),_:1},8,["modelValue"])]),_:1}),e(R,{label:l(t)("Country"),prop:"region",class:"mb-0",required:""},{default:s(()=>[e(Y,{modelValue:a.value.region,"onUpdate:modelValue":V[2]||(V[2]=M=>a.value.region=M),disabled:w.value,filterable:"","default-first-option":"",placeholder:l(t)("Select countries"),"reserve-keyword":!1,onVisibleChange:P,onChange:H},{default:s(()=>[(n(!0),g(le,null,ne(l(Ae),M=>(n(),$(B,{key:M.code2,label:M.name,value:M.code2},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","placeholder"]),f("div",Tt,u(l(t)("Select the country where this shipping zone applies.")),1)]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1}),S.value?(n(),$(St,{key:0,zone_id:v.zone_id,methods:z.value,onFetchShippingMethods:C,country:a.value.region},null,8,["zone_id","methods","country"])):I("",!0)]))])])])}}},me=ce(At,[["__scopeId","data-v-c1eea010"]]);class Zt extends fe{setupInitialData(){super.setupInitialData(),this.data.sorting.sortBy="id",this.data.sorting.sortType="DESC"}getTabs(){return null}getToggleableColumns(){return[{label:t("Cost"),value:"cost"},{label:t("Type"),value:"type"}]}getSortableColumns(){return[{label:t("Class Name"),value:"name"},{label:t("Cost"),value:"cost"}]}getSearchHint(){return t("Search by class name")}getFetchUrl(){return"shipping/classes"}parseResponse(v){return v.shipping_classes}getTableName(){return"shipping_class_table"}getAdvanceFilterOptions(){return null}getSearchGuideOptions(){return[]}useFullWidthSearch(){return!0}}function Et(y){return Zt.init(y)}const Ft={class:"shipping-classes-table"},Mt={class:"fct-btn-group sm justify-end"},Dt={__name:"ShippingClassesTable",props:{shipping_classes:{type:Array,required:!0},columns:{type:Array,default:()=>[]}},emits:["refresh"],setup(y,{emit:v}){const h=v,_=b(!1),r=b(!1),d=b(null),m=z=>{_.value=!0,U.delete(`/shipping/classes/${z}`).then(k=>{F.success(k.message),h("refresh")}).catch(k=>{console.error("Error deleting shipping class:",k),F.error(t("Failed to delete shipping class"))}).finally(()=>{_.value=!1})},a=z=>{d.value=z,r.value=!0},T=()=>{h("refresh")};return(z,k)=>{const w=o("el-table-column"),A=o("el-popconfirm"),P=o("el-table"),S=ue("loading");return n(),g("div",Ft,[de((n(),$(P,{data:y.shipping_classes,class:"w-full responsive"},{default:s(()=>[e(w,{prop:"name",label:l(t)("Class Name")},{default:s(C=>[x(u(C.row.name),1)]),_:1},8,["label"]),e(w,{prop:"cost",label:l(t)("Cost"),width:"150"},{default:s(C=>[x(u(C.row.cost)+u(C.row.type==="percentage"?"%":""),1)]),_:1},8,["label"]),e(w,{prop:"type",label:l(t)("Type"),width:"150"},{default:s(C=>[x(u(C.row.type==="fixed"?l(t)("Fixed Amount"):l(t)("Percentage")),1)]),_:1},8,["label"]),e(w,{prop:"per_item",label:l(t)("Per Item"),width:"150"},{default:s(C=>[x(u(C.row.per_item==1?l(t)("Yes"):l(t)("No")),1)]),_:1},8,["label"]),e(w,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(C=>[f("div",Mt,[e(X,{size:"small",onClick:N=>a(C.row),class:"cursor-pointer"},{default:s(()=>[e(ee,{name:"Edit"})]),_:2},1032,["onClick"]),e(A,{title:l(t)("Are you sure to delete this shipping class?"),onConfirm:N=>m(C.row.id),width:"220"},{reference:s(()=>[e(X,{size:"small",class:"cursor-pointer"},{default:s(()=>[e(ee,{name:"Delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1},8,["label"])]),_:1},8,["data"])),[[S,_.value]]),e(be,{modelValue:r.value,"onUpdate:modelValue":k[0]||(k[0]=C=>r.value=C),"class-data":d.value,onSaved:T},null,8,["modelValue","class-data"])])}}},Rt={class:"shipping-classes-loader"},Pt={class:"shipping-classes-table"},Nt={class:"table-cell"},Ut={class:"table-cell"},qt={class:"table-cell"},Bt={class:"table-cell"},It={__name:"ShippingClassesLoader",props:{shippingClassTable:{type:Object,required:!0},nextPageCount:{type:Array,default:()=>[1,2,3,4,5]}},setup(y){return(v,h)=>{const _=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-table-column"),m=o("el-table");return n(),g("div",Rt,[f("div",Pt,[e(m,{data:[],class:"w-full compact-table responsive"},{default:s(()=>[e(d,{prop:"name",label:l(t)("Class Name")},{default:s(()=>[f("div",Nt,[e(r,{animated:""},{template:s(()=>[e(_,{varient:"p",class:"w-[120px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Cost")},{default:s(()=>[f("div",Ut,[e(r,{animated:""},{template:s(()=>[e(_,{varient:"p",class:"w-[80px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Type")},{default:s(()=>[f("div",qt,[e(r,{animated:""},{template:s(()=>[e(_,{varient:"p",class:"w-[100px]"})]),_:1})])]),_:1},8,["label"]),e(d,{label:l(t)("Actions"),width:"200",align:"right"},{default:s(()=>[f("div",Bt,[e(r,{animated:""},{template:s(()=>[e(_,{varient:"p",class:"w-[80px]"})]),_:1})])]),_:1},8,["label"])]),_:1})])])}}},Ot={class:"setting-wrap"},Lt={class:"setting-wrap-inner"},Ht={class:"fct-all-shipping-classes-wrap"},Wt={key:1},jt={__name:"AllShippingClasses",setup(y){const v=Et(),h=b(!1),_=b(null),r=()=>{_.value=null,h.value=!0},d=()=>{v.fetch(),h.value=!1};return(m,a)=>(n(),g("div",Ot,[e(oe,{heading:l(t)("Shipping Classes"),"save-button-text":l(t)("Add Shipping Class"),onOnSave:r},null,8,["heading","save-button-text"]),f("div",Lt,[f("div",Ht,[e(ve,{table:l(v)},{default:s(()=>[l(v).isLoading()?(n(),$(It,{key:0,shippingClassTable:l(v),"next-page-count":l(v).nextPageCount},null,8,["shippingClassTable","next-page-count"])):(n(),g("div",Wt,[e(Dt,{shipping_classes:l(v).getTableData(),columns:l(v).data.columns,onRefresh:a[0]||(a[0]=T=>l(v).fetch())},null,8,["shipping_classes","columns"])]))]),_:1},8,["table"])]),e(be,{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=T=>h.value=T),"class-data":_.value,onSaved:d},null,8,["modelValue","class-data"])])]))}},Gt={class:"single-shipping-zone-loader"},Kt={class:"single-page-header flex items-center justify-between"},Yt={class:"fct-page-header__actions"},Jt={__name:"SingleShippingClassLoader",setup(y){return(v,h)=>{const _=o("el-skeleton-item"),r=o("el-skeleton"),d=o("el-breadcrumb-item"),m=o("el-breadcrumb");return n(),g("div",Gt,[f("div",Kt,[e(m,{"separator-icon":l(ie)},{default:s(()=>[e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[90px] h-4"})]),_:1})]),_:1}),e(d,null,{default:s(()=>[e(r,{animated:"",class:"h-4"},{template:s(()=>[e(_,{variant:"p",class:"w-[60px] h-4"})]),_:1})]),_:1})]),_:1},8,["separator-icon"]),f("div",Yt,[e(r,{animated:"",class:"h-9 w-[172px]"},{template:s(()=>[e(_,{variant:"p",class:"w-full h-9 rounded"})]),_:1})])]),e(l(K),{class:"mb-4"},{default:s(()=>[e(l(Q),{title:l(t)("Class Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(G),null,{default:s(()=>[e(r,{rows:4,animated:!0})]),_:1})]),_:1})])}}},Qt={class:"setting-wrap fct-single-shipping-class-page"},Xt={class:"setting-wrap-inner"},el={key:0},tl={key:2,class:"fct-single-shipping-class"},ll={class:"form-help-text w-full"},sl={class:"form-help-text"},ge={__name:"SingleShippingClass",props:{class_id:{type:[String,Number],required:!1}},setup(y){const v=Ee(),h=y,_=_e();v.onSave(()=>{A()});const r=b(null),d=b(!1),m=b(!1),a=b({name:"",cost:0,type:"fixed"}),T=b({name:[{required:!0,message:t("Please enter a class name"),trigger:"blur"}],cost:[{required:!0,message:t("Please enter a cost"),trigger:"blur"}],type:[{required:!0,message:t("Please select a cost type"),trigger:"blur"}]}),z=b({show:!1,message:"",buttonText:"",route:""}),k=se(()=>!!h.class_id),w=()=>{if(!k.value){d.value=!1;return}d.value=!0,U.get(`/shipping/classes/${h.class_id}`).then(P=>{const S=P.shipping_class;a.value={name:S.name,cost:S.cost,type:S.type}}).catch(P=>{console.error("Error fetching shipping class:",P),z.value={show:!0,message:t("The shipping class you are looking for does not exist or has been deleted."),buttonText:t("Go to Shipping Classes"),route:{name:"shipping_classes"}}}).finally(()=>{d.value=!1})},A=()=>{r.value.validate(P=>{if(!P)return;m.value=!0;const S=k.value?"put":"post",C=k.value?`/shipping/classes/${h.class_id}`:"/shipping/classes";U[S](C,a.value).then(N=>{F.success(N.message),k.value||_.push({name:"view_shipping_class",params:{class_id:N.shipping_class.id}})}).catch(N=>{console.error("Error saving shipping class:",N),F.error(t("Failed to save shipping class"))}).finally(()=>{m.value=!1})})};return he(()=>{w()}),(P,S)=>{const C=o("el-breadcrumb-item"),N=o("el-breadcrumb"),L=o("el-input"),H=o("el-form-item"),Z=o("el-input-number"),V=o("el-option"),q=o("el-select"),D=o("el-form");return n(),g("div",Qt,[e(oe,{"save-button-text":l(t)("Save Shipping Class"),"loading-text":l(t)("Saving Shipping Class"),loading:m.value,onOnSave:A},{heading:s(()=>[e(N,{"separator-icon":l(ie)},{default:s(()=>[e(C,{to:{name:"shipping_classes"}},{default:s(()=>[x(u(l(t)("Shipping Classes")),1)]),_:1}),e(C,null,{default:s(()=>[x(u(k.value?l(t)("Edit Shipping Class"):l(t)("Add Shipping Class")),1)]),_:1}),k.value?(n(),$(C,{key:0},{default:s(()=>[x(u(a.value.name),1)]),_:1})):I("",!0)]),_:1},8,["separator-icon"])]),_:1},8,["save-button-text","loading-text","loading"]),f("div",Xt,[d.value?(n(),g("div",el,[e(Jt)])):z.value.show?(n(),$(ye,{key:1,message:z.value.message,"button-text":z.value.buttonText,route:z.value.route},null,8,["message","button-text","route"])):(n(),g("div",tl,[e(l(K),null,{default:s(()=>[e(l(Q),{title:l(t)("Class Details"),border_bottom:"",title_size:"small"},null,8,["title"]),e(l(G),null,{default:s(()=>[e(D,{model:a.value,rules:T.value,ref_key:"classFormRef",ref:r,"label-position":"top"},{default:s(()=>[e(H,{label:l(t)("Class Name"),prop:"name"},{default:s(()=>[e(L,{modelValue:a.value.name,"onUpdate:modelValue":S[0]||(S[0]=p=>a.value.name=p),placeholder:l(t)("Enter class name")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(H,{label:l(t)("Cost"),prop:"cost"},{default:s(()=>[e(Z,{modelValue:a.value.cost,"onUpdate:modelValue":S[1]||(S[1]=p=>a.value.cost=p),precision:2,min:0,step:1,class:"w-full max-w-[200px]"},null,8,["modelValue"]),f("div",ll,u(l(t)("Additional cost for products in this shipping class")),1)]),_:1},8,["label"]),e(H,{label:l(t)("Cost Type"),prop:"type"},{default:s(()=>[e(q,{modelValue:a.value.type,"onUpdate:modelValue":S[2]||(S[2]=p=>a.value.type=p),style:{width:"100%"}},{default:s(()=>[e(V,{label:l(t)("Fixed Amount"),value:"fixed"},null,8,["label"]),e(V,{label:l(t)("Percentage"),value:"percentage"},null,8,["label"])]),_:1},8,["modelValue"]),f("div",sl,u(l(t)("How this cost should be applied to the shipping rate")),1)]),_:1},8,["label"])]),_:1},8,["model","rules"])]),_:1})]),_:1})]))])])}}};window.fluent_cart_admin.hooks.addFilter("fluent_cart_routes","fluent_shipping",function(y){return y.settings&&y.settings.children&&y.settings.children.push({name:"shipping",path:"shipping",component:et,meta:{active_menu:"shipping",title:t("Shipping Zones"),permission:["store/settings","store/sensitive"]}},{name:"view_shipping_zone",path:"shipping/zone/:zone_id/edit",component:me,props:!0,meta:{active_menu:"settings",title:t("Edit Shipping Zone"),permission:["store/settings","store/sensitive"]}},{name:"add_shipping_zone",path:"shipping/zone/add",component:me,meta:{active_menu:"settings",title:t("Add Shipping Zone"),permission:["store/settings","store/sensitive"]}},{name:"shipping_classes",path:"shipping/shipping_classes",component:jt,meta:{active_menu:"settings",title:t("Shipping Classes"),permission:["store/settings","store/sensitive"]}},{name:"view_shipping_class",path:"shipping/shipping_classes/:class_id/edit",component:ge,props:!0,meta:{active_menu:"settings",title:t("Edit Shipping Class"),permission:["store/settings","store/sensitive"]}},{name:"add_shipping_class",path:"shipping/shipping_classes/add",component:ge,meta:{active_menu:"settings",title:t("Add Shipping Class"),permission:["store/settings","store/sensitive"]}}),y});
