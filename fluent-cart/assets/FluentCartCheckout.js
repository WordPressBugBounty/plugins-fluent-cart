var At=Object.defineProperty;var at=c=>{throw TypeError(c)};var Ot=(c,e,t)=>e in c?At(c,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):c[e]=t;var Dt=(c,e)=>()=>(e||c((e={exports:{}}).exports,e),e.exports);var u=(c,e,t)=>Ot(c,typeof e!="symbol"?e+"":e,t),Ve=(c,e,t)=>e.has(c)||at("Cannot "+t);var d=(c,e,t)=>(Ve(c,e,"read from private field"),t?t.call(c):e.get(c)),g=(c,e,t)=>e.has(c)?at("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(c):e.set(c,t),m=(c,e,t,i)=>(Ve(c,e,"write to private field"),i?i.call(c,t):e.set(c,t),t),f=(c,e,t)=>(Ve(c,e,"access private method"),t);import{C as v,P as Pt}from"./chunks/payment-loader.js";import{U as ee}from"./chunks/Url.js";import{u as tt,t as it}from"./chunks/timezone.js";import{d as A}from"./chunks/dayjs.min.js";import"./chunks/Str.js";import"./chunks/vue.esm-bundler.js";import"./chunks/Arr.js";var Ft=Dt((Jt,xe)=>{class Wt{constructor(e,t={}){this.element=e,this.disabled=!1;const i=this.parseSelectElement();this.options=t.options||i||[];const s=t.placeholder===!1;this.searchPlaceholder="",this.placeholder="",s||(this.placeholder=t.placeholder||this.getPlaceholderFromSelect()||"Select an option...",this.searchPlaceholder=t.searchPlaceholder||"Type to search..."),this.clearable=t.clearable!==!1,this.onChange=t.onChange||(()=>{}),this.onSearch=t.onSearch||(()=>{});const n=this.getInitialSelection();this.selectedValue=n.value,this.selectedText=n.text,this.filteredOptions=[...this.options],this.highlightedIndex=-1,this.isOpen=!1,this.searchTerm="",this.init()}init(){this.createElements(),this.bindEvents(),this.render(),this.selectedValue&&(this.input.value=this.selectedText)}parseSelectElement(){if(this.element.tagName!=="SELECT")return null;const e=[];return this.element.querySelectorAll("option").forEach(i=>{(i.value||i.textContent.trim())&&e.push({value:i.value||i.textContent.trim(),text:i.textContent.trim()})}),e}getPlaceholderFromSelect(){if(this.element.tagName!=="SELECT")return null;if(this.element.hasAttribute("data-placeholder"))return this.element.getAttribute("data-placeholder");const e=this.element.querySelector("option");return e&&!e.value&&e.textContent.trim()?e.textContent.trim():null}getInitialSelection(){if(this.element.tagName!=="SELECT")return{value:null,text:""};const e=this.element.querySelector("option[selected]")||this.element.options[this.element.selectedIndex];return e&&e.value?{value:e.value,text:e.textContent.trim()}:{value:null,text:""}}createElements(){const e=this.element.tagName==="SELECT";let t,i=e&&this.element.parentNode.classList.contains("fct-custom-searchable-select"),s=null;if(i){t=this.element.parentNode;const n=t.querySelector(".fct-custom-searchable-select-container");n&&t.removeChild(n),s=t.querySelector("input")}else t=document.createElement("div"),t.className="fct-custom-searchable-select",e?(this.element.parentNode.insertBefore(t,this.element),t.appendChild(this.element)):(t.classList.add("custom-select-wrapper"),this.element.appendChild(t));e?(this.originalElement=this.element.cloneNode(!0),this.element.style.display="none"):this.originalElement=null,this.selectContainer=document.createElement("div"),this.selectContainer.className="fct-custom-searchable-select-container",this.input=document.createElement("input"),this.input.className="select-input",this.input.type="text",this.input.placeholder=this.placeholder+"*",this.input.addEventListener("keypress",n=>{this.isOpen||n.preventDefault()}),this.originalElement&&(this.originalElement.disabled&&this.disable(),this.originalElement.required&&(this.input.required=!0),this.originalElement.name&&(s?this.hiddenInput=s:(this.hiddenInput=document.createElement("input"),t.appendChild(this.hiddenInput)),this.hiddenInput.type="hidden",this.hiddenInput.name=this.originalElement.name)),this.arrow=document.createElement("div"),this.arrow.className="select-arrow",this.clearBtn=document.createElement("button"),this.clearBtn.className="clear-btn",this.clearBtn.innerHTML="×",this.clearBtn.type="button",this.dropdown=document.createElement("div"),this.dropdown.className="select-dropdown",this.selectContainer.appendChild(this.input),this.clearable&&this.selectContainer.appendChild(this.clearBtn),this.selectContainer.appendChild(this.arrow),this.selectContainer.appendChild(this.dropdown),t.appendChild(this.selectContainer),this.hiddenInput&&(this.hiddenInput.value=this.selectedValue||""),this.wrapper=t}bindEvents(){this.selectContainer.addEventListener("click",e=>{e.target!==this.clearBtn&&this.toggle()}),this.clearBtn.addEventListener("click",e=>{e.stopPropagation(),this.clear()}),this.input.addEventListener("focus",()=>{this.isOpen||this.open()}),this.input.addEventListener("input",e=>{this.searchTerm=e.target.value,this.filter(),this.onSearch(this.searchTerm)}),this.input.addEventListener("keydown",e=>{this.handleKeydown(e)}),this.dropdown.addEventListener("click",e=>{const t=e.target.closest(".select-option");if(t&&!t.classList.contains("no-options")){const i=t.dataset.value,s=t.textContent;this.select(i,s),this.close()}}),this.outsideClickHandler=e=>{this.element.contains(e.target)||this.close()},document.addEventListener("click",this.outsideClickHandler)}handleKeydown(e){switch(e.key){case"ArrowDown":e.preventDefault(),this.highlightNext();break;case"ArrowUp":e.preventDefault(),this.highlightPrev();break;case"Enter":if(e.preventDefault(),this.highlightedIndex>=0&&this.filteredOptions[this.highlightedIndex]){const t=this.filteredOptions[this.highlightedIndex];this.select(t.value,t.text)}break;case"Escape":this.close();break;case"Backspace":this.selectedValue&&this.clear();break}}open(){this.isOpen=!0,this.selectContainer.classList.add("open"),this.input.placeholder=this.searchPlaceholder,this.highlightedIndex=-1,this.input.value="",this.filter(),setTimeout(()=>this.input.focus(),0)}close(){this.isOpen=!1,this.selectContainer.classList.remove("open"),this.input.placeholder=this.placeholder,this.searchTerm="",this.input.value=this.selectedText,this.highlightedIndex=-1}toggle(){this.isOpen?this.close():this.open()}filter(){const e=this.searchTerm.toLowerCase();this.filteredOptions=this.options.filter(t=>t.text.toLowerCase().includes(e)),this.highlightedIndex=-1,this.renderOptions()}highlightNext(){this.filteredOptions.length!==0&&(this.highlightedIndex=Math.min(this.highlightedIndex+1,this.filteredOptions.length-1),this.updateHighlight())}highlightPrev(){this.filteredOptions.length!==0&&(this.highlightedIndex=Math.max(this.highlightedIndex-1,0),this.updateHighlight())}updateHighlight(){var t;const e=this.dropdown.querySelectorAll(".select-option:not(.no-options)");e.forEach((i,s)=>{i.classList.toggle("highlighted",s===this.highlightedIndex)}),this.highlightedIndex>=0&&((t=e[this.highlightedIndex])==null||t.scrollIntoView({block:"nearest"}))}select(e,t){this.selectedValue=e,this.selectedText=t,this.input.value=t,this.hiddenInput&&(this.hiddenInput.value=e||""),this.originalElement&&(this.originalElement.value=e||""),setTimeout(()=>{this.onChange(e,t),this.close()},10)}clear(){return this.select(null,""),this}addOption(e,t){const i={value:e,text:t};return this.options.push(i),(!this.isOpen||!this.searchTerm)&&this.filteredOptions.push(i),this.render(),this}removeOption(e){return this.options=this.options.filter(t=>t.value!==e),this.filteredOptions=this.filteredOptions.filter(t=>t.value!==e),this.selectedValue===e&&this.clear(),this.render(),this}setOptions(e,t=null,i=null){return(t||i)&&(i=i??"value",t=t??"text",e=e.map(s=>({value:s[i],text:s[t]}))),this.options=e||[],this.filteredOptions=[...this.options],this.selectedValue&&!this.options.find(s=>s.value===this.selectedValue)&&this.clear(),this.render(),this}getValue(){return this.selectedValue}getText(){return this.selectedText}getSelected(){return{value:this.selectedValue,text:this.selectedText}}setValue(e){const t=this.options.find(i=>i.value===e);return t?this.select(t.value,t.text):this.clear(),this}disable(){return this.input.disabled=!0,this.disabled=!0,this.selectContainer.classList.add("disabled"),this.element.classList.add("disabled"),this}enable(){return this.input.disabled=!1,this.disabled=!1,this.selectContainer.classList.remove("disabled"),this.element.classList.remove("disabled"),this}render(){this.renderOptions()}renderOptions(){if(this.dropdown.innerHTML="",this.filteredOptions.length===0){const e=document.createElement("div");e.className="select-option no-options",e.textContent=this.searchTerm?"No matches found":"No options available",this.dropdown.appendChild(e);return}this.filteredOptions.forEach((e,t)=>{const i=document.createElement("div");i.className="select-option",i.dataset.value=e.value,i.textContent=e.text,e.value===this.selectedValue&&i.classList.add("selected"),this.dropdown.appendChild(i)})}destroy(){document.removeEventListener("click",this.outsideClickHandler),this.element.innerHTML="",this.selectContainer.remove()}}const ke={init:function(c,e={}){const t=typeof c=="string"?document.querySelector(c):c;if(!t)throw new Error("Element not found");return new Wt(t,e)}};typeof xe<"u"&&xe.exports?xe.exports=ke:typeof define=="function"&&define.amd?define(function(){return ke}):window.customSelect=ke;const te=(c,e,t={})=>{let i;e==="click"?i=MouseEvent:e==="change"?i=Event:e.includes("focus")?i=FocusEvent:i=UIEvent;const s=new i(e,{bubbles:!0,cancelable:!1,...t});c.dispatchEvent(s)},K=c=>te(c,"click"),He=c=>te(c,"change"),Nt=c=>te(c,"focusin"),Mt=c=>te(c,"focusout"),Bt=c=>te(c,"modalopen"),je=c=>te(c,"modalclose"),H=(c,e)=>c[e]!==void 0?c[e]:c.getAttribute(e),T=(c,e)=>c==null?void 0:c.classList.contains(e),k=(c,e)=>c==null?void 0:c.classList.add(e),C=(c,e)=>c==null?void 0:c.classList.remove(e),Vt={data:null,searchable:!0,showSelectedItems:!0,placeholder:"Select an option",searchtext:"Search",selectedtext:"selected",hideSelect:!0,onChange:null};var _,Ue,Fe,lt,ot,ct,dt,ht,ut,$e,pt,Ee,ft;class B{constructor(e,t={}){g(this,_);if(!e)throw new Error("No element provided to NiceSelect");if(!(e instanceof Element))throw new Error("Invalid element provided to NiceSelect - must be a valid DOM element");const i=[];e.tagName==="SELECT"&&e.querySelectorAll("option").forEach(n=>{(n.value||n.textContent.trim())&&i.push({value:n.value||n.textContent.trim(),text:n.textContent.trim()})}),t.data==null&&(t.data=i),this.el=e,this.el._niceSelect=this,this.config={...Vt,...t},this.data=this.config.data,this.selectedOptions=[],this.placeholder=H(this.el,"placeholder")||this.config.placeholder,this.searchtext=H(this.el,"searchtext")||this.config.searchtext,this.selectedtext=H(this.el,"selectedtext")||this.config.selectedtext,this.dropdown=null,this.selectionList=null,this.multiple=H(this.el,"multiple"),this.disabled=H(this.el,"disabled"),this.onChange=this.config.onChange,f(this,_,Ue).call(this),f(this,_,ct).call(this)}_renderSelectedItems(){if(this.multiple){let e="";window.getComputedStyle(this.dropdown).width==="auto"||this.selectedOptions.length<2?(this.selectedOptions.forEach((t,i,s)=>{let n=t.data.text;i!==s.length-1&&(n+=", "),e+=`<span class="current">${n||this.placeholder}</span>`}),e=e||this.placeholder):e=`${this.selectedOptions.length} ${this.selectedtext}`,this.dropdown.querySelector(".multiple-options").innerHTML=e}else{const e=this.selectedOptions.length>0?this.selectedOptions[0].data.text:this.placeholder,t=this.dropdown.querySelector(".current");t.innerHTML=e,this.selectedOptions.length>0&&(!this.selectedOptions[0].data.value||this.selectedOptions[0].data.value==="")?t.classList.add("empty-value"):t.classList.remove("empty-value")}}setSelected(e){let t=null;for(let s=0;s<this.options.length;s++)if(this.options[s].data.value===e){t=this.options[s];break}const i=t==null?void 0:t.element;i&&(i.click(),C(this.dropdown,"open"))}_renderItems(){const e=this.dropdown.querySelector("ul");this.options.forEach(t=>{t.data.value!==""&&(this.multiple&&this.config.showSelectedItems&&this._multipleListAdd(t),e.appendChild(this._renderItem(t)))})}_renderItem(e){const t=document.createElement("li");if(t.innerHTML=e.data.text,e.data.extra!==void 0&&t.appendChild(this._renderItemExtra(e.data.extra)),e.attributes.optgroup)k(t,"optgroup");else{t.setAttribute("data-value",e.data.value);const i=["option"];e.attributes.selected&&i.push("selected"),e.attributes.disabled&&i.push("disabled"),t.classList.add(...i),t.addEventListener("click",s=>this._onDropdownItemClicked(e,s))}return e.element=t,t}_renderItemExtra(e){const t=document.createElement("span");return t.innerHTML=e,k(t,"extra"),t}update(e=""){var i;let t=this;e!=""&&(t=e.target._niceSelect),f(i=t,_,$e).call(i)}disable(){this.disabled||(this.disabled=!0,k(this.dropdown,"disabled"))}enable(){this.disabled&&(this.disabled=!1,C(this.dropdown,"disabled"))}clear(){f(this,_,ut).call(this),this.selectedOptions=[],this._renderSelectedItems(),this.update(),He(this.el)}destroy(){this.selectionList&&f(this,_,Ee).call(this),this.dropdown&&(this.dropdown.remove(),this.el.classList.remove("hidden-select"))}focus(e=""){if(T(this.dropdown,"open")?this.multiple?e===this.dropdown.querySelector(".multiple-options")&&(C(this.dropdown,"open"),je(this.el)):(C(this.dropdown,"open"),je(this.el)):(k(this.dropdown,"open"),Bt(this.el)),T(this.dropdown,"open")){const i=this.dropdown.querySelector(".fct-nice-select-search");i&&(i.value="",i.focus());const s=this.dropdown.querySelector(".focus");s&&C(s,"focus");const n=this.dropdown.querySelector(".selected");n&&k(n,"focus"),this.dropdown.querySelectorAll("ul li").forEach(r=>r.style.display="")}else this.dropdown.focus()}_bindSearchEvent(){const e=this.dropdown.querySelector(".fct-nice-select-search");e&&(e.addEventListener("click",t=>t.stopPropagation()),e.addEventListener("input",t=>this._onSearchChanged(t)))}_onClicked(e){e.preventDefault(),this.focus(e.target)}_onDropdownItemClicked(e,t){const i=t.target;if(!T(i,"disabled")){if(this.multiple){let s;T(i,"selected")?(s=!1,C(i,"selected"),this.selectedOptions=this.selectedOptions.filter(n=>n.data!==e.data)):(s=!0,k(i,"selected"),this.selectedOptions.push(e)),e.data.selected=s,e.attributes.selected=s}else{this.dropdown.querySelectorAll("li.selected").forEach(n=>C(n,"selected")),k(i,"selected"),this.selectedOptions=[e];let s=this.options.find(n=>n.attributes.selected);s&&(s.data.selected=!1,s.attributes.selected=!1),e.data.selected=!0,e.attributes.selected=!0}this._renderSelectedItems(),f(this,_,ht).call(this),f(this,_,pt).call(this)}}setOnChange(e){this.onChange=e}_onClickedOutside(e){this.dropdown.contains(e.target)||(C(this.dropdown,"open"),je(this.el))}_onKeyPressed(e){const t=this.dropdown.querySelector(".focus"),i=T(this.dropdown,"open");if(e.keyCode===13)K(i?t:this.dropdown);else if(e.keyCode===40){if(!i)K(this.dropdown);else{const n=this._findNext(t);n&&(t&&C(t,"focus"),k(n,"focus"))}e.preventDefault()}else if(e.keyCode===38){if(!i)K(this.dropdown);else{const n=this._findPrev(t);n&&(t&&C(t,"focus"),k(n,"focus"))}e.preventDefault()}else if(e.keyCode===27&&i)K(this.dropdown);else if(e.keyCode===32&&i)return!1;const s=this.dropdown.querySelector(".focus");return s&&s.scrollIntoView({block:"center"}),!1}_findNext(e){let t=e?e.nextElementSibling:this.dropdown.querySelector(".list .option");for(;t;){if(!T(t,"disabled")&&t.style.display!=="none")return t;t=t.nextElementSibling}return null}_findPrev(e){let t=e?e.previousElementSibling:this.dropdown.querySelector(".list .option:last-child");for(;t;){if(!T(t,"disabled")&&t.style.display!=="none")return t;t=t.previousElementSibling}return null}_onSearchChanged(e){const t=e.target.value.toLowerCase();if(t==="")this.options.forEach(s=>{s.element&&(s.element.style.display="")});else if(T(this.dropdown,"open")){const s=new RegExp(t);this.options.forEach(n=>{n.element&&(n.element.style.display=s.test(n.data.text.toLowerCase())?"":"none")})}this.dropdown.querySelectorAll(".focus").forEach(s=>C(s,"focus"));const i=this._findNext(null);i&&k(i,"focus")}_triggerValidationMessage(e){e==="invalid"?(k(this.dropdown,"invalid"),C(this.dropdown,"valid")):(k(this.dropdown,"valid"),C(this.dropdown,"invalid"))}setOptions(e,t=null,i=null){if((t||i)&&(i=i??"value",t=t??"text",e=e.map(s=>({value:s[i],text:s[t],selected:s.selected||!1,disabled:s.disabled||!1,extra:s.extra}))),this.data=e||[],f(this,_,Fe).call(this,this.data),this.selectedOptions.length>0){const s=this.data.map(r=>r.value),n=this.selectedOptions.filter(r=>s.includes(r.data.value));n.length===0?this.clear():this.selectedOptions=n}return f(this,_,ft).call(this),f(this,_,$e).call(this),this}_multipleListAdd(e){if(!this.multiple||e.data.disabled||e.data.value==""||!e.attributes.selected)return;if(this.selectionList==null)this.selectionList=document.createElement("ul"),this.selectionList.classList.add("select-selection-list"),this.el.after(this.selectionList);else if(this.selectionList.querySelector(`[data-value="${e.data.value}"]`)!=null)return;let t=document.createElement("li");t.classList.add("select-selection"),t.dataset.value=e.data.value;let i=`
      <button type="button" class="small remove-select-selection">
        <span class='remove-select-selection'>×</span>
      </button>
    `;i+=`<span class='selected-name'>${e.data.text}</span>`,t.innerHTML=i,this.selectionList.appendChild(t),t.querySelectorAll(".remove-select-selection").forEach(s=>s.addEventListener("click",this._multipleListRemove.bind(this)))}_multipleListRemove(e){if(this.selectionList==null||(e.target!=null&&(e=e.target),e.matches==null||!e.matches(".remove-select-selection")))return;let t=e.closest("li.select-selection"),i=this.options.find(s=>s.data.value===t.dataset.value).element;i&&i.matches(".selected")&&i.click()}}_=new WeakSet,Ue=function(e=!0){this.data?f(this,_,Fe).call(this,this.data):f(this,_,lt).call(this,e),this.el.classList.remove("hidden-select"),f(this,_,ot).call(this),this.config.hideSelect&&this.el.classList.add("hidden-select"),f(this,_,dt).call(this)},Fe=function(e){this.options=e.map(t=>({data:t,attributes:{selected:!!t.selected,disabled:!!t.disabled,optgroup:t.value==="optgroup"}}))},lt=function(e){const t=Array.from(this.el.querySelectorAll("option,optgroup")),i=[],s=[];this.data=t.map(n=>{let r,l=n.selected;e&&n.selected&&!n.defaultSelected&&(l=!1),n.tagName==="OPTGROUP"?r={text:n.label,value:"optgroup"}:r={text:n.dataset.display??n.innerText,value:n.value,extra:n.dataset.extra,selected:l,disabled:n.disabled};const o={selected:l,disabled:n.disabled,optgroup:n.tagName==="OPTGROUP"},a={data:r,attributes:o,element:null};return i.push(a),o.selected&&s.push(a),r}),this.options=i,this.selectedOptions=s},ot=function(){const e=["fct-nice-select",H(this.el,"class")||"",this.disabled?"disabled":"",this.multiple?"has-multiple":""].filter(Boolean),t=this.config.searchable?`
  <div class="fct-nice-select-search-box">
    <input type="text" class="fct-nice-select-search" placeholder="${this.searchtext}..." title="search"/>
  </div>
`:"",i=`
  <div class="${e.join(" ")}" tabindex="${this.disabled?"":0}">
    <span class="${this.multiple?"multiple-options":"current"}"></span>
    <div class="fct-nice-select-dropdown">
      ${t}
      <ul class="list"></ul>
    </div>
  </div>
`;this.el.insertAdjacentHTML("afterend",i),this.dropdown=this.el.nextElementSibling,this._renderSelectedItems(),this._renderItems()},ct=function(){this.el.addEventListener("invalid",()=>this._triggerValidationMessage("invalid")),window.addEventListener("click",e=>this._onClickedOutside(e)),this.el.addEventListener("change",this.update)},dt=function(){this.dropdown.addEventListener("click",e=>this._onClicked(e)),this.dropdown.addEventListener("keydown",e=>this._onKeyPressed(e)),this.dropdown.addEventListener("focusin",()=>Nt(this.el)),this.dropdown.addEventListener("focusout",()=>Mt(this.el)),this.config.searchable&&this._bindSearchEvent()},ht=function(){const e=this.el;if(this.selectedOptions.length>0?e.value=this.selectedOptions[0].data.value:(e.value="",e.selectedIndex=-1),this.options.forEach(t=>{let i=Array.from(e.options).find(s=>s.textContent===t.data.text);i==null&&(i=Array.from(e.options).find(s=>s.textContent===t.data.value)),i&&(t.attributes.selected?i.selected=!0:i.selected=!1)}),e.removeEventListener("change",this.update),He(e),this.onChange&&typeof this.onChange=="function"){this.onChange(e.value,e);const t=new Event("change",{bubbles:!0,cancelable:!0});e.dispatchEvent(t)}e.addEventListener("change",this.update)},ut=function(){if(this.multiple){const e=this.el;this.selectedOptions.forEach(t=>{const i=e.querySelector(`option[value="${t.data.value}"]`);i&&(i.selected=!1)})}else this.selectedOptions.length>0&&(this.el.selectedIndex=-1);He(this.el)},$e=function(){if(this.dropdown){const e=T(this.dropdown,"open");f(this,_,Ee).call(this),this.dropdown.remove(),this.data=null,f(this,_,Ue).call(this,!1),e&&K(this.dropdown)}H(this.el,"disabled")?this.disable():this.enable()},pt=function(){this.config.showSelectedItems&&(f(this,_,Ee).call(this),this.selectedOptions.forEach(e=>{this._multipleListAdd(e)}))},Ee=function(){this.selectionList!=null&&(this.selectionList.remove(),this.selectionList=null)},ft=function(){this.el.innerHTML="",this.data.forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.text,t.selected=e.selected||!1,t.disabled=e.disabled||!1,e.extra&&(t.dataset.extra=e.extra),this.el.appendChild(t)})};var se,Re;class x{static async getCountryInfo(e,t="billing"){return this.countryInfo[e]?{...this.countryInfo[e],cached:!0}:await f(this,se,Re).call(this,null,e,t)}static getCountryCodeByTimeZone(e){return this.countryCodeByTimeZone[e]?this.countryCodeByTimeZone[e]:null}static async getCountryInfoByTimeZone(e,t="billing"){const i=this.getCountryCodeByTimeZone(e);return i&&this.countryInfo[i]?this.countryInfo[i]:await f(this,se,Re).call(this,e,null,t)}}se=new WeakSet,Re=async function(e,t,i="billing"){const s=e?{timezone:e}:{country_code:t};i&&(s.type=i);let n=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes&fc_checkout_action=get_country_info`).toString();n=ee.appendQueryParams(n,s);let r;return await fetch(n,{headers:{"X-WP-Nonce":window.fluentCartRestVars.rest.nonce},credentials:"include"}).then(async l=>{var o;l=await l.json(),r={...l},delete l.views,this.countryInfo[(o=l.country_info)==null?void 0:o.country_code]=l==null?void 0:l.country_info,l!=null&&l.fragments&&v.handleFragments(l.fragments)}),r==null?void 0:r.country_info},g(x,se),u(x,"countryInfo",window.fluentcart_checkout_info.country_info||{}),u(x,"countryCodeByTimeZone",{});window.fluent_cart_localization_service={getCountryInfo:x.getCountryInfo,getCountryCodeByTimeZone:x.getCountryCodeByTimeZone,getCountryInfoByTimeZone:x.getCountryInfoByTimeZone};var z,qe,Q,Ie,Ae,ne,re,ae,y,gt,mt,Z,yt,wt,_t,Ze,vt,bt,St,Ct,kt,Et,xt,Lt,Tt;const X=class X{constructor(e){g(this,y);g(this,qe,{});g(this,Q);u(this,"form");g(this,Ie,null);g(this,Ae,null);g(this,ne,null);u(this,"isAllDigital");u(this,"translate",window.fluentcart.$t);g(this,re,"");g(this,ae,{".fct_error_billing_address_section_section":["billing_address_1","billing_address_2","billing_city","billing_postcode","billing_country","billing_state","billing_phone"]});var t,i;this.checkoutInfo=window.fluentcart_checkout_info,m(this,ne,e),m(this,Q,window.fluentCartRestVars.rest.url),this.nonce=(t=window.fluentCartRestVars)==null?void 0:t.rest.nonce,this.addAddressUrl=`${d(this,Q)}/customers/add-address`,this.findAddressUrl=`${d(this,Q)}/customers/`,m(this,Ae,v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes&fc_checkout_action=update_address_select`)),this.isAllDigital=((i=window.fluentcart_checkout_vars)==null?void 0:i.is_all_digital.toString())==="1",A.extend(tt),A.extend(it),m(this,Ie,A.tz.guess()),m(this,re,window.fluentcart_checkout_info.checkout_nonce)}init(){return d(X,z)!==null?d(X,z):(this.initAddressFieldModalAction(),m(X,z,this),this.initialSetup(),this.bindErrorCleanupListeners(),this)}initialSetup(){document.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button-wrapper]");const e=document.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button].selected"),t=document.querySelector("[data-fluent-cart-checkout-page-form-address-modal-apply-button]");e&&t&&(t.dataset.addressId=e.dataset.id)}initAddressFieldModalAction(){document.addEventListener("click",e=>{const t=e.target.closest("[data-fluent-cart-checkout-page-form-address-modal-open-button]");if(t){const i=f(this,y,Ze).call(this,t);if(i){const o=i.value;t.parentNode.querySelectorAll("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button]").forEach(w=>w.classList.remove("selected"));const h=t.parentNode.querySelector(`[data-id='${o}']`);h&&h.classList.add("selected")}f(this,y,Z).call(this);const s=f(this,y,mt).call(this,t),n=s.dataset.fluentCartAddressType,r=s.cloneNode(!0);r.classList.remove("hidden"),r.classList.add("show"),f(this,y,wt).call(this,r,t,n),f(this,y,_t).call(this,r,t),r.querySelectorAll("[data-fluent-cart-checkout-page-form-address-modal-close-button]").forEach(o=>{o.addEventListener("click",()=>r.remove())});const l=document.createElement("div");l.className="fluent-cart-checkout-page-form-address-modal-backdrop",l.addEventListener("click",()=>f(this,y,Z).call(this)),r.appendChild(l),f(this,y,St).call(this,r),f(this,y,Et).call(this,r),f(this,y,Lt).call(this,r,n,t),f(this,y,yt).call(this,r),f(this,y,gt).call(this,r)}})}initStateSelect(e,t=null){var i,s;return(s=(i=t==null?void 0:t.address_locale)==null?void 0:i.state)!=null&&s.label,ke.init(e,{placeholder:!1,onChange:n=>{}})}initStateSelect2(e,t=null){var i,s;return(s=(i=t==null?void 0:t.address_locale)==null?void 0:i.state)!=null&&s.label,new B(e,{placeholder:!1,onChange:n=>{}})}onCountryChanged(e="billing",t){let i=[{text:"Select a option",value:""}];t==null||t.states.forEach(s=>{i.push({text:s.name,value:s.value})}),this.billingStateSelect.setOptions(i)}updateStateInput(e,t="billing"){var a,h,w;if(!e)return;const i=(h=(a=e==null?void 0:e.address_locale)==null?void 0:a.state)==null?void 0:h.hidden;e==null||e.states;const s="#"+t+"_state_wrapper";let n=this.form.querySelector("#"+t+"_state");if(!n)return;const r=((n==null?void 0:n.tagName)||"").toLowerCase(),l=((w=e==null?void 0:e.states)==null?void 0:w.length)||0,o=["select","select-one"].includes(r);if(i)this.form.querySelector(s).style.display="none";else if(this.form.querySelector(s).style.display="block",this.billingStateSelect!==null&&(this.billingStateSelect.destroy(),this.billingStateSelect=null),l===0)o&&(n=this.convertElementToType(n,"input"));else{o||(n=this.convertElementToType(n,"select"));let p=[];e==null||e.states.forEach(b=>{p.push({text:b.name,value:b.value})}),this.billingStateSelect=this.initStateSelect2(n,e).setOptions(p)}}convertElementToType(e,t){if(!e||!t)return;const i=document.createElement(t);return i.id=e.id,i.name=e.name,i.className=e.className,i.value=e.value,Array.from(e.attributes).forEach(s=>{s.name.startsWith("data-")&&i.setAttribute(s.name,s.value)}),e.parentNode.replaceChild(i,e),t==="input"&&(i.value=""),i}async getCountryInfo(e,t){const i=e?{timezone:e}:{country_code:t};let s=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes&fc_checkout_action=get_country_info`).toString();s=ee.appendQueryParams(s,i);let n=null;if(e||(n=d(this,qe)[i.country_code]),n)return n;let r;return await fetch(s,{headers:{"X-WP-Nonce":window.fluentCartRestVars.rest.nonce},credentials:"include"}).then(async l=>{l=await l.json(),r=l==null?void 0:l.country_info,l!=null&&l.fragments&&v.handleFragments(l.fragments)}),r}removeValidationErrors(){document.querySelectorAll("[data-fluent-cart-checkout-page-form-input-wrapper]").forEach(e=>e.classList.remove("has-error")),document.querySelectorAll("[data-fluent-cart-checkout-page-form-error]").forEach(e=>e.innerHTML="")}showValidationErrors(e){const t=document.querySelectorAll(".fct_checkout_form_section"),i=(e==null?void 0:e.errors)||{};t.forEach(n=>{Object.entries(d(this,ae)).forEach(([r,l])=>{const o=n.querySelector(r);if(!o)return;const a={};l.forEach(h=>{i[h]&&(a[h]=i[h])}),Object.keys(a).length?(o.classList.add("show_error"),o.innerHTML=Object.entries(a).flatMap(([h,w])=>Object.values(w).map(p=>`<span data-fct-error-field="${h}">${p}</span>`)).join("")):(o.classList.remove("show_error"),o.innerHTML="")})});const s=Object.values(i).flatMap(n=>Object.values(n));s.length&&new Toastify({text:s.join("<br>")||"Validation Error!",className:"warning",escapeMarkup:!1,duration:3e3,style:{color:"#000",background:"#ffffff"}}).showToast()}clearFieldError(e){Object.entries(d(this,ae)).forEach(([t,i])=>{if(!i.includes(e)||!this.form)return;const s=this.form.querySelector(t);if(!s)return;const n=s.querySelector(`[data-fct-error-field="${e}"]`);n&&(n.classList.add("fct-error-leave"),n.addEventListener("transitionend",()=>{n.remove(),s.querySelector("span")||s.classList.remove("show_error")},{once:!0}))})}bindErrorCleanupListeners(){const e=t=>{var s;const i=t.target;i.name&&(s=i.value)!=null&&s.trim()&&this.clearFieldError(i.name)};document.addEventListener("input",e),document.addEventListener("change",e)}saveCustomerData(e,t){var o;const i=d(this,ne).prepareFormData(),s=((o=window.fluentCartUtmManager)==null?void 0:o.get())||{};Object.keys(s).forEach(a=>{t&&i.append(`utm_data[${a}]`,s[a])});const n=new URLSearchParams;for(const[a,h]of i.entries())n.append(a,h);const r=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes`),l=ee.appendQueryParams(r.toString(),{fc_checkout_action:"save_checkout_data",data_key:e,data_value:t});window.fluent_cart_checkout_ui_service.setLoading("shippingMethodsWrapper"),fetch(l,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-WP-Nonce":d(this,re)},credentials:"include",body:n}).then(a=>a.json()).then(a=>{var h,w,p,b,D,P;if(a!=null&&a.changes){if((h=a==null?void 0:a.changes)!=null&&h.billing_address_id){const S=document.querySelector("#billing_address_id");S&&(S.value=(w=a==null?void 0:a.changes)==null?void 0:w.billing_address_id)}if((p=a==null?void 0:a.changes)!=null&&p.billing_company_name){const S=document.querySelector("#billing_company_name");S&&(S.value=(b=a==null?void 0:a.changes)==null?void 0:b.billing_company_name)}if((D=a==null?void 0:a.changes)!=null&&D.billing_full_name){const S=document.querySelector("#billing_full_name");S&&(S.value=(P=a==null?void 0:a.changes)==null?void 0:P.billing_full_name)}}a!=null&&a.fragments&&v.handleFragments(a.fragments),(a!=null&&a.shipping_charge_changes||a!=null&&a.tax_total_Changes)&&this.checkoutHandler.handleCheckoutAmountChanges()}).finally(()=>{window.fluent_cart_checkout_ui_service.finishLoading("shippingMethodsWrapper")})}};z=new WeakMap,qe=new WeakMap,Q=new WeakMap,Ie=new WeakMap,Ae=new WeakMap,ne=new WeakMap,re=new WeakMap,ae=new WeakMap,y=new WeakSet,gt=function(e){const t=i=>{(i.key==="Escape"||i.keyCode===27)&&(f(this,y,Z).call(this),document.removeEventListener("keydown",t))};document.addEventListener("keydown",t),e._escKeyHandler=t},mt=function(e){return e.closest("[data-fluent-cart-checkout-page-form-address-modal-wrapper]").querySelector("[data-fluent-cart-checkout-page-form-address-modal-body]")},Z=function(){document.querySelectorAll("body > [data-fluent-cart-checkout-page-form-address-modal-body]").forEach(e=>{e._escKeyHandler&&document.removeEventListener("keydown",e._escKeyHandler),e.remove()})},yt=function(e){document.body.appendChild(e)},wt=function(e,t,i){e.querySelectorAll("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button]").forEach(s=>{s.addEventListener("click",()=>{e.querySelectorAll("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button]").forEach(r=>r.classList.remove("selected")),s.classList.add("selected");const n=e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-apply-button]");n&&(n.dataset.addressId=s.dataset.id,n.dataset.country=s.dataset.country,n.dataset.state=s.dataset.state,n.dataset.addressType=i)})})},_t=function(e,t){const i=e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-apply-button]");i.closest("[data-fluent-cart-checkout-page-form-address-modal-body]").dataset.fluentCartAddressType,i&&i.addEventListener("click",()=>{const n=i.dataset.addressId;if(!n)return;const r=i.dataset.country,l=i.dataset.state,o=f(this,y,vt).call(this,t),a=f(this,y,Ze).call(this,t),h=i.dataset.addressType;if(a){const w=a.dataset.country,p=a.dataset.state;if(w!==r||p!==l){a.value=n,a.dataset.country=r,a.dataset.state=l;const b=new Event("change",{bubbles:!0,cancelable:!0});a.dispatchEvent(b),window.dispatchEvent(new CustomEvent("fluentCartNotifyAddressCountryChanged",{detail:{country:r,state:l,input:a,addressType:h}}))}}o&&f(this,y,bt).call(this,n,o,h),f(this,y,Z).call(this)})},Ze=function(e){const t=e.closest("[data-fluent-cart-checkout-page-form-address-select-wrapper]");return(t==null?void 0:t.querySelector("[data-fluent-cart-checkout-page-form-address-input]"))??null},vt=function(e){const t=e.closest("[data-fluent-cart-checkout-page-form-address-select-wrapper]");return(t==null?void 0:t.querySelector("[data-fluent-cart-checkout-page-form-address-info-wrapper]"))??null},bt=function(e,t,i){this.saveCustomerData(i+"_address_id",e)},St=function(e){e.querySelectorAll("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-button]").forEach(t=>{t.addEventListener("click",()=>f(this,y,Ct).call(this,e,t))})},Ct=function(e,t){e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button-wrapper]").classList.add("hide");const i=e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]");this.form=i,this.formType=i.querySelector("#billing_state")||i.querySelector("#billing_country")?"billing":"shipping",f(this,y,kt).call(this,i),i.classList.add("show"),t.parentNode.style.display="none"},kt=async function(e){var l,o,a,h;let t=null;const i="#"+this.formType+"_state",s="#"+this.formType+"_country",n=e.querySelector(s),r=e.querySelector(i);n&&(o=(l=n.nextElementSibling)==null?void 0:l.classList)!=null&&o.contains("fct-nice-select")&&n.nextElementSibling.remove(),r&&((h=(a=r.nextElementSibling)==null?void 0:a.classList)!=null&&h.contains("fct-nice-select")&&r.nextElementSibling.remove(),this.billingStateSelect=new B(r,{placeholder:!1,data:null})),n&&new B(n,{placeholder:this.translate("Select a Country"),clearable:!1,data:null,onChange:async w=>{if(w){const p=await x.getCountryInfo(w);this.updateStateInput(p,this.formType)}else e.querySelector(i).value="",this.billingStateSelect.setOptions([])}}),r&&this.onCountryChanged(this.formType,t)},Et=function(e){e.addEventListener("click",t=>{const i=t.target.closest("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-cancel-button]");i&&f(this,y,xt).call(this,e,i)})},xt=function(e,t){e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button-wrapper]").classList.remove("hide"),e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button-wrapper]").classList.add("show"),e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]").classList.remove("show"),e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]").classList.add("hide"),e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-button]").parentNode.style.display=""},Lt=function(e,t,i){const s=e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]"),n=s.cloneNode(!0),r=document.createElement("form");r.appendChild(n),s.replaceWith(r);const l=this.isAllDigital?"digital":"physical";r.addEventListener("submit",o=>{var w;o.preventDefault();const a=new FormData(r);a.append("type",t),a.append("product_type",l);const h=`${t}_label`;if(((w=a.get(h))==null?void 0:w.length)>15){new Toastify({text:this.translate("Label must not exceed 15 characters."),className:"warning",duration:900}).showToast();return}f(this,y,Tt).call(this,e,a,i)})},Tt=function(e,t,i){this.removeValidationErrors();let s=v.buildUrl(this.addAddressUrl.toString()).toString();fetch(s,{method:"POST",body:t,headers:{"X-WP-Nonce":this.nonce}}).then(async n=>{if(n.ok)return await n.json();throw this.showValidationErrors(await n.json()),Error("Failed to submit form")}).then(n=>{if(n.fragment)if(Array.isArray(n.fragment))n.fragment.forEach(l=>{const o=document.querySelector(l.selector);o&&l.type==="replace"&&(o.outerHTML=l.content)});else{let l=document.querySelector(n.fragment.selector);l&&n.fragment.type==="replace"&&(l.outerHTML=n.fragment.content)}const r=e.querySelector("[data-fluent-cart-checkout-page-form-address-modal-address-selector-button-wrapper]");document.querySelectorAll("[data-fluent-cart-checkout-page-form-address-select-wrapper]"),r.classList.remove("hide"),r.classList.remove("show"),e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]").classList.remove("show"),e.querySelector("[data-fluent-cart-checkout-page-form-address-show-add-new-modal-form-wrapper]").classList.add("hide"),n.message&&(new Toastify({text:n.message,className:"info",duration:900}).showToast(),f(this,y,Z).call(this))}).catch(n=>{})},g(X,z,null);let Ke=X;var I,Oe,le,oe,ce,de,G,he,L,U,ue,J,O,qt,Xe,It;class Ht{constructor(e){g(this,O);g(this,I);g(this,Oe);g(this,le);g(this,oe);g(this,ce);g(this,de);g(this,G);g(this,he);g(this,L,[]);g(this,U,!1);g(this,ue,!1);u(this,"translate",window.fluentcart.$t);g(this,J,"");var t;m(this,I,e),m(this,Oe,window.fluentcart_checkout_vars.rest.url),m(this,ue,((t=window.fluentcart_checkout_vars)==null?void 0:t.disable_coupons.toString())==="yes"),m(this,le,v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes&fc_checkout_action=apply_coupon`)),m(this,oe,v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes&fc_checkout_action=remove_coupon`)),m(this,J,window.fluentcart_checkout_info.checkout_nonce),m(this,ce,"[data-fluent-cart-checkout-page-coupon-container]"),m(this,de,"[data-fluent-cart-checkout-page-coupon-field-toggle]"),m(this,G,"[data-fluent-cart-checkout-page-coupon-validate]"),m(this,he,"[data-fluent-cart-checkout-page-form-input-wrapper]")}init(){setTimeout(()=>{f(this,O,qt).call(this)},300),window.addEventListener("fluentCartNotifySummaryViewUpdated",()=>{}),window.fluentCartCouponService=this}getCoupons(){return d(this,L)}addCoupon(e){d(this,L).push(e)}removeCouponByCode(e){m(this,L,d(this,L).filter(t=>t!==e)),this.removeCouponFromUrl(e)}removeCouponFromUrl(e){const t=new URL(window.location.href),i=t.searchParams,s=i.get("coupons");if(s){const n=s.split(",").filter(l=>l!==e).join(",");n?i.set("coupons",n):i.delete("coupons");const r=t.pathname+"?"+i.toString();history.replaceState(null,"",r)}}}I=new WeakMap,Oe=new WeakMap,le=new WeakMap,oe=new WeakMap,ce=new WeakMap,de=new WeakMap,G=new WeakMap,he=new WeakMap,L=new WeakMap,U=new WeakMap,ue=new WeakMap,J=new WeakMap,O=new WeakSet,qt=function(){d(this,ue)||(d(this,I).addEventListener("pointerdown",e=>{e.target.closest(d(this,G))&&(e.preventDefault(),f(this,O,Xe).call(this))}),d(this,I).addEventListener("click",e=>{if(e.target.closest(d(this,G))){if(d(this,U)){e.preventDefault();return}e.stopPropagation()}})),d(this,I).addEventListener("click",e=>{if(!e.target.closest(d(this,de)))return;e.preventDefault();const i=document.querySelector(d(this,ce));if(i){const s=i.querySelector(d(this,he));if(s){const n=s.querySelector("input");n&&setTimeout(()=>n.focus(),0)}i.style.display=i.style.display==="none"||!i.style.display?"block":"none"}}),d(this,I).addEventListener("click",e=>{const t=e.target.closest("[data-remove-coupon]");if(!t||!t.closest("[data-fluent-cart-checkout-page-applied-coupon]"))return;e.preventDefault();const s=t.dataset.coupon??t.getAttribute("data-coupon");f(this,O,It).call(this,s)}),d(this,I).addEventListener("keypress",e=>{e.target.id==="coupon"&&e.key==="Enter"&&(e.preventDefault(),f(this,O,Xe).call(this))})},Xe=function(){m(this,U,!0);const e=document.getElementById("coupon").value,t=document.getElementById("billing_email").value,i=ee.appendQueryParams(d(this,le).toString(),{coupon_code:e,customer_email:t});fetch(i,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":d(this,J)},credentials:"include"}).then(s=>(m(this,U,!1),s.ok?s.json():s.json().then(n=>{throw new Error(n.message)}))).then(s=>{v.handleFragments(s.fragments),m(this,L,s.applied_coupons),document.getElementById("coupon").value="",d(this,L).includes(e)?(new Toastify({text:this.translate("Applied Successfully"),className:"info",duration:3e3}).showToast(),window.dispatchEvent(new CustomEvent("fluentCartNotifyCouponApplied",{detail:{response:s}})),window.dispatchEvent(new CustomEvent("fluentCartCheckoutDataChanged",{detail:{response:s}}))):new Toastify({text:this.translate("Coupon cannot be applied"),className:"info",duration:3e3}).showToast()}).catch(s=>{m(this,U,!1),new Toastify({text:`<span class="warn warning"></span>${s.message}`,className:"warning",escapeMarkup:!1,duration:3e3,close:!1}).showToast()})},It=function(e){this.removeCouponByCode(e),fetch(d(this,oe)+"&coupon_code="+e,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":d(this,J)},credentials:"include"}).then(t=>t.ok?(new Toastify({text:this.translate("Coupon removed!"),className:"info",duration:3e3}).showToast(),t.json()):t.text().then(i=>{throw new Error(i)})).then(t=>{m(this,L,t.applied_coupons),t.fragments&&v.handleFragments(t.fragments),window.dispatchEvent(new CustomEvent("fluentCartNotifyCouponRemoved",{detail:{response:t}})),window.dispatchEvent(new CustomEvent("fluentCartCheckoutDataChanged",{detail:{response:t}}))}).catch(t=>{this.addCoupon(e),console.error("Failed to cancel coupon:",t.message)})};var Y,pe;const W=class W{constructor(e,t){g(this,Y,null);u(this,"formWrapper");u(this,"checkoutHandler",null);u(this,"onReady",null);u(this,"defaultCountry",null);g(this,pe,"");u(this,"translate",window.fluentcart.$t);var i;this.formWrapper=e.form,this.checkoutHandler=e,this.isAllDigital=((i=window.fluentcart_checkout_vars)==null?void 0:i.is_all_digital.toString())==="1",m(this,pe,window.fluentcart_checkout_info.checkout_nonce),A.extend(tt),A.extend(it),m(this,Y,A.tz.guess()),this.onReady=t,this.initCustomBillingSelect()}static init(e,t){return W.instance===null&&(W.instance=new W(e,t)),window.fluent_cart_address_service=W.instance,W.instance}async initCustomBillingSelect(){var o,a,h,w;let e=this.formWrapper.querySelector("#billing_country"),t="";e&&(t=e.value);let i=null;(!e||!d(this,Y)&&!t)&&(t=window.fluentcart_checkout_info.store_country),t?i=await x.getCountryInfo(t):(i=await x.getCountryInfoByTimeZone(d(this,Y)),i!=null&&i.country_code&&this.saveCustomerData("billing_country",i==null?void 0:i.country_code)),e&&i&&(e.value=i==null?void 0:i.country_code),i.cached&&this.saveCustomerData("billing_country",i==null?void 0:i.country_code);let s=this.formWrapper.querySelector("#billing_state"),n="";s&&(n=s.value),this.stateLabel="State",i&&((a=(o=i.address_locale)==null?void 0:o.state)!=null&&a.label)&&(this.stateLabel=(w=(h=i.address_locale)==null?void 0:h.state)==null?void 0:w.label),s&&(this.billingStateSelect=new B(s,{placeholder:this.stateLabel,data:null}));let r="";e&&(r=e.value),this.defaultCountry=r,e&&(this.billingCountrySelect=new B(e,{placeholder:"Select a Country",clearable:!1,data:null})),e&&r&&this.billingCountrySelect.setSelected(r),e&&e.value===r&&s&&this.billingStateSelect.setSelected(n);const l=this;if(e&&(this.billingCountrySelect.setOnChange(async p=>{if(window.fluent_cart_checkout_ui_service.setComponentState("billingStateSelect","loading"),p){const b=await x.getCountryInfo(p);l.saveCustomerData("billing_country",p),b&&window.fluent_cart_checkout_ui_service.setComponentState("billingStateSelect","enable"),window.fluent_cart_shipping_service&&window.fluent_cart_shipping_service.shippingToDifferent===!1&&(b.views?window.fluent_cart_shipping_service.updateShippingMethodsView({view:b.views.shipping_methods,status:!0}):window.fluent_cart_shipping_service.handleBillingAddressChange(p)),this.updateStateInput(b,"billing")}else this.formWrapper.querySelector("#billing_state")&&(this.formWrapper.querySelector("#billing_state").value="",this.billingStateSelect.setOptions([]))}),this.onCountryChanged("billing",i,i==null?void 0:i.country_code)),this.updateStateInput(i,"billing"),s&&this.billingStateSelect,this.isAllDigital)typeof this.onReady=="function"&&this.onReady();else{const p={response:i,defaultCountry:r,defaultState:n};this.initCustomShippingSelect(p)}}initCustomShippingSelect(e){var r;const t=this.formWrapper.querySelector("#shipping_state"),i=this.formWrapper.querySelector("#shipping_country");let s="";i&&(s=i.value);let n="";t&&(n=t.value),t&&(this.shippingStateSelect=new B(t,{placeholder:this.stateLabel,data:null})),i&&(this.shippingCountrySelect=new B(i,{placeholder:!1,clearable:!1,data:null})),s||(s=e.defaultCountry),n||(n=e.defaultState),this.defaultCountry=s,i&&this.shippingCountrySelect.setSelected(s),s&&this.shippingStateSelect.setSelected(n),i&&(this.shippingCountrySelect.setOnChange(async l=>{if(window.fluent_cart_checkout_ui_service.setComponentState("shippingStateSelect","loading"),l){const o=await x.getCountryInfo(l,"shipping");o&&window.fluent_cart_checkout_ui_service.setComponentState("shippingStateSelect","enable"),window.fluent_cart_shipping_service&&(o.views?window.fluent_cart_shipping_service.updateShippingMethodsView({view:o.views.shipping_methods,status:!0}):window.fluent_cart_shipping_service.handleShippingAddressChange(l)),this.updateStateInput(o,"shipping")}else this.formWrapper.querySelector("#shipping_state").value="",this.shippingStateSelect.setOptions([])}),this.onCountryChanged("shipping",e.response,(r=e.response)==null?void 0:r.country_code)),typeof this.onReady=="function"&&this.onReady()}onCountryChanged(e="billing",t,i=""){var o,a;const s=this.formWrapper.querySelector("#"+e+"_state"),r=this.formWrapper.querySelector("#"+e+"_country").value;let l="";if(s&&(l=s.value),t!=null&&t.states){let h=[{text:"Select an option",value:""}];if(t==null||t.states.forEach(w=>{h.push({text:w.name,value:w.value})}),e==="billing"){if(s){this.billingStateSelect&&this.billingStateSelect.setOptions(h),r&&this.billingStateSelect.setSelected(l);const w=this;this.billingStateSelect.setOnChange(async p=>{w.saveCustomerData("billing_state",p)})}}else if(s){this.shippingStateSelect&&this.shippingStateSelect.setOptions(h),r&&this.shippingStateSelect.setSelected(l);const w=this;this.shippingStateSelect.setOnChange(async p=>{w.saveCustomerData("shipping_state",p)})}}this.showHideState((a=(o=t==null?void 0:t.address_locale)==null?void 0:o.state)==null?void 0:a.hidden,e)}updateStateInput(e,t="billing"){var h,w,p,b,D,P,S,Ce,st,nt,rt;if(!e)return;const i=(w=(h=e==null?void 0:e.address_locale)==null?void 0:h.state)==null?void 0:w.hidden;e==null||e.states;const s="#"+t+"_state_wrapper";let n=this.formWrapper.querySelector("#"+t+"_state");const r=((n==null?void 0:n.tagName)||"").toLowerCase(),l=((p=e==null?void 0:e.states)==null?void 0:p.length)||0,o=["select","select-one"].includes(r);if(!n)return;const a=n.value;if(i)this.formWrapper.querySelector(s).style.display="none";else{if(this.formWrapper.querySelector(s).style.display="block",t==="billing"&&this.billingStateSelect!==null&&(this.billingStateSelect.destroy(),this.billingStateSelect=null),t==="shipping"&&this.shippingStateSelect!==null&&(this.shippingStateSelect.destroy(),this.shippingStateSelect=null),l===0){if(o){let V="State";e&&((D=(b=e.address_locale)==null?void 0:b.state)!=null&&D.label)&&(V=(S=(P=e.address_locale)==null?void 0:P.state)==null?void 0:S.label),n=this.convertElementToType(n,"input",V),n.addEventListener("change",()=>{this.saveCustomerData(n.name,n.value)})}}else{o||(n=this.convertElementToType(n,"select"),n.addEventListener("change",()=>{this.saveCustomerData(n.name,n.value)}));let V="State";e&&((st=(Ce=e.address_locale)==null?void 0:Ce.state)!=null&&st.label)&&(V=(rt=(nt=e.address_locale)==null?void 0:nt.state)==null?void 0:rt.label);let Me=[{text:this.translate("Select %s",V),value:""}];if(e==null||e.states.forEach(R=>{Me.push({text:R.name,value:R.value})}),t==="shipping"){this.shippingStateSelect=this.initStateSelect(n,e,V).setOptions(Me),this.shippingStateSelect.setSelected(a);const R=this;this.shippingStateSelect.setOnChange(async Be=>{R.saveCustomerData("shipping_state",Be)})}else{this.billingStateSelect=this.initStateSelect(n,e,V).setOptions(Me),this.billingStateSelect.setSelected(a);const R=this;this.billingStateSelect.setOnChange(async Be=>{R.saveCustomerData("shipping_state",Be)})}}n.closest("[data-fluent-cart-checkout-page-form-input-wrapper]")}}initStateSelect(e,t=null,i=!1){var s,n;return(n=(s=t==null?void 0:t.address_locale)==null?void 0:s.state)!=null&&n.label,new B(e,{placeholder:i,onChange:r=>{}})}convertElementToType(e,t,i=null){if(!e||!t)return;const s=document.createElement(t);s.id=e.id,s.name=e.name,s.className=e.className,s.value=e.value,Array.from(e.attributes).forEach(r=>{r.name.startsWith("data-")&&s.setAttribute(r.name,r.value)}),i&&s.setAttribute("placeholder",i);const n=e.parentNode;return n&&n.replaceChild(s,e),t==="input"&&(s.value=""),s}showHideState(e,t="billing"){let i="#"+t+"_state_wrapper";this.formWrapper.querySelector("#"+t+"_state"),this.formWrapper.querySelector(i)&&(e?this.formWrapper.querySelector(i).style.display="none":this.formWrapper.querySelector(i).style.display="block")}saveCustomerData(e,t){var o;const i=this.checkoutHandler.prepareFormData(),s=((o=window.fluentCartUtmManager)==null?void 0:o.get())||{};Object.keys(s).forEach(a=>{t&&i.append(`utm_data[${a}]`,s[a])});const n=new URLSearchParams;for(const[a,h]of i.entries())n.append(a,h);const r=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes`),l=ee.appendQueryParams(r.toString(),{fc_checkout_action:"save_checkout_data",data_key:e,data_value:t});window.fluent_cart_checkout_ui_service.setLoading("shippingMethodsWrapper"),fetch(l,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-WP-Nonce":d(this,pe)},credentials:"include",body:n}).then(a=>a.json()).then(a=>{a!=null&&a.fragments&&v.handleFragments(a.fragments),(a!=null&&a.shipping_charge_changes||a!=null&&a.tax_total_Changes)&&this.checkoutHandler.handleCheckoutAmountChanges()}).finally(()=>{window.fluent_cart_checkout_ui_service.finishLoading("shippingMethodsWrapper")})}};Y=new WeakMap,pe=new WeakMap,u(W,"instance",null);let Le=W;var fe;const N=class N{constructor(e){u(this,"checkoutHandler",null);u(this,"form",null);g(this,fe,"");this.checkoutHandler=e,this.form=e.form,m(this,fe,window.fluentcart_checkout_info.checkout_nonce),this.bindEvents()}static init(e){return N.instance===null&&(N.instance=new N(e)),window.fluent_cart_checkout_data_watcher=N.instance,N.instance}bindEvents(){const e=["billing_country","shipping_country"];for(const r of e){const l=document.getElementById(r);l&&l.addEventListener("change",this.debounce(o=>{this.saveCustomerData(r,o.target.value)},400))}const t=["billing_state","shipping_state"];for(const r of t){const l=document.getElementById(r);l&&l.addEventListener("change",this.debounce(o=>{o.target.value==="Select State"||o.target.value===""||this.saveCustomerData(r,o.target.value)},400))}const i=["billing_address","billing_full_name","billing_email","billing_address_1","billing_city","billing_postcode","billing_company_name","billing_phone","shipping_address","shipping_full_name","shipping_address_1","shipping_city","shipping_postcode","shipping_company_name","shipping_phone"];for(let r of i){const l=document.getElementById(r);l&&l.addEventListener("change",this.debounce(o=>{r==="shipping_address"&&(r="shipping_address_id"),r==="billing_address"&&(r="billing_address_id"),this.saveCustomerData(r,o.target.value)},400))}document.querySelectorAll('input[name="_fct_pay_method"]').forEach(r=>{r.addEventListener("change",l=>{l.target.checked&&this.saveCustomerData("_fct_pay_method",l.target.value)})}),window.addEventListener("change",r=>{const l=r.target;l&&l.name==="fc_shipping_method"&&l.checked&&this.saveCustomerData("shipping_method_id",l.value)});const n=["ship_to_different"];for(const r of n)document.querySelectorAll(`input[name="${r}"]`).forEach(o=>{o.addEventListener("change",a=>{a.target.checked===!0?this.saveCustomerData(r,"yes"):this.saveCustomerData(r,"no")})})}debounce(e,t){let i;return(...s)=>{clearTimeout(i),i=setTimeout(()=>e.apply(this,s),t)}}saveCustomerData(e,t){var o;const i=this.checkoutHandler.prepareFormData(),s=((o=window.fluentCartUtmManager)==null?void 0:o.get())||{};Object.keys(s).forEach(a=>{t&&i.append(`utm_data[${a}]`,s[a])});const n=new URLSearchParams;for(const[a,h]of i.entries())n.append(a,h);const r=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_checkout_routes`),l=ee.appendQueryParams(r.toString(),{fc_checkout_action:"save_checkout_data",data_key:e,data_value:t});fetch(l,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","X-WP-Nonce":d(this,fe)},credentials:"include",body:n}).then(a=>a.json()).then(a=>{a!=null&&a.fragments&&v.handleFragments(a.fragments),(a!=null&&a.shipping_charge_changes||a!=null&&a.tax_total_Changes)&&this.checkoutHandler.handleCheckoutAmountChanges()})}prepareUtmData(){const e=new FormData(this.form);e.append("_wpnonce",this.nonce);const t=window.fluentCartUtmManager.get();return Object.keys(t).forEach(i=>{const s=t[i];s&&e.append(`utm_data[${i}]`,s)}),e}};fe=new WeakMap,u(N,"instance",null);let Te=N;const M=class M{constructor(e,t){u(this,"countries",[]);u(this,"states",{});u(this,"shippingToDifferent",!1);u(this,"billingCountry",null);u(this,"shippingCountry",null);u(this,"loadingShippingInfo",!1);u(this,"countryCode","");u(this,"state","");u(this,"billingState","");u(this,"shippingState","");u(this,"formWrapper");u(this,"shippingContainer");u(this,"checkoutHandler",null);u(this,"currentShippingMethodId",null);u(this,"translate",window.fluentcart.$t);this.formWrapper=e,this.checkoutHandler=t,this.shippingContainer=this.formWrapper.querySelector("[data-fluent-cart-checkout-page-shipping-method-wrapper]"),this.bindDelegatedListeners(),this.countryCode=window.fluent_cart_address_service.defaultCountry}static init(e,t){return M.instance===null&&(M.instance=new M(e,t)),Le.init(this,()=>{Te.init(this)}),window.fluent_cart_shipping_service=M.instance,M.instance}getShippingContainer(){return this.shippingContainer=this.formWrapper.querySelector("[data-fluent-cart-checkout-page-shipping-method-wrapper]"),this.shippingContainer}bindDelegatedListeners(){const e=document.getElementById("ship_to_different");e&&(this.shippingToDifferent=e.checked);const t=document.getElementById("billing_address");t&&(this.billingCountry=t.dataset.country);const i=document.getElementById("shipping_address");i&&(this.shippingCountry=i.dataset.country),this.formWrapper.addEventListener("change",s=>{if(s.target.id==="ship_to_different"){this.handleShipToDifferentChange(s.target.checked);return}if(s.target.id==="billing_address"){this.countryCode=s.target.dataset.country,this.state=s.target.dataset.state,this.fetchCountryShippingMethods();return}if(s.target.id==="billing_country"){this.billingCountry=s.target.value,this.handleCountryChange(s.target.value);return}if(s.target.id==="shipping_country"){this.shippingCountry=s.target.value,this.handleCountryChange(s.target.value);return}if(s.target.id==="shipping_address"){this.countryCode=s.target.dataset.country,this.state=s.target.dataset.state,this.fetchCountryShippingMethods();return}if(s.target.matches('select[name="shipping_state"]')){this.shippingState=s.target.value,this.handleStateChange();return}if(s.target.matches('select[name="billing_state"]')){this.billingState=s.target.value,this.handleStateChange();return}if(s.target.matches('input[name="fc_shipping_method"]')){this.handleShippingMethodChange(s.target.value);return}})}bindShipToDifferentListener(){const e=document.getElementById("ship_to_different");if(e){this.shippingToDifferent=e.checked;const t=this;e.addEventListener("change",function(){t.handleShipToDifferentChange.bind(t)(this.checked)})}}handleShipToDifferentChange(e){this.shippingToDifferent=e;const t=document.getElementById("shipping_address");if(t&&t.dataset.country&&this.shippingToDifferent)this.countryCode=t.dataset.country,this.state=t.dataset.state,this.fetchCountryShippingMethods();else{let i="",s="";this.shippingToDifferent?(this.formWrapper.querySelector("#shipping_country")&&(i=this.formWrapper.querySelector("#shipping_country").value),this.formWrapper.querySelector("#shipping_state")&&(s=this.formWrapper.querySelector("#shipping_state").value)):(this.formWrapper.querySelector("#billing_country")&&(i=this.formWrapper.querySelector("#billing_country").value),this.formWrapper.querySelector("#billing_state")&&(s=this.formWrapper.querySelector("#billing_state").value)),this.countryCode=i,this.state=s,this.fetchCountryShippingMethods()}}bindBillingCountryListener(){const e=document.getElementById("billing_address");if(e){const i=this;this.billingCountry=e.dataset.country,e.addEventListener("change",function(){const s=this.dataset.country;i.handleBillingAddressChange.bind(i)(s)});return}const t=document.getElementById("billing_country");t&&(this.billingCountry=t.value,t.addEventListener("change",function(){}))}bindShippingCountryListener(){const e=document.getElementById("shipping_address");if(e){const i=this;this.shippingCountry=e.dataset.country,e.addEventListener("change",function(){const s=this.dataset.country;i.handleShippingAddressChange.bind(i)(s)});return}const t=document.getElementById("shipping_country");t&&(this.shippingCountry=t.value,t.addEventListener("change",function(){}))}handleBillingAddressChange(e){this.billingCountry=e,this.shippingToDifferent||(this.shippingCountry=e)}handleCountryChange(){this.shippingToDifferent?this.countryCode=this.shippingCountry:this.countryCode=this.billingCountry}handleShippingAddressChange(e){this.shippingToDifferent?this.shippingCountry=e:this.shippingCountry=this.billingCountry}handleStateChange(){this.shippingToDifferent?this.state=this.shippingState:this.state=this.billingState,this.fetchCountryShippingMethods()}fetchCountryShippingMethods(){}updateShippingMethodsView(e){var i;if(e.status===!1){if(e.fragments){v.handleFragments(e.fragments);return}this.shippingContainer.innerHTML=e.view||`<div class="fct-empty-text">${e.message}</div>`;return}this.getShippingContainer()&&(this.getShippingContainer().innerHTML=e.view),(i=this.checkoutHandler)==null||i.buttons.removeAttribute("disabled");let t="";this.getShippingContainer()&&(t=this.getShippingContainer().querySelectorAll('input[name="fc_shipping_method"]')),t.length>0&&this.selectDefaultShippingMethod(t)}bindShippingMethodChangeListener(){this.currentShippingMethodId=null,this.setShippingMethodIdToForm();const e=this.shippingContainer.querySelectorAll('input[name="fc_shipping_method"]');e.length>0&&this.selectDefaultShippingMethod(e)}selectDefaultShippingMethod(e){e[0].checked=!0,setTimeout(()=>{this.handleShippingMethodChange(e[0].value)},0)}setShippingMethodIdToForm(){const e=this.getShippingContainer().querySelector('input[name="fc_selected_shipping_method"]');e&&(e.value=this.currentShippingMethodId)}handleShippingMethodChange(e){}};u(M,"instance",null);let ze=M;const q=class q{constructor(e){u(this,"formWrapper",null);u(this,"states",{loading:"loading",enable:"enable",disable:"disable",loadingAndDisabled:"loadingAndDisabled"});u(this,"viewsStates",{});u(this,"views",{billingCountry:null,billingState:null,billingStateSelect:null,shippingCountry:null,shippingState:null,shippingStateSelect:null,checkoutButton:null,shippingMethodsWrapper:null});this.formWrapper=e.form,this.initViews()}static init(e){return q.instance===null&&(q.instance=new q(e),window.dispatchEvent(new CustomEvent("checkout_ui_service_initialized",{detail:{service:q.instance}}))),window.fluent_cart_checkout_ui_service=q.instance,q.instance}initViews(){this.views.billingCountry=this.formWrapper.querySelector("#billing_country"),this.views.billingState=this.formWrapper.querySelector("#billing_state"),this.views.billingState&&(this.views.billingStateSelect=this.views.billingState.closest("#billing_state_wrapper")),this.views.shippingCountry=this.formWrapper.querySelector("#shipping_country"),this.views.shippingState=this.formWrapper.querySelector("#shipping_state"),this.views.shippingState&&(this.views.shippingStateSelect=this.views.shippingState.closest("#shipping_state_wrapper")),this.views.shippingMethodsWrapper=this.formWrapper.querySelector("[data-fluent-cart-checkout-page-shipping-methods-wrapper]"),this.views.checkoutButton=this.formWrapper.querySelector("#fluent_cart_order_btn")}setCheckoutButtonText(e){this.views.checkoutButton&&(this.views.checkoutButton.innerHTML=e)}enableCheckoutButton(){this.initViews(),this.setComponentState("checkoutButton",this.states.enable)}disableCheckoutButton(){this.initViews(),this.setComponentState("checkoutButton",this.states.disable)}hideCheckoutButton(){this.initViews(),this.hideComponent("checkoutButton")}showCheckoutButton(){this.initViews(),this.showComponent("checkoutButton")}isCheckoutButtonDisabled(){return this.viewsStates.hasOwnProperty("checkoutButton")?this.viewsStates.checkoutButton!==this.states.enable:!1}setComponentState(e,t){this.views[e]&&(t===this.states.enable&&(this.views[e].removeAttribute("disabled"),this.views[e].dataset.loading=""),t===this.states.disable&&this.views[e].setAttribute("disabled","disabled"),t===this.states.loading&&(this.views[e].dataset.loading="loading"),t===this.states.loadingAndDisabled&&(this.views[e].setAttribute("disabled","disabled"),this.views[e].dataset.loading="loading"),this.viewsStates[e]=t)}hideComponent(e){this.views[e]&&(this.views[e].style.display="none")}showComponent(e,t="block"){this.views[e]&&(this.views[e].style.display=t)}setLoading(e){this.views[e]&&(this.views[e].classList.add("fct-loading"),this.views[e].setAttribute("fct-loading","1"))}finishLoading(e){this.views[e]&&(this.views[e].classList.remove("fct-loading"),this.views[e].removeAttribute("fct-loading"))}};u(q,"instance",null);let Qe=q;const j=class j{constructor(e){u(this,"checkoutHandler",null);u(this,"form",null);u(this,"taxWrapper",null);u(this,"applyBtn",null);u(this,"loader",null);u(this,"taxIdInput",null);u(this,"errorWrapper",null);u(this,"taxRemoveBtn",null);u(this,"validNoteWrapper",null);u(this,"validNote",null);u(this,"translate",window.fluentcart.$t);var t,i,s,n,r,l,o;this.checkoutHandler=e,this.form=e==null?void 0:e.form,this.taxWrapper=this.form.querySelector("[data-fluent-cart-checkout-page-tax-wrapper]"),this.applyBtn=(t=this.taxWrapper)==null?void 0:t.querySelector("[data-fluent-cart-checkout-page-tax-apply-btn]"),this.loader=(i=this.taxWrapper)==null?void 0:i.querySelector("[data-fluent-cart-checkout-page-tax-loading]"),this.taxIdInput=(s=this.taxWrapper)==null?void 0:s.querySelector("[data-fluent-cart-checkout-page-tax-id]"),this.errorWrapper=(n=this.taxWrapper)==null?void 0:n.querySelector("[data-fluent-cart-checkout-page-form-error]"),this.taxRemoveBtn=(r=this.taxWrapper)==null?void 0:r.querySelector("[data-fluent-cart-tax-remove-btn]"),this.validNoteWrapper=(l=this.taxWrapper)==null?void 0:l.querySelector("[data-fluent-cart-tax-valid-note-wrapper]"),this.validNote=(o=this.taxWrapper)==null?void 0:o.querySelector("[data-fluent-cart-tax-valid-note]"),this.bindDelegatedEvents()}static init(e){return j.instance===null&&(j.instance=new j(e)),j.instance}getTaxWrapper(){return this.taxWrapper=this.form.querySelector("[data-fluent-cart-checkout-page-tax-wrapper]"),this.taxWrapper}getTaxElements(){const e=this.getTaxWrapper();return e?{applyBtn:e.querySelector("[data-fluent-cart-checkout-page-tax-apply-btn]"),loader:e.querySelector("[data-fluent-cart-checkout-page-tax-loading]"),taxIdInput:e.querySelector("[data-fluent-cart-checkout-page-tax-id]"),errorWrapper:e.querySelector("[data-fluent-cart-checkout-page-form-error]"),taxRemoveBtn:e.querySelector("[data-fluent-cart-tax-remove-btn]"),validNoteWrapper:e.querySelector("[data-fluent-cart-tax-valid-note-wrapper]"),validNote:e.querySelector("[data-fluent-cart-tax-valid-note]")}:{}}bindDelegatedEvents(){this.form.addEventListener("click",e=>{if(e.target.matches("[data-fluent-cart-checkout-page-tax-apply-btn]")){e.preventDefault(),this.validateVatHandler();return}if(e.target.matches("[data-fluent-cart-tax-remove-btn]")){e.preventDefault(),this.removeVat();return}}),this.form.addEventListener("keydown",e=>{e.target.matches("[data-fluent-cart-checkout-page-tax-id]")&&e.key==="Enter"&&(e.preventDefault(),this.validateVatHandler())})}validateVatHandler(){var i,s;const t=(s=(i=this.getTaxElements().taxIdInput)==null?void 0:i.value)==null?void 0:s.trim();if(!t){this.clearError();return}this.validateVat(t)}async validateVat(e){var s;const t=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_validate_vat`).toString(),i=new URLSearchParams({vat_number:e,_wpnonce:((s=window.fluentcart_checkout_info)==null?void 0:s.checkout_nonce)||""}).toString();try{this.startLoading();const n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"include",body:i}),r=await n.json();if(!n.ok||(r==null?void 0:r.success)===!1){const o=(r==null?void 0:r.message)||(r==null?void 0:r.message)||this.translate("Invalid VAT number");return this.showError(o),!1}const l=r==null?void 0:r.tax_data;return r!=null&&r.fragments&&v.handleFragments(r.fragments),this.clearError(),this.showSuccess(`${l!=null&&l.name?l.name+" • ":""}${(l==null?void 0:l.country)||""}`),!0}catch(n){return console.log(n,"error"),this.showError(this.translate("Validation service unavailable. Please try again.")),!1}finally{this.endLoading()}}async removeVat(){var i;if(!confirm(this.translate("Are you sure you want to remove VAT?")))return;const e=v.buildUrl(`${window.fluentcart_checkout_vars.ajaxurl}?action=fluent_cart_remove_vat`).toString(),t=new URLSearchParams({_wpnonce:((i=window.fluentcart_checkout_info)==null?void 0:i.checkout_nonce)||""}).toString();try{this.startLoading();const s=await fetch(e,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},credentials:"include",body:t}),n=await s.json();if(!s.ok||(n==null?void 0:n.success)===!1){this.showError((n==null?void 0:n.message)||this.translate("Failed to remove VAT"));return}this.clearError(),this.clearSuccess(),n!=null&&n.fragments&&v.handleFragments(n.fragments);const r=this.getTaxElements();r.taxIdInput&&(r.taxIdInput.value=""),window.location.reload()}catch(s){console.error(s),this.showError(this.translate("Could not remove VAT, please try again."))}finally{this.endLoading()}}showError(e){var s;const t=this.getTaxElements(),i=this.getTaxWrapper();i==null||i.classList.add("has-error"),(s=t.taxIdInput)==null||s.setAttribute("aria-invalid","true"),t.errorWrapper&&(t.errorWrapper.textContent=e||this.translate("Invalid VAT number"),t.errorWrapper.style.display="block")}clearError(){var i;const e=this.getTaxElements(),t=this.getTaxWrapper();t==null||t.classList.remove("has-error"),(i=e.taxIdInput)==null||i.removeAttribute("aria-invalid"),e.errorWrapper&&(e.errorWrapper.textContent="",e.errorWrapper.style.display=""),this.clearSuccess()}showSuccess(e){const t=this.getTaxElements();this.getTaxWrapper()&&t.validNote&&(t.validNoteWrapper.classList.remove("is-hidden"),t.validNote.textContent=e||this.translate("Valid VAT number"))}clearSuccess(){const e=this.getTaxElements();this.getTaxWrapper()&&e.validNote&&(e.validNoteWrapper.classList.add("is-hidden"),e.validNote.textContent="")}startLoading(){var t,i;const e=this.getTaxElements();e.loader&&(e.loader.style.display="block",e.loader.textContent=this.translate("Validating...")),(e.applyBtn||e.taxIdInput)&&((t=e.taxIdInput)==null||t.setAttribute("disabled","disabled"),(i=e.applyBtn)==null||i.setAttribute("disabled","disabled")),this.clearError()}endLoading(){var t,i;const e=this.getTaxElements();e.loader&&(e.loader.style.display="none"),(e.applyBtn||e.taxIdInput)&&((t=e.taxIdInput)==null||t.removeAttribute("disabled"),(i=e.applyBtn)==null||i.removeAttribute("disabled")),e.errorWrapper&&(e.errorWrapper.style.display="block")}};u(j,"instance",null);let Ge=j;class jt{constructor(e=null){this.checkoutHandler=e,this.pendingTokenPromise=null,this.pendingResolve=null,this.isExecuting=!1,this.setupGlobalCallback(),this.autoRenderWidget()}setupGlobalCallback(){window.fluentCartTurnstileHandlerInstance=this,window.fluentCartTurnstileCallback=function(e){var t;(t=window.fluentCartTurnstileHandlerInstance)==null||t.handleToken(e)}}isEnabled(){var e,t;return(t=(e=window.fluentcart_checkout_vars)==null?void 0:e.turnstile)==null?void 0:t.enabled}autoRenderWidget(){var n,r;if(!this.isEnabled())return;const e=document.querySelector("[data-fluent-cart-turnstile-widget] .cf-turnstile"),t=document.querySelector("[data-fluent-cart-turnstile-widget]");if(!e)return;const i=t==null?void 0:t.getAttribute("data-turnstile-active");if(!this.isEnabled()&&i!=="yes"||typeof turnstile>"u")return;if(!e.getAttribute("data-widget-id")){const l=e.getAttribute("data-sitekey")||((r=(n=window.fluentcart_checkout_vars)==null?void 0:n.turnstile)==null?void 0:r.site_key);if(l)try{const o=turnstile.render(e,{sitekey:l,callback:this.handleToken.bind(this),size:"invisible",theme:"auto"});o&&e.setAttribute("data-widget-id",o)}catch{}}}reset(){if(!this.isEnabled()||typeof turnstile>"u")return;window.fluentCartTurnstileToken=null,this.pendingTokenPromise=null,this.pendingResolve=null,this.isExecuting=!1;const e=document.querySelector("[data-fluent-cart-turnstile-widget] .cf-turnstile");if(!e)return;const t=e.getAttribute("data-widget-id");if(t)try{turnstile.reset(t)}catch(i){console.error("Turnstile reset failed",i)}}async handleCheckoutSecurityVerification(e){var i,s,n;if(!this.isEnabled())return!0;const t=await this.getToken();return t?(e.append("cf_turnstile_token",t),!0):((i=this.checkoutHandler)!=null&&i.cleanupAfterProcessing&&this.checkoutHandler.cleanupAfterProcessing(),new Toastify({text:((n=(s=this.checkoutHandler)==null?void 0:s.translate)==null?void 0:n.call(s,"Please complete the security verification."))||"Please complete the security verification.",className:"warning",duration:3e3}).showToast(),this.reset(),!1)}async verifyAndAppendToken(e,t,i){if(!this.isEnabled())return!0;const s=await this.getToken();return s?(e.append("cf_turnstile_token",s),!0):(i&&i(),new Toastify({text:t("Too many requests. Please try again after some time."),className:"warning",duration:3e3}).showToast(),this.reset(),!1)}async getToken(){var i,s;if(!this.isEnabled()||typeof turnstile>"u")return null;const e=document.querySelector("[data-fluent-cart-turnstile-widget] .cf-turnstile");if(!e)return null;if(window.fluentCartTurnstileToken)return window.fluentCartTurnstileToken;let t=e.getAttribute("data-widget-id");if(!t){const n=e.getAttribute("data-sitekey")||((s=(i=window.fluentcart_checkout_vars)==null?void 0:i.turnstile)==null?void 0:s.site_key);if(!n)return null;try{t=turnstile.render(e,{sitekey:n,callback:this.handleToken.bind(this),size:"invisible",theme:"auto"}),t&&e.setAttribute("data-widget-id",t)}catch{return null}}return this.pendingTokenPromise?this.pendingTokenPromise:(this.pendingTokenPromise=new Promise(n=>{let r=0;const l=30;this.pendingResolve=n;const o=()=>{if(window.fluentCartTurnstileToken){const a=window.fluentCartTurnstileToken;this.pendingTokenPromise=null,this.pendingResolve=null,this.isExecuting=!1,n(a);return}if(r>=l){this.pendingTokenPromise=null,this.pendingResolve=null,this.isExecuting=!1,n(null);return}r++,setTimeout(o,100)};try{if(!this.isExecuting){this.isExecuting=!0;let a=null;try{a=turnstile.getResponse(t)}catch{a=null}if(a){this.handleToken(a);return}try{turnstile.reset(t)}catch{}turnstile.execute(t)}}catch{this.isExecuting=!1}o()}),this.pendingTokenPromise)}resolvePendingToken(e){if(!this.pendingResolve)return;const t=this.pendingResolve;this.pendingResolve=null,this.pendingTokenPromise=null,this.isExecuting=!1,t(e)}handleToken(e){e&&(window.fluentCartTurnstileToken=e,this.resolvePendingToken(e))}}var ge,E,me,et,F,ye,De,Pe,we,_e,$,ve,We,Ne,be,Se,Ye;const ie=class ie{constructor(e,t,i){g(this,Se);g(this,E,null);g(this,me);g(this,et,[]);g(this,F,null);g(this,ye,null);g(this,De);g(this,Pe);g(this,we,null);g(this,_e,!1);g(this,$);g(this,ve);g(this,We,!1);g(this,Ne,!1);u(this,"checkoutUiService");u(this,"translate",window.fluentcart.$t);g(this,be,{".fct_error_billing_personal_information_section":["billing_full_name","billing_email","billing_company_name"],".fct_error_billing_address_section_section":["billing_address_1","billing_address_2","billing_city","billing_postcode","billing_country","billing_state","billing_phone"],".fct_error_shipping_address_section_section":["shipping_full_name","shipping_address_1","shipping_address_2","shipping_city","shipping_postcode","shipping_country","shipping_state","shipping_phone"],".fct_error_agree_terms_section":["agree_terms"]});var s,n,r,l,o,a,h,w,p;if(A.extend(tt),A.extend(it),m(this,ye,A.tz.guess()),d(ie,ge)!==null)return d(ie,ge);this.form=t,this.settings=i,m(this,De,window.fluentCartRestVars.rest.url),this.checkoutInfo=window.fluentcart_checkout_info,m(this,We,((s=window.fluentcart_checkout_info)==null?void 0:s.is_zero_payment)==="yes"),m(this,Ne,((n=window.fluentcart_checkout_info)==null?void 0:n.has_subscription)=="yes"),this.nonce=(r=this.checkoutInfo)==null?void 0:r.rest.nonce,this.checkoutUrl=(l=this.checkoutInfo)==null?void 0:l.order_confirmation_url,this.checkoutUrl=v.buildUrl(this.checkoutUrl),m(this,Pe,(o=window.fluentcart_checkout_vars)==null?void 0:o.submit_button),m(this,we,this.form.querySelector("[data-fluent-cart-ship-to-different-address]")),m(this,$,this.form.querySelector("[data-fluent-cart-checkout-order-notes-toggle]")),m(this,ve,this.form.querySelector("[data-fluent-cart-checkout-order-notes-wrapper]")),this.isAllDigital=((a=window.fluentcart_checkout_vars)==null?void 0:a.is_all_digital.toString())==="1",this.buttons=this.form.querySelector("[data-fluent-cart-checkout-page-checkout-button]"),this.checkoutUiService=Qe.init(this),m(this,E,new Pt({form:this.form,orderHandler:this.handleOrder.bind(this),checkoutHandler:this})),m(this,F,new jt(this)),new Ke(this).init(),new Ht(this.form).init(),Le.init(this,()=>{setTimeout(()=>{Te.init(this),this.isAllDigital||ze.init(this.form,this)},1e3)}),((w=(h=window.fluentcart_checkout_vars)==null?void 0:h.tax_settings)==null?void 0:w.enable_tax)==="yes"&&Ge.init(this),this.init(),this.handleShippingForm(t),this.loadPaymentEmbedModules(),this.formatErrorFields(),this.handleCartItemsCollapse(),this.handleCouponItemsCollapse(),this.isCartLocked=((p=window.fluentcart_checkout_vars)==null?void 0:p.is_cart_locked.toString())==="yes",this.setDefaultCountry(),this.setupDeleteCartItemHandler(),this.handleCountryChange(),this.handlePhoneInput(),this.handleOrderNotesToggle()}handleCountryChange(){var e;(e=d(this,we))==null||e.addEventListener("change",t=>{m(this,_e,t.target.checked)})}async setDefaultCountry(){}handleCheckoutAmountChanges(){}async load(){try{const e=await this.loadCartItems();return e&&m(this,me,e),d(this,me)}catch(e){console.error("Error loading cart data:",e)}}async loadCartItems(){try{return await d(this,Se,Ye).getCart()}catch(e){throw console.error("Error fetching cart items:",e),e}}setupDeleteCartItemHandler(){const e=this;document.addEventListener("click",async t=>{if(t.target.matches("[data-fluent-cart-checkout-item-remove-button]")){const s=t.target.dataset.fluentCartCheckoutItemId;try{await d(e,Se,Ye).removeProduct(s);const n=await e.load();(!n||Object.keys(n).length===0)&&location.reload()}catch(n){console.error("Failed to remove product:",n)}}})}formatErrorFields(){document.querySelectorAll("[data-fluent-cart-checkout-page-form-section]").forEach(t=>{t.querySelectorAll("[data-fluent-cart-checkout-page-form-error]").forEach(s=>{const n=s.cloneNode(!0);s.remove(),t.appendChild(n)})})}init(){this.bindErrorCleanupListeners(),this.form.addEventListener("submit",e=>{e.preventDefault(),e.detail===void 0&&this.handleOrder(e)}),this.buttons&&this.buttons.addEventListener("click",e=>{e.preventDefault(),this.form.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}))})}loadPaymentEmbedModules(){d(this,E).load()}handleShippingForm(e){this.disableRequiredShipping();const t=this,i=e.querySelector("[data-fluent-cart-ship-to-different-address]"),s=e.querySelector("[data-fluent-cart-checkout-page-shipping-fields]");i!=null&&i.checked&&(m(this,_e,!0),s.style.display="block",s.querySelectorAll('input[data-required="disabled"]').forEach(r=>{r.dataset.required="yes",r.required=!0})),i&&i.addEventListener("change",function(n){const r=e.querySelector("[data-fluent-cart-checkout-page-shipping-fields]");this.checked?(r.style.display="block",r.querySelectorAll('input[data-required="disabled"]').forEach(o=>{o.dataset.required="yes",o.required=!0})):t.disableRequiredShipping()})}disableRequiredShipping(){const e=this.form.querySelector("[data-fluent-cart-checkout-page-shipping-fields]");e&&(e.style.display="none",e.querySelectorAll('input[data-required="yes"]').forEach(i=>{i.dataset.required="disabled",i.required=!1}))}buttonState(e,t,i="disabled"){i==="disabled"?d(this,E).disableCheckoutButton(t):i==="hide"?d(this,E).hideCheckoutButton():d(this,E).enableCheckoutButton(t),this.form.classList.add("fluent_cart_"+e)}async handleOrder(e){var o,a;if(this.checkoutUiService.isCheckoutButtonDisabled())return;document.querySelectorAll(".fct-error-message").forEach(h=>h.remove()),this.payMethod=d(this,E).payMethod;const i=window["is_"+this.payMethod+"_ready"];if(this.payMethod!=="offline_payment"&&!i)return console.warn("Dev Warn FCT: Payment method is not ready yet!"),window.dispatchEvent(new CustomEvent("fluent_cart_validate_checkout_"+this.payMethod)),!1;d(this,E).disableCheckoutButton(this.translate("Processing Order..."));const s='<div class="fct-loader-spinner"></div>';let n=document.querySelector(".fct-order-processing");n?n.classList.remove("fct-loader-hidden"):(n=this.createProcessingDiv(s),document.body.appendChild(n)),this.removeValidationErrors();const r=(o=window.fluentCartCheckout)==null?void 0:o.beforeCheckoutCallbacks;let l=!0;if(Array.isArray(r)){for(let h of r)if(typeof h=="function"){let w=await h({paymentLoader:d(this,E)});l=l&&w}}if(l!==!1)try{const h=this.prepareFormData();if(!await d(this,F).handleCheckoutSecurityVerification(h))return!1;this.removeValidationErrors();const p=await(await this.submitCheckoutForm(h)).json();if(d(this,F)&&d(this,F).reset(),p.status==="success")return(a=window.fluentCartUtmManager)==null||a.clear(),this.handleSuccessfulResponse(p),p;{if(p!=null&&p.errors&&typeof(p==null?void 0:p.errors)=="object"){let D="";for(const P in p.errors){this.handleErrorMessage(p.errors,P);const S=p.errors[P],Ce=Object.values(S)[0];D+=Ce+` 
`}return new Toastify({text:D,className:"warning",duration:1500}).showToast(),this.cleanupAfterProcessing(),!1}this.showValidationErrors(p==null?void 0:p.errors);let b=(p==null?void 0:p.message)||(p==null?void 0:p.message);return b&&this.showProductValidationError(b),this.cleanupAfterProcessing(),!1}}catch{return this.cleanupAfterProcessing(),!1}}handleErrorMessage(e,t){document.querySelectorAll("[data-fct-checkout-form-section]").forEach(s=>{Object.entries(d(this,be)).forEach(([n,r])=>{const l=s.querySelector(n);if(!l)return;const o=this.getFieldsPriorityBaseErrors(e,r);Array.isArray(o)&&o.length?(l.classList.add("show_error"),l.innerHTML=o.map(a=>`<span data-fct-error-field="${a.field}">${a.message}</span>`).join("")):(l.classList.remove("show_error"),l.innerHTML="")})})}getFieldsPriorityBaseErrors(e,t){const i=[];return t.forEach(s=>{const n=e[s];if(n){if(n.required){i.push({field:s,message:n.required});return}Object.entries(n).forEach(([r,l])=>{r!=="required"&&i.push({field:s,message:l})})}}),i}clearFieldError(e){Object.entries(d(this,be)).forEach(([t,i])=>{if(!i.includes(e))return;const s=document.querySelector(t);if(!s)return;const n=s.querySelector(`[data-fct-error-field="${e}"]`);n&&(n.classList.add("fct-error-leave"),n.addEventListener("transitionend",()=>{n.remove(),s.querySelector("span")||s.classList.remove("show_error")},{once:!0}))})}bindErrorCleanupListeners(){const e=t=>{var s;const i=t.target;i.name&&(s=i.value)!=null&&s.trim()&&this.clearFieldError(i.name)};document.addEventListener("input",e),document.addEventListener("change",e)}createProcessingDiv(e){const t=document.createElement("div");return t.className="fct-order-processing",t.innerHTML=e+"<br/><div class='loading-status'>"+this.translate("Order Processing...")+"</div><div class='fct-browser-notify'>"+this.translate("Please Don't close the browser")+"</div>",t}prepareFormData(){const e=new FormData(this.form);e.append("_wpnonce",this.nonce);const t=window.fluentCartUtmManager.get();return Object.keys(t).forEach(i=>{const s=t[i];s&&e.append(`utm_data[${i}]`,s)}),e}async submitCheckoutForm(e){e.append("user_tz",d(this,ye));const t=new URLSearchParams,i=new Set;for(const[n,r]of e.entries())i.has(n)||(t.append(n,r),i.add(n));let s=this.checkoutUrl.toString();return await fetch(s,{method:"POST",headers:{"X-WP-Nonce":window.fluentCartCheckout.nonce,"Content-Type":"application/x-www-form-urlencoded"},body:t})}async handleSuccessfulResponse(e){var i,s,n;const t=(i=window.fluentCartCheckout)==null?void 0:i.afterCheckoutCallbacks;if(Array.isArray(t))for(let r of t)typeof r=="function"&&await r(e);e!=null&&e.redirect_to&&(this.buttonState("order_processing",this.translate("Please wait..."),e==null?void 0:e.buttonState),window.self!==window.top?window.top.location.href=e.redirect_to:window.location.href=e.redirect_to),(e==null?void 0:e.actionName)==="custom"?window.dispatchEvent(new CustomEvent("fluent_cart_payment_next_action_"+(e==null?void 0:e.nextAction),{detail:{response:e}})):(e==null?void 0:e.actionName)==="redirect"&&(window.self!==window.top?window.top.location.href=(s=e==null?void 0:e.payment_args)==null?void 0:s.checkout_url:window.location.href=(n=e==null?void 0:e.payment_args)==null?void 0:n.checkout_url)}cleanupAfterProcessing(){const e=document.querySelector(".fct-order-processing");e&&e.classList.add("fct-loader-hidden"),d(this,E).enableCheckoutButton(this.translate("Place Order"))}removeValidationErrors(){document.querySelectorAll("[data-fluent-cart-checkout-page-form-input-wrapper]").forEach(e=>{e.classList.remove("has-error")}),document.querySelectorAll("[data-fluent-cart-checkout-page-form-error]").forEach(e=>{e.innerHTML=""}),document.querySelectorAll("[data-fluent-cart-checkout-page-form-section]").forEach(e=>{e.classList.remove("has-error")})}showProductValidationError(e=this.translate("Error! Please update cart items!")){new Toastify({text:'<span class="warn warning"></span>'+e,className:"warning",escapeMarkup:!1,duration:3e3,close:!0,style:{color:"#000",background:"#ffffff"}}).showToast()}showValidationErrors(e){if(!(!e||Object.keys(e).length<1))for(const t in e){const i=document.querySelectorAll("[data-fluent-cart-checkout-page-form-section]"),s=this.form.querySelector("#"+t);if(s){s.closest("[data-fluent-cart-checkout-page-form-input-wrapper]")&&s.closest("[data-fluent-cart-checkout-page-form-input-wrapper]").classList.add("has-error"),i.forEach(r=>r.classList.add("has-error"));const n=e[t];if(typeof n=="object"){let r="",l=0;const o=Object.entries(n).length;for(const h in n){r+=n[h],l!==o&&(r+="<br>"),l++;break}new Toastify({text:r,className:"warning",escapeMarkup:!1,duration:1500,style:{color:"#000",background:"#ffffff"}}).showToast(),t==="order_notes"&&new Toastify({text:'<span class="warn error"></span>'+r,className:"error",escapeMarkup:!1,duration:1500,style:{color:"#000",background:"#ffffff"}}).showToast();const a=`[data-fluent-cart-checkout-page-form-error][for="${s.name}"]`;document.querySelector(a).innerHTML=r,document.querySelector(a).classList.add("show_error")}}else if(t==="shipping_method"){const n=document.querySelector("[data-fluent-cart-checkout-page-shipping-methods-wrapper]");n&&(n.classList.add("has-error"),n.querySelector("[data-fluent-cart-checkout-page-form-error]").innerHTML=e[t])}else new Toastify({text:'<span class="warn warning"></span>'+this.translate("Validation Error! Please fill required fields!"),className:"warning",escapeMarkup:!1,duration:1300,style:{color:"#000",background:"#ffffff"}}).showToast()}}handleCartItemsCollapse(){this.form.addEventListener("click",e=>{e.target.closest("[data-fluent-cart-checkout-cart-items-toggle]")&&this.form.querySelector("[data-fluent-cart-checkout-page-cart-items-wrapper]").classList.toggle("box_closed")})}handleCouponItemsCollapse(){const e=document.querySelector("[data-fluent-cart-checkout-coupon-items-toggle]"),t=document.querySelector("[data-fluent-cart-checkout-coupon-items-wrapper]");e&&t&&e.addEventListener("click",()=>{e.classList.toggle("active"),t.style.display=t.style.display==="none"?"block":"none"})}handlePhoneInput(){const e=document.querySelector("[data-fluent-cart-checkout-page-form-input-wrapper][id='billing_phone_wrapper'] input"),t=document.querySelector("[data-fluent-cart-checkout-page-form-input-wrapper][id='shipping_phone_wrapper'] input"),i=s=>{s&&s.value.length>15&&(s.value=s.value.substring(0,15))};e&&(e.addEventListener("input",()=>i(e)),e.addEventListener("paste",()=>{setTimeout(()=>i(e),0)})),t&&(t.addEventListener("input",()=>i(t)),t.addEventListener("paste",()=>{setTimeout(()=>i(t),0)}))}handleOrderNotesToggle(){this.form.querySelectorAll("[data-fct-item-toggle-control]").forEach(t=>{t.addEventListener("click",()=>{const i=t.closest("[data-fct-item-toggle]");i&&i.classList.toggle("active")})}),d(this,$)&&d(this,$).addEventListener("click",()=>{d(this,$).classList.toggle("active"),d(this,ve).classList.toggle("active")})}};ge=new WeakMap,E=new WeakMap,me=new WeakMap,et=new WeakMap,F=new WeakMap,ye=new WeakMap,De=new WeakMap,Pe=new WeakMap,we=new WeakMap,_e=new WeakMap,$=new WeakMap,ve=new WeakMap,We=new WeakMap,Ne=new WeakMap,be=new WeakMap,Se=new WeakSet,Ye=function(){return window.fluentCartCart},g(ie,ge,null);let Je=ie;window.CheckoutHelper=v;let Ut={checkoutPageContainer:null,init(){if(this.checkoutPageContainer=document.querySelector("[data-fluent-cart-checkout-page]"),!this.checkoutPageContainer)return;let c=this.checkoutPageContainer.querySelector("form[data-fluent-cart-checkout-page-checkout-form]");return new Je(this,c,{})}};window.addEventListener("load",function(){const c=document.querySelector("[data-fluent-cart-checkout-item-wrapper]");document.querySelector("[data-fluent-cart-checkout-subtotal]"),document.querySelectorAll("[data-fluent-cart-checkout-estimated-total]");let e=window.fluentcart_checkout_vars.ajaxurl+"?action=fluent_cart_checkout_routes&fc_checkout_action=get_checkout_summary_view";c&&window.addEventListener("fluentCartNotifyCartDrawerItemChanged",function(){fetch(v.buildUrl(e).toString(),{headers:{"X-WP-Nonce":window.fluentCartRestVars.rest.nonce},credentials:"include"}).then(t=>t.json()).then(t=>{t.fragments&&v.handleFragments(t.fragments),window.dispatchEvent(new CustomEvent("fluentCartCheckoutDataChanged",{detail:{response:t}}))}).catch(t=>{console.error("An error occurred:",t)})},!1),window.fluentCartCheckout=Ut.init(),window.fluentCartCheckout&&(window.fluentCartCheckout.beforeCheckoutCallbacks=[],window.fluentCartCheckout.afterCheckoutCallbacks=[]),setTimeout(()=>{window.dispatchEvent(new CustomEvent("fluent_cart_after_checkout_js_loaded",{}))},500)})});export default Ft();
