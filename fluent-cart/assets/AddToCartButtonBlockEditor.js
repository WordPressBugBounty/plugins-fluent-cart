import{b as i,j as t}from"./chunks/BlockEditorTranslator.js";import{a as v}from"./chunks/index4.js";import"./chunks/SingleProductContext.js";import{m as j,n as S}from"./chunks/Icons.js";import{S as w}from"./chunks/SelectVariationModal.js";import{a as k}from"./chunks/add-query-args.js";import"./chunks/ProductListItem.js";import"./chunks/index5.js";const{InspectorControls:C}=wp.blockEditor,{PanelBody:P,CheckboxControl:J,Button:E,Card:B,CardBody:D,Flex:A,FlexItem:I,FlexBlock:F}=wp.components,{useBlockProps:V,RichText:z}=wp.blockEditor,{registerBlockType:M}=wp.blocks,{useEffect:T,useState:f}=wp.element,{useSelect:K}=wp.data,{store:Y}=wp.blockEditor,l=window.fluent_cart_add_to_cart_button_data,m=window.fluentCartRestVars.rest,W=m.url+"/products/variants/";M(l.slug+"/"+l.name,{apiVersion:3,title:l.title,description:l.description,icon:{src:j},category:"fluent-cart",attributes:{variant_ids:[],variationsData:{type:[Array,Object],default:[]},query_type:{type:"string",default:"default"},text:{type:"string",default:i("Add to Cart","fluent-cart")},placeholder:{type:"string"}},supports:{html:!1,align:["left","center","right"],alignWide:!1,typography:{fontSize:!0,lineHeight:!0},spacing:{margin:!0,padding:!0},color:{text:!0},__experimentalBorder:{color:!0,radius:!0,style:!0,width:!0},reusable:!1,shadow:!0},edit:c=>{const{attributes:r,setAttributes:a}=c,{text:h,placeholder:x}=r,g=V(),[N,d]=f({}),e=(Array.isArray(r.variationsData)?r.variationsData:[])[0]||null,[u,p]=f(!1);let b={variant_ids:r.variant_ids,with_product:!0,per_page:10,page:1,order_by:"ID",order_type:"DESC"};const y=()=>{var o;if(!((o=r.variant_ids)!=null&&o.length)){d([]),a({variationsData:[]});return}v({path:k(W,{params:b}),headers:{"X-WP-Nonce":m.nonce}}).then(s=>{const n=s.variants||[];d(n),a({variationsData:n})}).finally(()=>{})};T(()=>{y()},[r.variant_ids]);const _=()=>e?t.jsx(B,{size:"small",style:{marginTop:"12px"},children:t.jsx(D,{children:t.jsxs(A,{align:"flex-start",gap:3,children:[t.jsxs(F,{children:[t.jsx("div",{style:{marginBottom:"4px",fontWeight:"600",fontSize:"13px"},children:e==null?void 0:e.variation_title}),t.jsxs("div",{style:{fontSize:"13px",color:"#757575",marginBottom:"2px"},children:[i("Price"),":",t.jsx("span",{style:{fontWeight:"600",color:"#000",marginLeft:"4px"},dangerouslySetInnerHTML:{__html:e==null?void 0:e.formatted_total}})]})]}),t.jsx(I,{children:t.jsx(E,{icon:S,label:i("Edit product selection"),isSmall:!0,onClick:()=>p(!0)})})]})})}):null;return t.jsxs("div",{children:[t.jsx(C,{children:t.jsxs(P,{title:i("Product Settings"),initialOpen:!0,children:[t.jsx("p",{children:i("Select a specific product variation for this button.","fluent-cart")}),(!e||u)&&t.jsx(w,{not_subscribable:!0,button:!0,isMultiple:!1,setAttributes:a,onModalClosed:o=>{let s={...o},n=Object.keys(s);a({variationsData:{...s}}),a({variant_ids:n}),p(!1)}}),e&&!u&&_()]})}),t.jsx(z,{...c,...g,tagName:"div",className:"wp-block-button__link wp-element-button",value:h,onChange:o=>a({text:o}),placeholder:x||i("Add textâ€¦","fluent-cart"),allowedFormats:["core/bold","core/italic"]})]})},save:function(c){return null}});
