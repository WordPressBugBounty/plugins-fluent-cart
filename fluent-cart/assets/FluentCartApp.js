var ot=o=>{throw TypeError(o)};var tt=(o,t,e)=>t.has(o)||ot("Cannot "+e);var n=(o,t,e)=>(tt(o,t,"read from private field"),e?e.call(o):t.get(o)),m=(o,t,e)=>t.has(o)?ot("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(o):t.set(o,e),p=(o,t,e,a)=>(tt(o,t,"write to private field"),a?a.call(o,e):t.set(o,e),e),l=(o,t,e)=>(tt(o,t,"access private method"),e);class Q{constructor(t={}){this.storageKey=t.storageKey||"fc_utm_data",this.expirationDays=t.expirationDays||30,this.utmKeys=t.utmKeys||Q.getUtmParams(),this.collectFromURL()}collectFromURL(){const t=this.getURLParams();document.referrer&&new URL(document.referrer).hostname!==window.location.hostname&&(t.refer_url=document.referrer),Object.keys(t).length>0&&this.store(t)}getURLParams(){const t=new URLSearchParams(window.location.search),e={};return this.utmKeys.forEach(a=>{const r=t.get(a);r&&(e[a]=r)}),e}store(t){const e=this.getStoredData(),a=Date.now(),c={params:{...e.params,...t},timestamp:a};try{localStorage.setItem(this.storageKey,JSON.stringify(c))}catch{}}getStoredData(){try{const t=localStorage.getItem(this.storageKey);if(t){let e=JSON.parse(t);if(e&&e.timestamp)return e}}catch{}return{params:{},timestamp:null}}get(){return this.getStoredData().params||{}}clear(){try{localStorage.removeItem(this.storageKey)}catch(t){console.warn("UTMManager: Unable to clear localStorage",t)}}static getUtmParams(){return window.fluentcart_utm_vars.allowed_keys||["utm_source","utm_medium","utm_campaign","utm_term","utm_content","utm_id"]}}var it,lt,M,v,W,$,I,U,F,C,P,J,d,D,ht,mt,wt,gt,R,pt,yt,bt,vt;const O=class O{constructor(){m(this,d);m(this,v,[]);m(this,W,"?action=fluent_cart_checkout_routes&fc_checkout_action=fluent_cart_cart_status");m(this,$,"?action=fluent_cart_checkout_routes&fc_checkout_action=fluent_cart_cart_update");m(this,I,window.fluentCartRestVars.ajaxurl);m(this,U,!1);m(this,F,(it=window.fluentcart_drawer_vars)==null?void 0:it.is_admin_bar_showing);m(this,C,"open");m(this,P,"active");m(this,J,((lt=window.fluentcart_drawer_vars)==null?void 0:lt.is_drawer_hidden)=="1")}init(){return n(O,M)!==null?n(O,M):(p(O,M,this),l(this,d,vt).call(this),n(this,J)||l(this,d,bt).call(this),l(this,d,yt).call(this),l(this,d,ht).call(this),l(this,d,mt).call(this),l(this,d,wt).call(this),l(this,d,gt).call(this),this)}async getCart(){let t=await new Promise((e,a)=>{fetch(n(this,I)+n(this,W),{method:"GET",headers:{"Content-Type":"application/json"}}).then(r=>{if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}).then(r=>{r&&r.cart_data?e(r.cart_data):e([])}).catch(r=>{a([])})});return p(this,v,t),window.dispatchEvent(new Event("fluentCartNotifyCartDrawerItemChanged")),t}async addProduct(t,e=1,a=!1,r=!1,c=!1){return l(this,d,D).call(this,t,e,a,r,c)}async removeProduct(t,e=!1){return t=t.toString(),await l(this,d,D).call(this,t,0,!1,e)}async incrementProduct(t,e=1){const a=document.querySelector("[data-fluent-cart-cart-drawer-overlay]");return a&&a.classList.contains("active")&&p(this,U,!0),t=t.toString(),e=Math.abs(parseInt(e.toString())),await l(this,d,D).call(this,t,e)}async decrementProduct(t,e=1){const a=document.querySelector("[data-fluent-cart-cart-drawer-overlay]");return a&&a.classList.contains("active")&&p(this,U,!0),t=t.toString(),e=Math.abs(parseInt(e.toString())),await l(this,d,D).call(this,t,e*-1)}async updateProductQuantity(t,e=1,a=!1){return e=parseInt(e.toString(),10),(isNaN(e)||e<1)&&(e=1),t=t.toString(),await l(this,d,D).call(this,t,e,a)}closeModal(){const t=document.querySelector("[data-fluent-cart-cart-drawer-overlay]"),e=document.querySelector("[data-fluent-cart-cart-drawer]"),a=document.body;t&&t.classList.remove(n(this,P)),e&&e.classList.remove(n(this,C)),a.style.overflow=""}openModal(){const t=document.querySelector("[data-fluent-cart-cart-drawer-overlay]"),e=document.querySelector("[data-fluent-cart-cart-drawer]"),a=document.body;t&&t.classList.add(n(this,P)),e&&e.classList.add(n(this,C)),a.style.overflow="hidden"}appendUtmSource(t){const e=new URLSearchParams(window.location.search);return Q.getUtmParams().forEach(a=>{e.has(a)&&(t[a]=e.get(a))}),t}getState(){return n(this,v)}updateCartTotalPrice(t=[]){var s,i;let e=0;const a=((i=(s=window.fluentcart_drawer_vars)==null?void 0:s.currency_settings)==null?void 0:i.currency_sign)||"$";t.forEach(g=>{g.subtotal&&(e+=g.subtotal)});const r=(e/100).toFixed(2),c=`${a}${r}`;return document.querySelectorAll("[data-fluent-cart-cart-total-price]").forEach(g=>{g.textContent=c}),c}};M=new WeakMap,v=new WeakMap,W=new WeakMap,$=new WeakMap,I=new WeakMap,U=new WeakMap,F=new WeakMap,C=new WeakMap,P=new WeakMap,J=new WeakMap,d=new WeakSet,D=async function(t=null,e=1,a=!1,r=!1,c=!1){if(t==null)return;const s=document.querySelector("[data-fluent-cart-cart-drawer]");let i="";s&&(i=s.querySelector("[data-fluent-cart-cart-drawer-loader]"),i&&i.classList.add("show"));const g=this;let y={item_id:t,quantity:e,is_custom:c};a&&(y.by_input=!0),(n(this,U)||r||a)&&(y.open_cart=!0),y.is_admin_bar_enabled=n(this,F),y=this.appendUtmSource(y);let u=await new Promise((w,q)=>{const E=new URL(n(this,I)+n(this,$));Object.entries(y).forEach(([H,j])=>{E.searchParams.append(H,j)});const S=new XMLHttpRequest;S.open("GET",E.toString(),!0),S.setRequestHeader("Content-Type","application/json"),S.setRequestHeader("X-WP-Nonce",window.fluentCartRestVars.rest.nonce),S.onreadystatechange=function(){var H,j,nt,st;if(S.readyState===XMLHttpRequest.DONE)try{if(S.status>=200&&S.status<300){const f=JSON.parse(S.responseText),Y=(j=(H=f.data)==null?void 0:H.cart)==null?void 0:j.cart_data;let z=0;if(Array.isArray(Y)&&(z=Y.length,document.querySelectorAll("[data-cart-badge-count], .fct-cart-badge-count").forEach(_=>{_.textContent=z.toString(),window.fluentcart_drawer_vars.cart_item_count=z}),g.updateCartTotalPrice(Y)),f&&(f!=null&&f.fragments)&&f.fragments)if(Array.isArray(f.fragments))f.fragments.forEach(_=>{const Z=document.querySelector(_.selector);!Z&&_.selector==="[data-fluent-cart-cart-drawer-container]"&&document.body.insertAdjacentHTML("beforeend",_.content),Z&&_.type==="replace"&&(Z.outerHTML=_.content)});else{const _=document.querySelector(f.fragments.selector);!_&&f.fragments.selector==="[data-fluent-cart-cart-drawer-container]"&&document.body.insertAdjacentHTML("beforeend",f.fragments.content),_&&f.fragments.type==="replace"&&(_.outerHTML=f.fragments.content)}f&&((st=(nt=f==null?void 0:f.data)==null?void 0:nt.cart)!=null&&st.cart_data)?w(f.data.cart.cart_data):(f.message&&new Toastify({text:f.message,className:"warning",duration:3e3,gravity:"top",position:"right",slideFrom:"right",type:"warning"}).showToast(),w([])),i&&i.classList.remove("show")}else{const f=S.responseText&&JSON.parse(S.responseText).message||"An error occurred";new Toastify({text:f,className:"info",duration:2e3,style:{background:"#eabe11"}}).showToast(),i&&i.classList.remove("show"),q(new Error(f))}}catch(f){f.message&&new Toastify({text:f.message,className:"info",duration:2e3,style:{background:"#eabe11"}}).showToast(),i&&i.classList.remove("show"),q(f)}},S.send()});return u.length,p(this,v,u),new URLSearchParams(window.location.search).has("fct_cart_hash")||window.dispatchEvent(new CustomEvent("fluentCartNotifyCartDrawerItemChanged",{detail:{response:u}})),u},ht=function(){const t=this;document.addEventListener("click",async function(e){var r;const a=e.target.closest("[data-fluent-cart-cart-list-item-delete-button]");if(a){const c=a.dataset.itemId,s=await t.removeProduct(c,!0);s!=null&&(p(t,v,s),l(r=t,d,R).call(r))}})},mt=function(){const t=this;document.addEventListener("click",async function(e){var r;const a=e.target.closest("[data-fluent-cart-cart-list-item-increase-button]");if(a){const c=a.dataset.itemId,s=await t.incrementProduct(c);s!=null&&(p(t,v,s),l(r=t,d,R).call(r))}})},wt=function(){const t=this;document.addEventListener("click",async function(e){var r;const a=e.target.closest("[data-fluent-cart-cart-list-item-decrease-button]");if(a){const c=a.dataset.itemId,s=await t.decrementProduct(c);s!=null&&(p(t,v,s),l(r=t,d,R).call(r))}})},gt=function(){const t=this;document.addEventListener("change",async function(e){var r;const a=e.target.closest("[data-fluent-cart-cart-list-item-quantity-input]");if(a){const c=a.dataset.itemId;let s=parseInt(event.target.value,10);parseInt(event.target.dataset.oldValue||"0",10),s<1&&(s=1);let i=s;const g=await t.updateProductQuantity(c,i,!0);g!=null&&(p(t,v,g),l(r=t,d,R).call(r))}})},R=function(){if(l(this,d,pt).call(this)){const t=document.querySelectorAll("[data-fluent-cart-cart-total-item]"),e=document.querySelectorAll("[data-fluent-cart-checkout-page-cart-item-count]"),a=document.querySelectorAll("[data-fluent-cart-cart-total-wrapper]"),r=document.querySelectorAll("[data-fluent-cart-cart-expand-button]"),c=document.querySelectorAll("[data-fluent-cart-cart-checkout-button-wrap]");t&&t.forEach(s=>s.textContent="0"),e&&e.forEach(s=>s.textContent="0"),a&&a.forEach(s=>s.style.display="none"),c&&c.forEach(s=>s.style.display="none"),r&&r.forEach(s=>s.classList.add("is-hidden")),setTimeout(()=>{this.closeModal()},300)}},pt=function(){return n(this,v)===void 0||n(this,v)==null||Object.keys(n(this,v)).length===0},yt=function(){const t=this;document.addEventListener("click",function(e){const a=document.querySelector("[data-fluent-cart-cart-drawer-overlay]");a&&a.contains(e.target)&&t.closeModal()})},bt=function(){const t=this,e=document.body;document.addEventListener("click",a=>{document.querySelector("[data-fluent-cart-cart-drawer-container]");const r=document.querySelector("[data-fluent-cart-cart-drawer]"),c=document.querySelector("[data-fluent-cart-cart-drawer-overlay]"),s=a.target.closest("[data-fluent-cart-cart-toggle-button]"),i=a.target.closest("[data-fluent-cart-cart-expand-button], .fcart-cart-toggle-button"),g=a.target.closest("[data-fluent-cart-cart-collapse-button]");if(s){r&&r.classList.toggle(n(t,C));return}if(i){r&&r.classList.add(n(t,C)),c&&c.classList.add(n(t,P)),e.style.overflow="hidden";return}if(g){r&&r.classList.remove(n(t,C)),c&&c.classList.remove(n(t,P)),e.style.overflow="";return}})},vt=function(){document.querySelectorAll("[data-cart-badge-count], .fct-cart-badge-count").forEach(e=>{var a;e.textContent=((a=window.fluentcart_drawer_vars)==null?void 0:a.cart_item_count)||0});const t=document.querySelector(".fluent-cart-menu-cart-open-button-container");if(t){const e=t.closest("li"),a=e==null?void 0:e.previousElementSibling;if(a&&e){const r=a.cloneNode(!0);r.removeAttribute("id"),r.innerHTML="",r.appendChild(t.cloneNode(!0)),e.parentNode.replaceChild(r,e)}}},m(O,M,null);let et=O;class qt{static init(){document.addEventListener("click",function(t){var g;const e=t.target.closest("[data-fluent-cart-add-to-cart-button]");if(!e||(t.preventDefault(),e.classList.contains("fct-loading")))return;e.classList.add("fct-loading");const a=e.getAttribute("data-cart-id");if(!a)return;let r=parseInt(e.getAttribute("data-quantity"),10)||1;const c=e.getAttribute("data-action-name"),s=e.getAttribute("data-error-action-name");e.setAttribute("data-quantity","1");const i=e.getAttribute("data-is-custom");(g=window.fluentCartCart)==null||g.addProduct(a,r,!1,!0,i).then(y=>{setTimeout(()=>{e.classList.remove("fct-loading")},300),document.dispatchEvent(new Event(c))}).catch(y=>{console.log(y,"error"),e.classList.remove("fct-loading"),document.dispatchEvent(new Event(s))})})}}var x,T,b,A,k,V,B,rt,h,Et,St,_t,Lt,K,Ct,X,G,Tt,At,kt,Pt;const L=class L{constructor(){m(this,h);m(this,T,null);m(this,b,null);m(this,A,null);m(this,k,null);m(this,V,300);m(this,B,null);m(this,rt,null);m(this,X,()=>{l(this,h,kt).call(this);const t=n(this,b).contentDocument||n(this,b).contentWindow.document,e=t.body.scrollHeight,a=t.querySelector("[data-fct-modal-checkout-form-inner]");a&&(a.style.height=e+120+"px"),n(this,b).style.height=e+120+"px"});m(this,G,t=>{var e;t.origin===window.location.origin&&((e=t.data)==null?void 0:e.type)==="fluentCartCheckoutComplete"&&(t.data.redirectUrl?window.location.href=t.data.redirectUrl:this.closeModal())});var t;this.translate=((t=window.fluentcart)==null?void 0:t.$t)||(e=>e),l(this,h,Et).call(this),l(this,h,St).call(this)}static init(){return n(L,x)||p(L,x,new L),n(L,x)}openModal(t){if(n(this,T)||!n(this,A)||!n(this,b)){(!n(this,A)||!n(this,b))&&l(this,h,Tt).call(this);return}p(this,T,n(this,A)),l(this,h,At).call(this),n(this,b).src=t,n(this,b).addEventListener("load",()=>{n(this,X).call(this),l(this,h,Pt).call(this,n(this,b))},{once:!0}),n(this,B)||(p(this,B,!0),window.addEventListener("message",n(this,G))),n(this,A).classList.add("fct-checkout-modal-open"),window.dispatchEvent(new CustomEvent("fluentCartModalCheckoutOpened",{detail:{checkoutUrl:t}}))}closeModal(){n(this,T)&&(n(this,T).classList.remove("fct-checkout-modal-open"),setTimeout(()=>{n(this,b)&&(n(this,b).src=""),p(this,T,null),window.dispatchEvent(new CustomEvent("fluentCartModalCheckoutClosed"))},n(this,V)))}};x=new WeakMap,T=new WeakMap,b=new WeakMap,A=new WeakMap,k=new WeakMap,V=new WeakMap,B=new WeakMap,rt=new WeakMap,h=new WeakSet,Et=function(){p(this,k,document.querySelector("[data-fct-checkout-modal-loader]")),p(this,A,document.querySelector("[data-fct-checkout-modal-container]")),p(this,b,document.querySelector("[data-fct-checkout-modal-iframe]"))},St=function(){l(this,h,_t).call(this),document.addEventListener("click",l(this,h,Ct).bind(this)),l(this,h,Lt).call(this)},_t=function(){document.querySelectorAll("[data-fct-instant-checkout-button]").forEach(e=>{e.addEventListener("click",l(this,h,K).bind(this))})},Lt=function(){new MutationObserver(e=>{e.forEach(a=>{a.addedNodes.forEach(r=>{var c;r.nodeType===1&&((c=r.hasAttribute)!=null&&c.call(r,"data-fct-instant-checkout-button")&&r.addEventListener("click",l(this,h,K).bind(this)),r.querySelectorAll&&r.querySelectorAll("[data-fct-instant-checkout-button]").forEach(i=>{i.addEventListener("click",l(this,h,K).bind(this))}))})})}).observe(document.body,{childList:!0,subtree:!0})},K=function(t){t.preventDefault();const a=t.currentTarget.getAttribute("href"),r=new URL(a,window.location.origin);r.searchParams.set("fluent-cart","modal_checkout"),this.openModal(r.toString())},Ct=function(t){t.target.closest("[data-fct-checkout-modal-close]")&&(t.preventDefault(),this.closeModal())},X=new WeakMap,G=new WeakMap,Tt=function(){typeof Toastify<"u"?new Toastify({text:this.translate("Modal checkout is not available. Please try again."),className:"info",duration:3e3,style:{background:"linear-gradient(to right, rgb(255 30 30), rgb(252 133 101))",color:"#fff"}}).showToast():alert(this.translate("Modal checkout is not available. Please try again."))},At=function(){n(this,k)&&(n(this,k).style.display="")},kt=function(){n(this,k)&&(n(this,k).style.display="none")},Pt=function(t){var e;try{const a=t.contentDocument||((e=t.contentWindow)==null?void 0:e.document);if(!a||!a.body)return;const r=s=>{if(s.tagName!=="A")return;const i=s.getAttribute("href")||"";i.startsWith("#")||i.startsWith("mailto:")||i.startsWith("tel:")||(s.hasAttribute("target")||(s.target="_blank"),s.rel||(s.rel="noopener noreferrer"))};a.querySelectorAll("a").forEach(r),new MutationObserver(s=>{var i,g;for(const y of s)for(const u of y.addedNodes)u.nodeType===1&&((i=u.matches)!=null&&i.call(u,"a")&&r(u),(g=u.querySelectorAll)==null||g.call(u,"a").forEach(r))}).observe(a.body,{childList:!0,subtree:!0})}catch{}},m(L,x,null);let at=L;var ut,dt,ft;const Dt={...((ut=window.fluentcart_checkout_vars)==null?void 0:ut.trans)||{},...((dt=window.fluentcart_checkout_vars)==null?void 0:dt.payments_trans)||{},...((ft=window.fluentcart_shop_vars)==null?void 0:ft.trans)||{}};window.fluentcart={$t:function(o){let t=Dt[o]||o;const e=Array.prototype.slice.call(arguments,1);if(e.length===0)return t;const a=/%(\d*\$?)s|%d/g;let r=0;return t=t.replace(a,(c,s)=>{if(s){const i=parseInt(s,10)-1;return i<e.length?e[i]:c}else return r<e.length?e[r++]:c}),t}};const xt=function(o,t){return Object.keys(o).reduce(function(e,a){const r=t+"["+a+"]";return o[a]!==null&&typeof o[a]=="object"&&!Array.isArray(o[a])?Object.assign(e,xt(o[a],r)):e[r]=o[a],e},{})},ct=function(o,t={},e){const a=`${window.fluentCartRestVars.ajaxurl}`,r=new AbortController,c=r.signal,s={"X-WP-Nonce":window.fluentCartRestVars.rest.nonce};["PUT","PATCH","DELETE"].indexOf(o.toUpperCase())!==-1&&(s["X-HTTP-Method-Override"]=o,o="POST"),t.query_timestamp=Date.now();const i=new Promise((g,y)=>{const u=new XMLHttpRequest;let N=a;if(o.toUpperCase()==="GET"){let w={};Object.keys(t).forEach(E=>{t[E]===null||t[E]===!1?delete t[E]:typeof t[E]=="object"?w=Object.assign(w,xt(t[E],E)):w[E]=t[E]});let q=new URLSearchParams(w).toString();N.indexOf("?")!==-1?N+="&"+q:N+="?"+q}u.open(o,N,!0),c.addEventListener("abort",()=>{u.abort(),y({aborted:!0,message:"Request aborted"})}),Object.keys(s).forEach(w=>{u.setRequestHeader(w,s[w])}),u.onload=function(){let w;try{w=JSON.parse(u.responseText)}catch{w=null}this.status>=200&&this.status<300?g(w):(w&&(typeof w=="object"&&(w.xhr_status=u.status),w.code=="rest_cookie_invalid_nonce"&&document.dispatchEvent(new CustomEvent("fcart_renew_rest_nonce",{detail:w}))),y(w))},u.onerror=function(){console.info("Your server firewall blocked the request or it's a plugin conflict. Please check the detailed error."),console.log({status:u.status,statusText:u.statusText,responseText:u.responseText}),y({status:u.status,statusText:u.statusText})},o.toUpperCase()==="GET"?u.send():(u.setRequestHeader("Content-Type","application/json;charset=UTF-8"),u.send(JSON.stringify(t)))});return e?{request:i,controller:r}:i};document.addEventListener("DOMContentLoaded",function(){window.fluentCartCart=new et().init(),window.fluentCartUtmManager=new Q,qt.init(),window.fluentCartAjax={get:function(o={},t=!1){return ct("GET",o,t)},post:function(o={},t=!1){return ct("POST",o,t)}},window.fluentcart.ajax=window.fluentCartAjax,at.init(),window.dispatchEvent(new CustomEvent("fluent_cart_app_loaded",{})),document.addEventListener("click",function(o){const t=o.target.closest("[data-fluent-cart-collapsible-toggle]");if(!t)return;o.preventDefault(),t.closest("[data-fluent-cart-collapsibles]").classList.toggle("show-all")})});
