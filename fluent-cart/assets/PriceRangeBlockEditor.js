import{j as r,b as a}from"./chunks/BlockEditorTranslator.js";import{a as y}from"./chunks/index4.js";import{E as N}from"./chunks/EditorPanel.js";import{E as m}from"./chunks/EditorPanelRow.js";import{C as w}from"./chunks/CustomSelect.js";import{S as k}from"./chunks/SelectProductModal.js";import{u as v}from"./chunks/SingleProductContext.js";import{i as S}from"./chunks/Icons.js";import{a as b}from"./chunks/add-query-args.js";import"./chunks/index5.js";import"./chunks/ProductListItem.js";const{InspectorControls:E}=wp.blockEditor,I=({attributes:n,setAttributes:s,selectedProduct:t,setSelectedProduct:c})=>r.jsx(E,{children:r.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:r.jsx("div",{className:"fct-inspector-control-group",children:r.jsx("div",{className:"fct-inspector-control-body",children:r.jsxs(N,{title:a("Product"),children:[r.jsxs(m,{children:[r.jsx("span",{className:"fct-inspector-control-label",children:a("Query type")}),r.jsx("div",{className:"actions",children:r.jsx(w,{customKeys:{key:"value",label:"label"},defaultValue:n.query_type,options:[{label:a("Default"),value:"default"},{label:a("Custom"),value:"custom"}],onChange:function(e){s({query_type:e})}})})]}),n.query_type==="custom"&&r.jsxs(m,{className:"flex-col",children:[r.jsx(k,{onModalClosed:e=>{s({product_id:e.ID||""}),c(e)},selectedProduct:t,setSelectedProduct:c,isMultiple:!1}),(t==null?void 0:t.detail)&&r.jsxs("div",{className:"fct-product-price-range",children:[r.jsx("strong",{children:a("Price Range")}),":",r.jsx("span",{className:"price-min",dangerouslySetInnerHTML:{__html:t.detail.formatted_min_price}}),t.detail.min_price!==t.detail.max_price&&r.jsxs(r.Fragment,{children:[" - ",r.jsx("span",{className:"price-max",dangerouslySetInnerHTML:{__html:t.detail.formatted_max_price}})]})]}),!(t!=null&&t.detail)&&r.jsxs("div",{className:"fct-product-price-range",children:[r.jsx("strong",{children:a("Price Range")}),": $0.00"]})]})]})})})})}),{useBlockProps:C}=wp.blockEditor,{registerBlockType:M}=wp.blocks,{useEffect:R,useState:T}=wp.element,{useSelect:q}=wp.data,{store:B}=wp.blockEditor,i=window.fluent_cart_price_range_data;i.placeholder_image;const u=window.fluentCartRestVars.rest;M(i.slug+"/"+i.name,{apiVersion:3,title:i.title,description:i.description,icon:{src:S},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"}},edit:({attributes:n,setAttributes:s,clientId:t})=>{const c=C(),[e,l]=T({}),f=u.url+"/products/"+n.product_id,o=v(),p=q(d=>{const{getBlockParents:x,getBlockName:h}=d(B);return x(t).some(g=>{const j=h(g);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(j)})},[t]);s({inside_product_info:p?"yes":"no"});const _=()=>{y({path:b(f,{with:["detail","variants"]}),headers:{"X-WP-Nonce":u.nonce}}).then(d=>{l(d.product||{})}).finally(()=>{})};return R(()=>{o!=null&&o.product&&l(o.product),!p&&n.product_id&&_()},[n.product_id,o==null?void 0:o.product]),r.jsxs("div",{...c,children:[p?"":r.jsx(I,{attributes:n,setAttributes:s,selectedProduct:e,setSelectedProduct:l}),e!=null&&e.detail?r.jsxs("div",{className:"fct-product-price-range",children:[r.jsx("span",{className:"price-min",dangerouslySetInnerHTML:{__html:e.detail.formatted_min_price}}),e.detail.min_price!==e.detail.max_price&&r.jsxs(r.Fragment,{children:[" - ",r.jsx("span",{className:"price-max",dangerouslySetInnerHTML:{__html:e.detail.formatted_max_price}})]})]}):"$0.00"]})},save:function(n){return null}});
