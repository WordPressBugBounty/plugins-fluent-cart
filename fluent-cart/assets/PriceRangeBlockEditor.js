import{j as t,b as d}from"./chunks/BlockEditorTranslator.js?ver=1.3.12";import{a as y}from"./chunks/index4.js?ver=1.3.12";import{S as k}from"./chunks/SelectProductModal.js?ver=1.3.12";import{E as w}from"./chunks/EditorPanel.js?ver=1.3.12";import{E as S}from"./chunks/EditorPanelRow.js?ver=1.3.12";import{u as N}from"./chunks/SingleProductContext.js?ver=1.3.12";import{k as b}from"./chunks/Icons.js?ver=1.3.12";import{a as v}from"./chunks/add-query-args.js?ver=1.3.12";import"./chunks/ProductListItem.js?ver=1.3.12";import"./chunks/index5.js?ver=1.3.12";const{InspectorControls:E}=wp.blockEditor,I=({attributes:i,setAttributes:a,selectedProduct:r,setSelectedProduct:c})=>t.jsx(E,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsx(w,{title:d("Product"),children:t.jsxs(S,{className:"flex-col",children:[t.jsx(k,{onModalClosed:e=>{a({product_id:e!=null&&e.ID?String(e.ID):""}),c(e)},selectedProduct:r,setSelectedProduct:c,isMultiple:!1}),(r==null?void 0:r.post_title)&&t.jsxs("div",{className:"fct-selected-products",children:[t.jsx("span",{className:"fct-selected-products__label",children:d("Selected Product")}),t.jsx("div",{className:"fct-selected-products__list",children:t.jsx("div",{className:"fct-product-chip-group",children:t.jsx("span",{className:"fct-product-chip fct-product-chip--parent",children:r.post_title})})}),(r==null?void 0:r.detail)&&t.jsxs("div",{className:"fct-selected-products__preview",children:[t.jsxs("strong",{children:[d("Price"),":"]})," ",t.jsx("span",{dangerouslySetInnerHTML:{__html:r.detail.formatted_min_price}}),r.detail.min_price!==r.detail.max_price&&t.jsxs(t.Fragment,{children:[" - ",t.jsx("span",{dangerouslySetInnerHTML:{__html:r.detail.formatted_max_price}})]})]})]})]})})})})})}),{useBlockProps:T}=wp.blockEditor,{registerBlockType:F,createBlock:M}=wp.blocks,{useEffect:u,useState:B}=wp.element,{useSelect:H}=wp.data,{store:L}=wp.blockEditor,o=window.fluent_cart_price_range_data;o.placeholder_image;const m=window.fluentCartRestVars.rest;F(o.slug+"/"+o.name,{apiVersion:3,title:o.title,description:o.description,icon:{src:b},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"}},edit:({attributes:i,setAttributes:a,clientId:r})=>{const c=T(),[e,p]=B({}),f=m.url+"/products/"+i.product_id,n=N(),s=H(l=>{const{getBlockParents:h,getBlockName:x}=l(L);return h(r).some(g=>{const j=x(g);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(j)})},[r]);u(()=>{a({inside_product_info:s?"yes":"no",...s?{}:{query_type:"custom"}})},[s]);const _=()=>{y({path:v(f,{with:["detail","variants"]}),headers:{"X-WP-Nonce":m.nonce}}).then(l=>{p(l.product||{})}).finally(()=>{})};return u(()=>{n!=null&&n.product&&p(n.product),!s&&i.product_id&&_()},[i.product_id,n==null?void 0:n.product]),t.jsxs("div",{...c,children:[s?"":t.jsx(I,{attributes:i,setAttributes:a,selectedProduct:e,setSelectedProduct:p}),e!=null&&e.detail?t.jsxs("div",{className:"fct-product-price-range",children:[t.jsx("span",{className:"price-min",dangerouslySetInnerHTML:{__html:e.detail.formatted_min_price}}),e.detail.min_price!==e.detail.max_price&&t.jsxs(t.Fragment,{children:[" - ",t.jsx("span",{className:"price-max",dangerouslySetInnerHTML:{__html:e.detail.formatted_max_price}})]})]}):"$0.00"]})},save:function(i){return null},transforms:{from:[{type:"block",blocks:["fluent-cart/shopapp-product-price"],transform:()=>M(o.slug+"/"+o.name)}]},supports:{html:!1,align:["left","center","right"],typography:{fontSize:!0,lineHeight:!0,__experimentalFontFamily:!0,__experimentalFontWeight:!0,__experimentalFontStyle:!0,__experimentalTextTransform:!0,__experimentalTextDecoration:!0,__experimentalLetterSpacing:!0,__experimentalDefaultControls:{fontSize:!0,lineHeight:!0,fontWeight:!0}},color:{text:!0,background:!0,link:!0,gradients:!0},spacing:{margin:!0,padding:!0},__experimentalBorder:{color:!0,radius:!0,style:!0,width:!0},shadow:!0}});
