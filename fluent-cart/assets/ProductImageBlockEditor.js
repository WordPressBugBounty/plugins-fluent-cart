import{j as t,b as u}from"./chunks/BlockEditorTranslator.js?ver=1.3.12";import{a as y}from"./chunks/index4.js?ver=1.3.12";import{S as b}from"./chunks/SelectProductModal.js?ver=1.3.12";import{E as k}from"./chunks/EditorPanel.js?ver=1.3.12";import{E as v}from"./chunks/EditorPanelRow.js?ver=1.3.12";import{u as N}from"./chunks/SingleProductContext.js?ver=1.3.12";import{h as E}from"./chunks/Icons.js?ver=1.3.12";import{a as S}from"./chunks/add-query-args.js?ver=1.3.12";import"./chunks/ProductListItem.js?ver=1.3.12";import"./chunks/index5.js?ver=1.3.12";const{InspectorControls:I}=wp.blockEditor,B=({attributes:a,setAttributes:l,selectedProduct:r,setSelectedProduct:p,isInsideProductInfo:o})=>{var i,d;return o?null:t.jsx(I,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsx(k,{title:u("Product"),children:t.jsxs(v,{className:"flex-col",children:[t.jsx(b,{onModalClosed:e=>{l({product_id:e!=null&&e.ID?String(e.ID):""}),p(e)},selectedProduct:r,setSelectedProduct:p,isMultiple:!1}),(r==null?void 0:r.post_title)&&t.jsxs("div",{className:"fct-selected-products",children:[t.jsx("span",{className:"fct-selected-products__label",children:u("Selected Product")}),t.jsx("div",{className:"fct-selected-products__list",children:t.jsx("div",{className:"fct-product-chip-group",children:t.jsx("span",{className:"fct-product-chip fct-product-chip--parent",children:r.post_title})})}),((d=(i=r==null?void 0:r.detail)==null?void 0:i.featured_media)==null?void 0:d.url)&&t.jsx("div",{className:"fct-selected-products__preview",children:t.jsx("img",{src:r.detail.featured_media.url,alt:r.post_title,style:{width:"100%",maxHeight:"150px",objectFit:"cover",borderRadius:"4px",marginTop:"8px"}})})]})]})})})})})})},{useBlockProps:R}=wp.blockEditor,{registerBlockType:q,createBlock:C}=wp.blocks,{useEffect:m,useState:F}=wp.element,{useSelect:M}=wp.data,{store:T}=wp.blockEditor,s=window.fluent_cart_product_image_data;s.placeholder_image;const f=window.fluentCartRestVars.rest;q(s.slug+"/"+s.name,{apiVersion:3,title:s.title,description:s.description,icon:{src:E},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"}},edit:({attributes:a,setAttributes:l,clientId:r})=>{const p=R(),[o,i]=F({}),d=f.url+"/products/"+a.product_id,e=N(),c=M(n=>{const{getBlockParents:g,getBlockName:x}=n(T);return g(r).some(j=>{const w=x(j);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(w)})},[r]);m(()=>{l({inside_product_info:c?"yes":"no",...c?{}:{query_type:"custom"}})},[c]);const _=()=>{y({path:S(d,{with:["detail","variants"]}),headers:{"X-WP-Nonce":f.nonce}}).then(n=>{i(n.product||{})}).finally(()=>{})};m(()=>{e!=null&&e.product&&i(e.product),!c&&a.product_id&&_()},[a.product_id,e==null?void 0:e.product]);const h=()=>{const n=window.fluent_cart_block_editor_asset.placeholder_image;return o&&o.detail&&o.detail.featured_media&&o.detail.featured_media!==null&&typeof o.detail.featured_media=="object"&&o.detail.featured_media.url?o.detail.featured_media.url:n};return t.jsxs("div",{...p,children:[t.jsx(B,{attributes:a,setAttributes:l,selectedProduct:o,setSelectedProduct:i,isInsideProductInfo:c}),t.jsx("div",{className:"group-[.list]:flex-shrink-0",children:t.jsx("img",{src:h(),className:"w-full aspect-square object-cover rounded-md group-[.list]:w-[214px]",alt:o.product?o.product.post_title:"Product"})})]})},save:function(a){return null},transforms:{from:[{type:"block",blocks:["fluent-cart/shopapp-product-image"],transform:()=>C(s.slug+"/"+s.name)}]},supports:{html:!1,align:["left","center","right"],__experimentalBorder:{color:!0,radius:!0,style:!0,width:!0},spacing:{margin:!0,padding:!0},shadow:!0,__experimentalFilter:{duotone:!0}}});
