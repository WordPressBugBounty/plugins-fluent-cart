import{j as t,b as r}from"./chunks/BlockEditorTranslator.js";import{a as E}from"./chunks/index4.js";import{E as S}from"./chunks/EditorPanel.js";import{E as h}from"./chunks/EditorPanelRow.js";import{C as B}from"./chunks/CustomSelect.js";import{S as I}from"./chunks/SelectProductModal.js";import{u as L}from"./chunks/SingleProductContext.js";import{T as M}from"./chunks/Icons.js";import{a as q}from"./chunks/add-query-args.js";import"./chunks/index5.js";import"./chunks/ProductListItem.js";const{InspectorControls:g}=wp.blockEditor,{PanelBody:R,ToggleControl:k}=wp.components,V=({attributes:n,setAttributes:l,selectedProduct:e,setSelectedProduct:c,isInsideProductInfo:s})=>{const{isLink:i,linkTarget:d}=n;return t.jsxs(t.Fragment,{children:[s?"":t.jsx(g,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsxs(S,{title:r("Product"),children:[t.jsxs(h,{children:[t.jsx("span",{className:"fct-inspector-control-label",children:r("Query type")}),t.jsx("div",{className:"actions",children:t.jsx(B,{customKeys:{key:"value",label:"label"},defaultValue:n.query_type,options:[{label:r("Default"),value:"default"},{label:r("Custom"),value:"custom"}],onChange:function(o){l({query_type:o})}})})]}),n.query_type==="custom"&&t.jsxs(h,{className:"flex-col",children:[t.jsx(I,{onModalClosed:o=>{l({product_id:o.ID||""}),c(o)},selectedProduct:e,setSelectedProduct:c,isMultiple:!1}),(e==null?void 0:e.detail)&&t.jsxs("div",{className:"fct-product-title",children:[t.jsx("strong",{children:r("Product Title")}),":",t.jsx("span",{className:"product-title",dangerouslySetInnerHTML:{__html:e.post_title}})]}),!(e!=null&&e.detail)&&t.jsxs("div",{className:"fct-product-product-title",children:[t.jsx("strong",{children:r("Product Title")}),":"]})]})]})})})})}),t.jsx(g,{children:t.jsxs(R,{title:r("Settings"),children:[t.jsx(k,{label:r("Make title a link"),checked:i,onChange:o=>l({isLink:o})}),i&&t.jsx(k,{label:r("Open in new tab"),checked:d==="_blank",onChange:o=>l({linkTarget:o?"_blank":"_self"})})]})})]})},{useBlockProps:D}=wp.blockEditor,{registerBlockType:F}=wp.blocks,{useEffect:H,useState:Q}=wp.element,{useSelect:U}=wp.data,{store:z}=wp.blockEditor,p=window.fluent_cart_product_title_data;p.placeholder_image;const x=window.fluentCartRestVars.rest;F(p.slug+"/"+p.name,{apiVersion:3,title:p.title,description:p.description,icon:{src:M},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"},isLink:{type:"boolean",default:!0},linkTarget:{type:"string",default:"_self"}},edit:({attributes:n,setAttributes:l,clientId:e})=>{const c=D(),[s,i]=Q({}),d=x.url+"/products/"+n.product_id,o=L(),u=U(a=>{const{getBlockParents:b,getBlockName:T}=a(z);return b(e).some(N=>{const C=T(N);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(C)})},[e]);l({inside_product_info:u?"yes":"no"});const _=()=>{E({path:q(d,{with:["detail","variants"]}),headers:{"X-WP-Nonce":x.nonce}}).then(a=>{i(a.product||{})}).finally(()=>{})};H(()=>{o!=null&&o.product&&i(o.product),!u&&n.product_id&&_()},[n.product_id,o==null?void 0:o.product]);const y=(s==null?void 0:s.post_title)||r("Product Title"),j=(s==null?void 0:s.view_url)||"#",{isLink:f,linkTarget:m}=n,w=f?"a":"h5",v=f?{href:j,target:m,rel:m==="_blank"?"noopener noreferrer":void 0,onClick:a=>a.preventDefault()}:{};return t.jsxs("div",{...c,children:[t.jsx(V,{attributes:n,setAttributes:l,selectedProduct:s,setSelectedProduct:i,isInsideProductInfo:u,isLink:f,linkTarget:m}),t.jsx(w,{...c,...v,children:y})]})},save:function(n){return null},supports:{html:!1,align:["left","center","right"],typography:{fontSize:!0,lineHeight:!0},spacing:{margin:!0},color:{text:!0,link:!0}}});
