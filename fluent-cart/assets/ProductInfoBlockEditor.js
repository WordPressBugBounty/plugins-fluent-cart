import{j as t,b as c}from"./chunks/BlockEditorTranslator.js";import{k as g}from"./chunks/Icons.js";import{a as j}from"./chunks/index4.js";import{S as v}from"./chunks/SelectProductModal.js";import{E as b}from"./chunks/EditorPanel.js";import{E as d}from"./chunks/EditorPanelRow.js";import{C as k}from"./chunks/CustomSelect.js";import{S as w}from"./chunks/SingleProductContext.js";import{a as P}from"./chunks/add-query-args.js";import"./chunks/ProductListItem.js";import"./chunks/index5.js";const{InspectorControls:_}=wp.blockEditor,N=({attributes:e,setAttributes:l,selectedProduct:r,setSelectedProduct:a})=>t.jsx(_,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsxs(b,{title:c("Product"),children:[t.jsxs(d,{children:[t.jsx("span",{className:"fct-inspector-control-label",children:c("Query type")}),t.jsx("div",{className:"actions",children:t.jsx(k,{customKeys:{key:"value",label:"label"},defaultValue:e.query_type,options:[{label:c("Default"),value:"default"},{label:c("Custom"),value:"custom"}],onChange:function(o){l({query_type:o})}})})]}),e.query_type==="custom"&&t.jsxs(d,{className:"flex-col",children:[t.jsx(v,{onModalClosed:o=>{l({product_id:o.ID||""}),a(o)},selectedProduct:r,setSelectedProduct:a,isMultiple:!1}),r&&t.jsxs("div",{className:"fct-selected-variation-info w-full",children:[t.jsx("strong",{children:c("Selected Product:")}),t.jsx("p",{children:r.post_title})]})]})]})})})})}),E=""+new URL("assets/ProductInfo.png",import.meta.url).href,{useBlockProps:p,InnerBlocks:u}=wp.blockEditor,{registerBlockType:S}=wp.blocks,{useEffect:C,useState:f}=wp.element,s=window.fluent_cart_product_info_data;s.placeholder_image;const m=window.fluentCartRestVars.rest,I=[["core/columns",{},[["core/column",{},[["fluent-cart/product-gallery",{}]]],["core/column",{},[["fluent-cart/shopapp-product-title",{}],["fluent-cart/excerpt",{}],["fluent-cart/stock",{}],["fluent-cart/price-range",{}],["fluent-cart/buy-section",{}]]]]]];S(s.slug+"/"+s.name,{apiVersion:3,title:s.title,description:s.description,example:{attributes:{},innerBlocks:[{name:"core/image",attributes:{url:E,alt:"Product Info Preview",style:{width:"100%",height:"auto"}}}]},icon:{src:g},category:"fluent-cart",supports:{html:!1,reusable:!1,innerBlocks:!0},attributes:{product_id:{type:"string",default:""},variant_id:{type:"string",default:""},query_type:{type:"string",default:"default"}},edit:({attributes:e,setAttributes:l})=>{const r=p({className:"my-plugin-product-card"}),[a,o]=f({}),[n,i]=f({}),h=m.url+"/products/"+e.product_id,x=()=>{j({path:P(h,{with:["detail","variants"]}),headers:{"X-WP-Nonce":m.nonce}}).then(y=>{i(y.product||{})}).finally(()=>{})};return C(()=>{x()},[e.product_id]),t.jsxs("div",{...r,children:[t.jsx(N,{attributes:e,setAttributes:l,selectedProduct:n,setSelectedProduct:i}),t.jsx("div",{className:"product-card-inner",style:{border:"1px solid #eee",padding:"16px",borderRadius:"8px"},children:t.jsx(w,{value:{product:n},children:t.jsx(u,{template:I,templateLock:!1,allowedBlocks:["core/heading","fluent-cart/buy-section","fluent-cart/product-gallery","fluent-cart/stock","fluent-cart/price-range","core/columns","core/paragraph","core/title","fluent-cart/shopapp-product-title","fluent-cart/excerpt"]})})})]})},save:()=>{const e=p.save({className:"my-plugin-product-card"});return t.jsx("div",{...e,children:t.jsx("div",{className:"product-card-inner",children:t.jsx(u.Content,{})})})}});
