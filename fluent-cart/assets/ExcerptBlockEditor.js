import{j as t,b as s}from"./chunks/BlockEditorTranslator.js";import{a as w}from"./chunks/index4.js";import{E}from"./chunks/EditorPanel.js";import{E as u}from"./chunks/EditorPanelRow.js";import{C as k}from"./chunks/CustomSelect.js";import{S as v}from"./chunks/SelectProductModal.js";import{u as b}from"./chunks/SingleProductContext2.js";import{E as g}from"./chunks/Icons.js";import{a as N}from"./chunks/add-query-args.js";import"./chunks/index5.js";import"./chunks/ProductListItem.js";const{InspectorControls:S}=wp.blockEditor,C=({attributes:r,setAttributes:n,selectedProduct:e,setSelectedProduct:l})=>t.jsx(S,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsxs(E,{title:s("Product"),children:[t.jsxs(u,{children:[t.jsx("span",{className:"fct-inspector-control-label",children:s("Query type")}),t.jsx("div",{className:"actions",children:t.jsx(k,{customKeys:{key:"value",label:"label"},defaultValue:r.query_type,options:[{label:s("Default"),value:"default"},{label:s("Custom"),value:"custom"}],onChange:function(o){n({query_type:o})}})})]}),r.query_type==="custom"&&t.jsxs(u,{className:"flex-col",children:[t.jsx(v,{onModalClosed:o=>{n({product_id:o.ID||""}),l(o)},selectedProduct:e,setSelectedProduct:l,isMultiple:!1}),e&&t.jsxs("div",{className:"fct-selected-variation-info w-full",children:[t.jsx("strong",{children:s("Excerpt:")}),(e==null?void 0:e.post_excerpt)||s("(empty)")]})]})]})})})})}),{useBlockProps:q}=wp.blockEditor,{registerBlockType:B}=wp.blocks,{useEffect:I,useState:M}=wp.element,{useSelect:R}=wp.data,{store:V}=wp.blockEditor,a=window.fluent_cart_excerpt_data;a.placeholder_image;const f=window.fluentCartRestVars.rest;B(a.slug+"/"+a.name,{apiVersion:3,title:a.title,description:a.description,icon:{src:g},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"}},edit:({attributes:r,setAttributes:n,clientId:e})=>{const l=q({className:"fct-product-block-editor-product-card-excerpt"}),[o,p]=M({}),m=f.url+"/products/"+r.product_id,c=b(),i=R(d=>{const{getBlockParents:h,getBlockName:y}=d(V);return h(e).some(_=>{const j=y(_);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(j)})},[e]);n({inside_product_info:i?"yes":"no"});const x=()=>{w({path:N(m,{with:["detail","variants"]}),headers:{"X-WP-Nonce":f.nonce}}).then(d=>{p(d.product||{})}).finally(()=>{})};return I(()=>{c!=null&&c.product&&p(c.product),!i&&r.product_id&&x()},[r.product_id,c==null?void 0:c.product]),t.jsxs("div",{...l,children:[i?"":t.jsx(C,{attributes:r,setAttributes:n,selectedProduct:o,setSelectedProduct:p}),t.jsx("div",{className:"fct-product-excerpt",children:(o==null?void 0:o.post_excerpt)||s("Excerpt")})]})},save:function(r){return null}});
