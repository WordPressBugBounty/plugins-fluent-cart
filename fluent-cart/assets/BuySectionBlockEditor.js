import{j as t,b as i}from"./chunks/BlockEditorTranslator.js";import{a as S}from"./chunks/index4.js";import{E as B}from"./chunks/EditorPanel.js";import{E as x}from"./chunks/EditorPanelRow.js";import{C as E}from"./chunks/CustomSelect.js";import{S as q}from"./chunks/SelectProductModal.js";import{u as C}from"./chunks/SingleProductContext2.js";import{B as L}from"./chunks/Icons.js";import{a as M}from"./chunks/add-query-args.js";import"./chunks/index5.js";import"./chunks/ProductListItem.js";const{InspectorControls:I}=wp.blockEditor,$=({attributes:a,setAttributes:c,selectedProduct:o,setSelectedProduct:d})=>t.jsx(I,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsxs(B,{title:i("Product"),children:[t.jsxs(x,{children:[t.jsx("span",{className:"fct-inspector-control-label",children:i("Query type")}),t.jsx("div",{className:"actions",children:t.jsx(E,{customKeys:{key:"value",label:"label"},defaultValue:a.query_type,options:[{label:i("Default"),value:"default"},{label:i("Custom"),value:"custom"}],onChange:function(e){c({query_type:e})}})})]}),a.query_type==="custom"&&t.jsxs(x,{className:"flex-col",children:[t.jsx(q,{onModalClosed:e=>{c({product_id:e.ID||""}),d(e)},selectedProduct:o,setSelectedProduct:d,isMultiple:!1}),o&&t.jsxs("div",{className:"fct-selected-variation-info w-full",children:[t.jsx("strong",{children:i("Selected product:")}),t.jsx("p",{children:o.post_title})]})]})]})})})})}),R=""+new URL("assets/BuySection.png",import.meta.url).href,{useBlockProps:Q}=wp.blockEditor,{registerBlockType:V}=wp.blocks,{useEffect:j,useState:W}=wp.element,{useSelect:F}=wp.data,{store:U}=wp.blockEditor,l=window.fluent_cart_buy_section_data,y=l.placeholder_image,w=window.fluentCartRestVars.rest;V(l.slug+"/"+l.name,{apiVersion:3,title:l.title,description:l.description,icon:{src:L},example:{attributes:{},innerBlocks:[{name:"core/image",attributes:{url:R,alt:"Buy Section Preview",style:{width:"100%",height:"auto"}}}]},category:"fluent-cart",attributes:{product_id:{type:["string","number"],default:""},query_type:{type:"string",default:"default"},inside_product_info:{type:"string",default:"-"}},edit:({attributes:a,setAttributes:c,clientId:o})=>{var m,f,h,v;const d=Q(),[e,p]=W({}),N=w.url+"/products/"+a.product_id,n=C(),u=F(s=>{const{getBlockParents:r,getBlockName:g}=s(U);return r(o).some(b=>{const k=g(b);return["fluent-cart/product-info","fluent-cart/product-carousel"].includes(k)})},[o]);c({inside_product_info:u?"yes":"no"});const _=()=>{S({path:M(N,{with:["variants"]}),headers:{"X-WP-Nonce":w.nonce}}).then(s=>{p(s.product||{})}).finally(()=>{})};return j(()=>{n!=null&&n.product&&p(n.product)},[n==null?void 0:n.product]),j(()=>{u||_()},[a.product_id]),t.jsxs("div",{...d,children:[u?"":t.jsx($,{attributes:a,setAttributes:c,selectedProduct:e,setSelectedProduct:p}),t.jsxs("div",{className:"fct_buy_section",children:[(e==null?void 0:e.variants)&&new Set(e.variants.map(s=>{var r;return(r=s.other_info)==null?void 0:r.payment_type})).size>1&&t.jsx("div",{className:"fct-product-tab-nav",children:[...new Set(e.variants.map(s=>{var r;return(r=s.other_info)==null?void 0:r.payment_type}))].filter(Boolean).map((s,r)=>t.jsx("div",{className:`fct-product-tab-nav-item ${r===0?"active":""}`,children:s},s))}),t.jsx("div",{className:"fct-product-variants",children:(m=e==null?void 0:e.variants)!=null&&m.length?e.variants.map((s,r)=>t.jsx("div",{className:`fct-product-variant-item ${r===0?"selected":""}`,children:t.jsxs("div",{className:"variant-content",children:[t.jsx("div",{className:"fct-product-variant-image",children:t.jsx("img",{src:s.thumbnail??y,alt:s.variation_title??""})}),t.jsx("div",{className:"fct-product-variant-title",children:s.variation_title??i("Select a product")})]})},s.id??r)):t.jsx("div",{className:"fct-product-variant-item",children:t.jsxs("div",{className:"variant-content",children:[t.jsx("div",{className:"fct-product-variant-image",children:t.jsx("img",{src:((h=(f=e==null?void 0:e.detail)==null?void 0:f.featured_media)==null?void 0:h.url)??y,alt:(e==null?void 0:e.post_title)??""})}),t.jsx("div",{className:"fct-product-variant-title",children:(e==null?void 0:e.post_title)??i("Select a product")})]})})}),t.jsx("div",{className:"fct-product-item-price",children:(v=e==null?void 0:e.variants)!=null&&v[0]?`$${(e.variants[0].item_price/100).toFixed(2)}`:"$0.00"}),t.jsxs("div",{className:"fct-product-quantity-container",children:[t.jsx("h5",{className:"quantity-title",children:i("Quantity")}),t.jsxs("div",{className:"fct-product-quantity",children:[t.jsx("button",{className:"fct-quantity-decrease-button",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"2",viewBox:"0 0 14 2",fill:"none",children:t.jsx("path",{d:"M12.3333 1L1.66659 1",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),t.jsx("input",{type:"text",className:"fct-quantity-input",value:"1",min:"1",max:"10000"}),t.jsx("button",{className:"fct-quantity-increase-button",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:t.jsx("path",{d:"M6.99996 1.66666L6.99996 12.3333M12.3333 6.99999L1.66663 6.99999",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),t.jsxs("div",{className:"fct-product-buttons-wrap",children:[t.jsx("button",{className:"fluent-cart-direct-checkout-button",children:i("Buy Now")}),t.jsx("button",{className:"fluent-cart-add-to-cart-button",children:i("Add To Cart")})]})]})]})},save:function(a){return null}});
