import{j as e,b as B}from"./chunks/BlockEditorTranslator.js";import{P as E,b as y,a as C,c as D,d as S,e as T}from"./chunks/ProductContainerContext.js";import{u as $}from"./chunks/ProductContext.js";import{S as F}from"./chunks/SingleProductContext.js";const{InnerBlocks:L,useBlockProps:k,useInnerBlocksProps:M,__experimentalUseBlockPreview:O,BlockContextProvider:A}=wp.blockEditor,H=O||null,{useContext:R,useEffect:f,useState:x,useMemo:nt,memo:V}=wp.element,{useSelect:z}=wp.data,K=()=>{const s=M({className:"fct-block-product"},{__unstableDisableLayoutClassNames:!0});return e.jsx("div",{...s})},U=({blocks:s,blockContextId:t,isHidden:o,setActiveBlockContextId:r})=>{const a=H({blocks:s,props:{className:"fct-block-product"}}),l=()=>{r(t)},i={display:o?"none":void 0};return e.jsx("div",{...a,tabIndex:0,role:"button",onClick:l,onKeyPress:l,style:i})},q=V(U),G=({displayTemplate:s,blocks:t,blockContext:o,setActiveBlockContextId:r})=>e.jsxs(A,{value:o,children:[s?e.jsx(K,{}):null,e.jsx(q,{blocks:t,blockContextId:o.ID,setActiveBlockContextId:r,isHidden:s})]},o.ID),J={attributes:{wp_client_id:{type:"string",default:""},last_changed:{type:"string",default:""}},edit:s=>{const{attributes:t,setAttributes:o,clientId:r,context:a}=s,{simulateLoading:l,simulateNoResults:i}=R(E);let m=l||i?"hide":"",v=a["fluent-cart/enable_filter"]?"":"not-enable-filter";const h=k({className:"fct-shop-app-preview-wrap "+m+" "+v});f(()=>{o({last_changed:new Date().toISOString()}),!t.wp_client_id&&o({wp_client_id:r})},[r,t.wp_client_id,o]);const n=$(),u=z(c=>c("core/block-editor").getBlock(r),[r]),[d,j]=x(1);f(()=>{if(d>1){new Date().toISOString();return}j(d+1)},[u]);const _=u.innerBlocks,[w,I]=x();return e.jsx("div",{...h,children:e.jsx("div",{className:"fct-product-loop-editor",style:{display:"flex"},children:n==null?void 0:n.products.map(c=>{var p;const N=c.ID===(w||((p=n==null?void 0:n.products[0])==null?void 0:p.ID));return e.jsx(F,{value:{product:c},children:e.jsx("div",{className:"fluent-cart-product-loop fct-product-block-editor-product-card",children:e.jsx(G,{attributes:{productId:c.ID},blocks:_,displayTemplate:N,blockContext:c,setActiveBlockContextId:I},c.ID)},c.ID)},c.ID)})})})},save:s=>{const t=k.save();return e.jsx("div",{...t,className:"fluent-cart-product-loop fct-product-block-editor-product-card",children:e.jsx(L.Content,{})})},supports:{align:["wide","full"],html:!1},usesContext:["fluent-cart/carousel_settings","fluent-cart/product_ids"]},{useBlockProps:Q}=wp.blockEditor,{useContext:lt}=wp.element,W={edit:({context:s})=>{const o=(s["fluent-cart/carousel_settings"]||{}).arrows!=="no",r=Q({className:"fct-carousel-controls-editor"});return o?e.jsxs("div",{...r,children:[e.jsx("button",{className:"editor-carousel-nav prev","aria-hidden":"true",children:"‹"}),e.jsx("button",{className:"editor-carousel-nav next","aria-hidden":"true",children:"›"})]}):e.jsx("div",{...r,style:{opacity:.5},children:"Controls disabled"})},save:()=>null,supports:{html:!1},usesContext:["fluent-cart/carousel_settings"]},{useBlockProps:X}=wp.blockEditor,Y={edit:({context:s})=>{const o=(s["fluent-cart/carousel_settings"]||{}).dots!=="no",r=X({className:"fct-carousel-pagination-editor"});return o?e.jsx("div",{...r,children:e.jsxs("div",{className:"editor-carousel-pagination",children:[e.jsx("span",{className:"editor-carousel-dot is-active"}),e.jsx("span",{className:"editor-carousel-dot"}),e.jsx("span",{className:"editor-carousel-dot"})]})}):e.jsx("div",{...r,style:{opacity:.5},children:"Pagination disabled"})},save:()=>null,supports:{html:!1},usesContext:["fluent-cart/carousel_settings"]},{registerBlockType:g}=wp.blocks,Z=window.fluent_cart_product_carousel_inner_blocks,{InnerBlocks:P,useBlockProps:b}=wp.blockEditor,tt={ProductTitleBlockEditor:T,ProductPriceBlockEditor:S,ProductImageBlockEditor:D,ProductButtonBlockEditor:C,ProductExcerptBlockEditor:y,ProductCarouselLoopBlock:J,CarouselControlsBlock:W,CarouselPaginationBlock:Y};Z.blocks.forEach(s=>{const t=tt[s.component],o=[];s.parent&&o.push(...s.parent),t!=null&&t.parent&&o.push(...t.parent),g(s.slug,{apiVersion:3,category:"product-elements",title:s.title,name:s.slug,icon:s.icon||null,parent:o.length>0?o:null,edit:(t==null?void 0:t.edit)||(()=>B("No edit found")),save:(t==null?void 0:t.save)||(()=>null),supports:(t==null?void 0:t.supports)||{},usesContext:(t==null?void 0:t.usesContext)||[],attributes:(t==null?void 0:t.attributes)||{}})});g("fluent-cart/product-paginator",{apiVersion:3,title:B("Paginator"),icon:"screenoptions",parent:["fluent-cart/product_carousel","core/column"],category:"layout",attributes:{},edit:s=>{const t=b({className:"fluent-cart-product-paginator"});return e.jsx("div",{...t,children:e.jsx("div",{children:e.jsx(P,{allowedBlocks:["fluent-cart/product-paginator-info","fluent-cart/product-paginator-number","core/paragraph"]})})})},save:s=>{const t=b.save();return e.jsx("div",{...t,className:"fluent-cart-product-paginator",children:e.jsx(P.Content,{})})},usesContext:["fluent-cart/carousel_settings","fluent-cart/product_ids"]});
