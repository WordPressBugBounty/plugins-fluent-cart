import{j as t,b as e}from"./chunks/BlockEditorTranslator.js";import{l as S}from"./chunks/Icons.js";import{S as _}from"./chunks/SelectProductModal.js";import{E as g}from"./chunks/EditorPanel.js";import{E as f}from"./chunks/EditorPanelRow.js";import{C as E}from"./chunks/CustomSelect.js";import{a as N}from"./chunks/index4.js";import{u as C}from"./chunks/SingleProductContext.js";import{a as P}from"./chunks/add-query-args.js";import"./chunks/ProductListItem.js";import"./chunks/index5.js";const{InspectorControls:B}=wp.blockEditor,I=({attributes:r,setAttributes:n,selectedProduct:c,setSelectedProduct:i})=>t.jsx(B,{children:t.jsx("div",{className:"fct-inspector-control-wrap fct-inspector-control-wrap--product-card",children:t.jsx("div",{className:"fct-inspector-control-group",children:t.jsx("div",{className:"fct-inspector-control-body",children:t.jsxs(g,{title:e("Product"),children:[t.jsxs(f,{children:[t.jsx("span",{className:"fct-inspector-control-label",children:e("Query type")}),t.jsx("div",{className:"actions",children:t.jsx(E,{customKeys:{key:"value",label:"label"},defaultValue:r.query_type,options:[{label:e("Default"),value:"default"},{label:e("Custom"),value:"custom"}],onChange:function(o){n({query_type:o})}})})]}),r.query_type==="custom"&&t.jsxs(f,{className:"flex-col",children:[t.jsx(_,{onModalClosed:o=>{n({product_id:String(o.ID)||""})},selectedProduct:c,setSelectedProduct:i,isMultiple:!1}),c&&t.jsxs("div",{className:"fct-selected-variation-info w-full",children:[t.jsx("strong",{children:e("Selected Product:")}),t.jsx("p",{children:c.post_title})]})]})]})})})})}),{useBlockProps:q}=wp.blockEditor,{registerBlockType:A}=wp.blocks,{useEffect:M,useState:R}=wp.element,{useSelect:V}=wp.data,{store:L}=wp.blockEditor,m=window.fluentCartRestVars.rest,l=window.fluent_cart_stock_data;A(l.slug+"/"+l.name,{apiVersion:3,title:l.title,description:l.description,icon:{src:S},supports:l.supports||[],category:"fluent-cart",attributes:{product_id:{type:"string",default:""},variant_id:{type:"string",default:""},query_type:{type:"string",default:"default"}},edit:({attributes:r,setAttributes:n,clientId:c})=>{var u;const i=q(),o=C(),p=V(s=>{const{getBlockParents:j,getBlockName:v}=s(L);return j(c).some(w=>{const b=v(w);return["fluent-cart/product-info","fluent-cart/products","fluent-cart/shopapp-product-container","fluent-cart/shopapp-product-loop","fluent-cart/product-carousel"].includes(b)})},[c]),k=s=>{switch(s){case"in-stock":return e("In Stock");case"out-of-stock":return e("Out of Stock");case"backorder":return e("Available on Backorder");case"low-stock":return e("Low Stock");default:return e("Stock Availability")}};n({inside_product_info:p?"yes":"no"});const[a,d]=R({}),h=m.url+"/products/"+r.product_id,y=()=>{N({path:P(h,{with:["detail","variants"]}),headers:{"X-WP-Nonce":m.nonce}}).then(s=>{console.log(s.product," response"),d(s.product||{})}).finally(()=>{})};M(()=>{o!=null&&o.product&&d(o.product),!p&&r.product_id&&y()},[r.product_id,o==null?void 0:o.product]);const x=k((u=a==null?void 0:a.detail)==null?void 0:u.stock_availability)||e("Stock Availability");return t.jsxs("div",{...i,children:[p?"":t.jsx(I,{attributes:r,setAttributes:n,selectedProduct:a,setSelectedProduct:d}),t.jsx("div",{className:"fct-stock-status",children:x})]})},save:function(r){return null}});
